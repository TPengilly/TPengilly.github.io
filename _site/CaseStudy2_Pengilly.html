<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Thomas Pengilly" />


<title>DDS Case Study 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Brewery_Case_Study.html">Beer Study</a>
</li>
<li>
  <a href="CaseStudy2_Pengilly.html">Attrition Study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">DDS Case Study 2</h1>
<h4 class="author">Thomas Pengilly</h4>
<h4 class="date">3/28/2020</h4>

</div>


<div id="case-study-2-tom-pengilly" class="section level1">
<h1>Case Study 2: Tom Pengilly</h1>
</div>
<div id="youtube-link-httpsyoutu.be7ylpnzwe0ei" class="section level1">
<h1>Youtube link: <a href="https://youtu.be/7yLpNzwe0EI" class="uri">https://youtu.be/7yLpNzwe0EI</a></h1>
<div id="summary" class="section level65">
<p>Summary</p>
<p>This file is for DDS Case Study 2. It explores employee attrition data provided by Frito-Lay to create to create multiple predictive models. The first 2 are classification algorithms (Naive-Bayes and logistic regression classifiers) that predict whether an employee will quit. The next 2 are regression algorithms that predict an employees salary. ######################################################################################################################################################</p>
</div>
<div id="section-1" class="section level3">
<h3>Section 1</h3>
</div>
</div>
<div id="perform-an-eda-of-case-study-2-data-in-order-to" class="section level1">
<h1>Perform an EDA of Case Study 2 data in order to:</h1>
</div>
<div id="find-the-top-3-factors-contributing-to-job-attrition-may-or-may-not-be-derived-factors" class="section level1">
<h1>Find the top 3 factors contributing to job attrition (may or may not be derived factors)</h1>
</div>
<div id="provide-any-job-specific-trends" class="section level1">
<h1>Provide any job specific trends</h1>
</div>
<div id="provide-any-other-interesting-findings" class="section level1">
<h1>Provide any other interesting findings</h1>
</div>
<div id="provide-clear-visualizations" class="section level1">
<h1>Provide clear visualizations</h1>
</div>
<div id="load-initial-libraries" class="section level1">
<h1>Load initial libraries</h1>
<pre class="r"><code>library(tidyverse)
library(ggplot2)
library(GGally)
library(scales)</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<pre class="r"><code>library(reshape2)</code></pre>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<pre class="r"><code>library(standardize)</code></pre>
<pre><code>## Warning: package &#39;standardize&#39; was built under R version 3.6.3</code></pre>
</div>
<div id="read-in-the-data-create-data-subsets" class="section level1">
<h1>Read in the data, create data subsets</h1>
<pre class="r"><code>data = read.csv(&#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2-data.csv&#39;, header = T)
data_left = data %&gt;% filter(Attrition == &#39;Yes&#39;)
data_stayed = data %&gt;% filter(Attrition == &#39;No&#39;)
data</code></pre>
<pre><code>##    ID Age Attrition    BusinessTravel DailyRate             Department
## 1   1  32        No     Travel_Rarely       117                  Sales
## 2   2  40        No     Travel_Rarely      1308 Research &amp; Development
## 3   3  35        No Travel_Frequently       200 Research &amp; Development
## 4   4  32        No     Travel_Rarely       801                  Sales
## 5   5  24        No Travel_Frequently       567 Research &amp; Development
## 6   6  27        No Travel_Frequently       294 Research &amp; Development
## 7   7  41        No     Travel_Rarely      1283 Research &amp; Development
## 8   8  37        No     Travel_Rarely       309                  Sales
## 9   9  34        No     Travel_Rarely      1333                  Sales
## 10 10  34        No Travel_Frequently       653 Research &amp; Development
## 11 11  43        No     Travel_Rarely       823 Research &amp; Development
## 12 12  28        No        Non-Travel       280        Human Resources
## 13 13  35        No     Travel_Rarely       950 Research &amp; Development
## 14 14  30        No     Travel_Rarely       202                  Sales
## 15 15  46        No     Travel_Rarely       991        Human Resources
## 16 16  31        No        Non-Travel      1188                  Sales
## 17 17  32        No     Travel_Rarely       498 Research &amp; Development
## 18 18  46        No        Non-Travel      1144 Research &amp; Development
## 19 19  34        No     Travel_Rarely       181 Research &amp; Development
## 20 20  44        No     Travel_Rarely       170 Research &amp; Development
## 21 21  36        No     Travel_Rarely       913 Research &amp; Development
## 22 22  48        No     Travel_Rarely       817                  Sales
## 23 23  43        No Travel_Frequently      1001 Research &amp; Development
## 24 24  31        No Travel_Frequently       715                  Sales
## 25 25  33        No     Travel_Rarely      1069 Research &amp; Development
## 26 26  44        No     Travel_Rarely      1099                  Sales
## 27 27  38        No     Travel_Rarely      1245                  Sales
##    DistanceFromHome Education   EducationField EmployeeCount EmployeeNumber
## 1                13         4    Life Sciences             1            859
## 2                14         3          Medical             1           1128
## 3                18         2    Life Sciences             1           1412
## 4                 1         4        Marketing             1           2016
## 5                 2         1 Technical Degree             1           1646
## 6                10         2    Life Sciences             1            733
## 7                 5         5          Medical             1           1448
## 8                10         4    Life Sciences             1           1105
## 9                10         4    Life Sciences             1           1055
## 10               10         4 Technical Degree             1           1597
## 11                6         3          Medical             1           1866
## 12                1         2    Life Sciences             1           1858
## 13                7         3            Other             1            845
## 14                2         1 Technical Degree             1            508
## 15                1         2    Life Sciences             1           1314
## 16               20         2        Marketing             1            947
## 17                3         4          Medical             1            966
## 18                7         4          Medical             1            487
## 19                2         4          Medical             1           1755
## 20                1         4    Life Sciences             1           1903
## 21                9         2          Medical             1            699
## 22                2         1        Marketing             1            712
## 23                9         5          Medical             1            663
## 24                2         4            Other             1           1613
## 25                1         3    Life Sciences             1            969
## 26                5         3        Marketing             1           1267
## 27               14         3    Life Sciences             1           1582
##    EnvironmentSatisfaction Gender HourlyRate JobInvolvement JobLevel
## 1                        2   Male         73              3        2
## 2                        3   Male         44              2        5
## 3                        3   Male         60              3        3
## 4                        3 Female         48              3        3
## 5                        1 Female         32              3        1
## 6                        4   Male         32              3        3
## 7                        2   Male         90              4        1
## 8                        4 Female         88              2        2
## 9                        3 Female         87              3        1
## 10                       4   Male         92              2        2
## 11                       1 Female         81              2        5
## 12                       3   Male         43              3        1
## 13                       3   Male         59              3        3
## 14                       3   Male         72              3        1
## 15                       4 Female         44              3        1
## 16                       4 Female         45              3        2
## 17                       3 Female         93              3        2
## 18                       3 Female         30              3        2
## 19                       4   Male         97              4        1
## 20                       2   Male         78              4        2
## 21                       2   Male         48              2        2
## 22                       2   Male         56              4        2
## 23                       4   Male         72              3        2
## 24                       4   Male         54              3        2
## 25                       2 Female         42              2        2
## 26                       2   Male         88              3        5
## 27                       3   Male         80              3        2
##                      JobRole JobSatisfaction MaritalStatus MonthlyIncome
## 1            Sales Executive               4      Divorced          4403
## 2          Research Director               3        Single         19626
## 3     Manufacturing Director               4        Single          9362
## 4            Sales Executive               4       Married         10422
## 5         Research Scientist               4        Single          3760
## 6     Manufacturing Director               1      Divorced          8793
## 7         Research Scientist               3       Married          2127
## 8            Sales Executive               4      Divorced          6694
## 9       Sales Representative               3       Married          2220
## 10 Healthcare Representative               3       Married          5063
## 11                   Manager               3       Married         19392
## 12           Human Resources               4      Divorced          2706
## 13    Manufacturing Director               3        Single         10221
## 14      Sales Representative               2       Married          2476
## 15           Human Resources               1        Single          3423
## 16           Sales Executive               3       Married          6932
## 17    Manufacturing Director               1       Married          6725
## 18    Manufacturing Director               3       Married          5258
## 19        Research Scientist               4       Married          2932
## 20 Healthcare Representative               1       Married          5033
## 21    Manufacturing Director               2      Divorced          8847
## 22           Sales Executive               2       Married          8120
## 23     Laboratory Technician               3      Divorced          5679
## 24           Sales Executive               1        Single          5332
## 25 Healthcare Representative               4        Single          6949
## 26                   Manager               2       Married         18213
## 27           Sales Executive               2       Married          9924
##    MonthlyRate NumCompaniesWorked Over18 OverTime PercentSalaryHike
## 1         9250                  2      Y       No                11
## 2        17544                  1      Y       No                14
## 3        19944                  2      Y       No                11
## 4        24032                  1      Y       No                19
## 5        17218                  1      Y      Yes                13
## 6         4809                  1      Y       No                21
## 7         5561                  2      Y      Yes                12
## 8        24223                  2      Y      Yes                14
## 9        18410                  1      Y      Yes                19
## 10       15332                  1      Y       No                14
## 11       22539                  7      Y       No                13
## 12       10494                  1      Y       No                15
## 13       18869                  3      Y       No                21
## 14       17434                  1      Y       No                18
## 15       22957                  6      Y       No                12
## 16       24406                  1      Y       No                13
## 17       13554                  1      Y       No                12
## 18       16044                  2      Y       No                14
## 19        5586                  0      Y      Yes                14
## 20        9364                  2      Y       No                15
## 21       13934                  2      Y      Yes                11
## 22       18597                  3      Y       No                12
## 23       19627                  3      Y      Yes                13
## 24       21602                  7      Y       No                13
## 25       12291                  0      Y       No                14
## 26        8751                  7      Y       No                11
## 27       12355                  0      Y       No                11
##    PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel
## 1                  3                        3            80                1
## 2                  3                        1            80                0
## 3                  3                        3            80                0
## 4                  3                        3            80                2
## 5                  3                        3            80                0
## 6                  4                        3            80                2
## 7                  3                        1            80                0
## 8                  3                        3            80                3
## 9                  3                        4            80                1
## 10                 3                        2            80                1
## 11                 3                        4            80                0
## 12                 3                        2            80                1
## 13                 4                        2            80                0
## 14                 3                        1            80                1
## 15                 3                        3            80                0
## 16                 3                        4            80                1
## 17                 3                        3            80                1
## 18                 3                        3            80                0
## 19                 3                        1            80                3
## 20                 3                        4            80                1
## 21                 3                        3            80                1
## 22                 3                        4            80                0
## 23                 3                        2            80                1
## 24                 3                        4            80                0
## 25                 3                        1            80                0
## 26                 3                        3            80                1
## 27                 3                        4            80                1
##    TotalWorkingYears TrainingTimesLastYear WorkLifeBalance YearsAtCompany
## 1                  8                     3               2              5
## 2                 21                     2               4             20
## 3                 10                     2               3              2
## 4                 14                     3               3             14
## 5                  6                     2               3              6
## 6                  9                     4               2              9
## 7                  7                     5               2              4
## 8                  8                     5               3              1
## 9                  1                     2               3              1
## 10                 8                     3               2              8
## 11                21                     2               3             16
## 12                 3                     2               3              3
## 13                17                     3               4              8
## 14                 1                     3               3              1
## 15                10                     3               4              7
## 16                 9                     2               2              9
## 17                 8                     2               4              8
## 18                 7                     2               4              1
## 19                 6                     3               3              5
## 20                10                     5               3              2
## 21                13                     2               3              3
## 22                12                     3               3              2
## 23                10                     3               3              8
## 24                10                     3               3              5
## 25                 6                     3               3              5
## 26                26                     5               3             22
## 27                10                     3               3              9
##    YearsInCurrentRole YearsSinceLastPromotion YearsWithCurrManager
## 1                   2                       0                    3
## 2                   7                       4                    9
## 3                   2                       2                    2
## 4                  10                       5                    7
## 5                   3                       1                    3
## 6                   7                       1                    7
## 7                   2                       0                    3
## 8                   0                       0                    0
## 9                   1                       0                    0
## 10                  2                       7                    7
## 11                 12                       6                   14
## 12                  2                       2                    2
## 13                  5                       1                    6
## 14                  0                       0                    0
## 15                  6                       5                    7
## 16                  8                       0                    0
## 17                  7                       6                    3
## 18                  0                       0                    0
## 19                  0                       1                    2
## 20                  0                       2                    2
## 21                  2                       0                    2
## 22                  2                       2                    2
## 23                  7                       4                    7
## 24                  2                       0                    3
## 25                  0                       1                    4
## 26                  9                       3                   10
## 27                  8                       7                    7
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 843 rows ]</code></pre>
<div id="eda" class="section level59">
<p>EDA</p>
</div>
</div>
<div id="ggally-correlation-matrix-to-explore-initial-corrlations" class="section level1">
<h1>GGally Correlation Matrix to explore initial corrlations</h1>
<pre class="r"><code>ggpairs(data, columns = c(3, 2, 4:6), title = &#39;Correlation Matrix&#39;, ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## 
 plot: [1,1] [=&gt;------------------------------------------------]  4% est: 0s 
 plot: [1,2] [===&gt;----------------------------------------------]  8% est: 1s 
 plot: [1,3] [=====&gt;--------------------------------------------] 12% est: 1s 
 plot: [1,4] [=======&gt;------------------------------------------] 16% est: 2s 
 plot: [1,5] [=========&gt;----------------------------------------] 20% est: 2s 
 plot: [2,1] [===========&gt;--------------------------------------] 24% est: 2s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [2,2] [=============&gt;------------------------------------] 28% est: 2s 
 plot: [2,3] [===============&gt;----------------------------------] 32% est: 2s 
 plot: [2,4] [=================&gt;--------------------------------] 36% est: 2s 
 plot: [2,5] [===================&gt;------------------------------] 40% est: 1s 
 plot: [3,1] [=====================&gt;----------------------------] 44% est: 1s 
 plot: [3,2] [=======================&gt;--------------------------] 48% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,3] [=========================&gt;------------------------] 52% est: 1s 
 plot: [3,4] [===========================&gt;----------------------] 56% est: 1s 
 plot: [3,5] [=============================&gt;--------------------] 60% est: 1s 
 plot: [4,1] [===============================&gt;------------------] 64% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [=================================&gt;----------------] 68% est: 1s 
 plot: [4,3] [===================================&gt;--------------] 72% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,4] [=====================================&gt;------------] 76% est: 1s 
 plot: [4,5] [=======================================&gt;----------] 80% est: 1s 
 plot: [5,1] [=========================================&gt;--------] 84% est: 0s 
 plot: [5,2] [===========================================&gt;------] 88% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,3] [=============================================&gt;----] 92% est: 0s 
 plot: [5,4] [===============================================&gt;--] 96% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,5] [==================================================]100% est: 0s 
                                                                              </code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>ggpairs(data, columns = c(3, 2, 7:10), title = &#39;Correlation Matrix&#39;, ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## 
 plot: [1,1] [&gt;-------------------------------------------------]  3% est: 0s 
 plot: [1,2] [==&gt;-----------------------------------------------]  6% est: 2s 
 plot: [1,3] [===&gt;----------------------------------------------]  8% est: 2s 
 plot: [1,4] [=====&gt;--------------------------------------------] 11% est: 2s 
 plot: [1,5] [======&gt;-------------------------------------------] 14% est: 2s 
 plot: [1,6] [=======&gt;------------------------------------------] 17% est: 3s 
 plot: [2,1] [=========&gt;----------------------------------------] 19% est: 4s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [2,2] [==========&gt;---------------------------------------] 22% est: 4s 
 plot: [2,3] [===========&gt;--------------------------------------] 25% est: 3s 
 plot: [2,4] [=============&gt;------------------------------------] 28% est: 3s 
 plot: [2,5] [==============&gt;-----------------------------------] 31% est: 3s 
 plot: [2,6] [================&gt;---------------------------------] 33% est: 3s</code></pre>
<pre><code>## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero</code></pre>
<pre><code>## 
 plot: [3,1] [=================&gt;--------------------------------] 36% est: 3s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,2] [==================&gt;-------------------------------] 39% est: 2s 
 plot: [3,3] [====================&gt;-----------------------------] 42% est: 2s 
 plot: [3,4] [=====================&gt;----------------------------] 44% est: 2s 
 plot: [3,5] [=======================&gt;--------------------------] 47% est: 2s 
 plot: [3,6] [========================&gt;-------------------------] 50% est: 2s</code></pre>
<pre><code>## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero</code></pre>
<pre><code>## 
 plot: [4,1] [=========================&gt;------------------------] 53% est: 2s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [===========================&gt;----------------------] 56% est: 2s 
 plot: [4,3] [============================&gt;---------------------] 58% est: 2s 
 plot: [4,4] [==============================&gt;-------------------] 61% est: 1s 
 plot: [4,5] [===============================&gt;------------------] 64% est: 1s 
 plot: [4,6] [================================&gt;-----------------] 67% est: 1s</code></pre>
<pre><code>## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero</code></pre>
<pre><code>## 
 plot: [5,1] [==================================&gt;---------------] 69% est: 1s 
 plot: [5,2] [===================================&gt;--------------] 72% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,3] [=====================================&gt;------------] 75% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,4] [======================================&gt;-----------] 78% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,5] [=======================================&gt;----------] 81% est: 1s 
 plot: [5,6] [=========================================&gt;--------] 83% est: 1s 
 plot: [6,1] [==========================================&gt;-------] 86% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [6,2] [===========================================&gt;------] 89% est: 1s 
 plot: [6,3] [=============================================&gt;----] 92% est: 0s 
 plot: [6,4] [==============================================&gt;---] 94% est: 0s 
 plot: [6,5] [================================================&gt;-] 97% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [6,6] [==================================================]100% est: 0s 
                                                                              </code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="explore-variables" class="section level1">
<h1>Explore variables</h1>
<div id="years-with-current-manager" class="section level9">
<p>Years with current manager</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 36), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="years-since-promotion" class="section level9">
<p>Years Since promotion</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 35), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="years-in-current-role" class="section level9">
<p>Years in current role</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 34), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="years-at-company" class="section level9">
<p>Years at company</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 33), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="work-life-balance" class="section level9">
<p>Work Life Balance</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 32), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div id="training-times-last-year" class="section level11">
<p>Training times last year</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 31), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="total-working-years-blue-is-quit-job" class="section level11">
<p>Total Working Years BLUE IS QUIT JOB</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 30), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="stock-options" class="section level9">
<p>Stock Options</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 29), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="relationship-satisfaction" class="section level9">
<p>Relationship satisfaction</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 27), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="performance-rating" class="section level9">
<p>Performance Rating</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 26), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="percent-salary-hike" class="section level9">
<p>Percent salary hike</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 25), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="over-time" class="section level9">
<p>Over Time</p>
</div>
</div>
<div id="wont-knit-properly" class="section level1">
<h1>Won’t knit properly</h1>
<pre class="r"><code>#ggpairs(data, columns = c(3, 24), ggplot2::aes(color = data$Attrition))
#data %&gt;% ggplot(aes(x = data$Attrition, y = n, fill = OverTime)) + geom_bar(stat = &#39;identity&#39;)</code></pre>
<div id="num-companies-worked" class="section level9">
<p>Num Companies Worked</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 22), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="monthly-rate" class="section level9">
<p>Monthly Rate</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 21), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="monthly-income" class="section level9">
<p>Monthly Income</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 20), ggplot2::aes(color = data$Attrition), legend = 3)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="marital-status" class="section level9">
<p>Marital Status</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 19), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="job-satisfaction" class="section level9">
<p>Job Satisfaction</p>
<pre class="r"><code>data2 = data
data2$JobSatisfaction = as.numeric(data2$JobSatisfaction)
ggpairs(data2, columns = c(3, 18), ggplot2::aes(color = data$Attrition), legend = 3)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="job-role" class="section level9">
<p>Job Role</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 17), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="job-level" class="section level9">
<p>Job Level</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 16), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="job-involvement" class="section level9">
<p>Job Involvement</p>
<pre class="r"><code>data2 = data
data2$JobInvolvement = as.factor(data2$JobInvolvement)  
ggpairs(data2, columns = c(3, 15), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="hourly-rate" class="section level9">
<p>Hourly Rate</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 14), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="gender" class="section level9">
<p>Gender</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 13), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="environment-satisfaction" class="section level9">
<p>Environment Satisfaction</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 12), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="employee-number" class="section level9">
<p>Employee Number</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 11), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="education-field" class="section level9">
<p>Education Field</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 9), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="education" class="section level9">
<p>Education</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 8), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="distance-from-home" class="section level9">
<p>Distance From Home</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 7), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="deparment" class="section level9">
<p>Deparment</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 6), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="daily-rate" class="section level9">
<p>Daily Rate</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 5), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="business-travel" class="section level9">
<p>Business Travel</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 4), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="age" class="section level9">
<p>Age</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 2), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div id="section" class="section level150">
<p></p>
</div>
<div id="section-2" class="section level150">
<p></p>
</div>
</div>
</div>
<div id="job-specific-analysis-environment-satisfaction" class="section level1">
<h1>Job Specific analysis Environment satisfaction</h1>
<pre class="r"><code>env_count = data %&gt;% group_by(JobRole) %&gt;% count(EnvironmentSatisfaction)
data %&gt;% ggplot() + geom_boxplot(aes(x = data$JobRole, y = data$EnvironmentSatisfaction, color = data$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<pre class="r"><code>env_count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = EnvironmentSatisfaction, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Environment Satisfaction By Job Role&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 3)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
</div>
<div id="job-involvement-vs-attrition" class="section level1">
<h1>Job Involvement vs attrition</h1>
<pre class="r"><code>job_inv = data2 %&gt;% group_by(JobInvolvement) %&gt;% count(Attrition)
job_inv %&gt;% ggplot() + geom_boxplot(aes(x = job_inv$JobInvolvement, y = job_inv$Attrition, color = job_inv$JobInvolvement)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<pre class="r"><code>job_inv %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = Attrition, y = n, x = JobInvolvement, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition by Job Involvement&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 5)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-37-2.png" width="672" /></p>
</div>
<div id="job-level-vs-attrition" class="section level1">
<h1>Job Level vs attrition</h1>
<pre class="r"><code>job_inv = data2 %&gt;% group_by(JobLevel) %&gt;% count(Attrition)
job_inv %&gt;% ggplot() + geom_boxplot(aes(x = job_inv$JobLevel, y = job_inv$Attrition, color = job_inv$JobLevel)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code>job_inv %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = Attrition, y = n, x = JobLevel, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition by Job Level&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 5)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
</div>
<div id="job-role-vs-attrition" class="section level1">
<h1>Job Role vs attrition</h1>
<pre class="r"><code>dept_att = data2 %&gt;% group_by(JobRole) %&gt;% count(Attrition)
dept_att %&gt;% ggplot() + geom_boxplot(aes(x = dept_att$JobRole, y = dept_att$Attrition, color = dept_att$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="r"><code>dept_att %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = Attrition, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition by Job Role&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
</div>
<div id="job-role-vs-overtime" class="section level1">
<h1>Job Role vs Overtime</h1>
<pre class="r"><code>dept_att = data2 %&gt;% group_by(JobRole) %&gt;% count(OverTime)
dept_att %&gt;% ggplot() + geom_boxplot(aes(x = dept_att$JobRole, y = dept_att$OverTime, color = dept_att$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<pre class="r"><code>dept_att %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = OverTime, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;OverTime by Job Role&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-40-2.png" width="672" /></p>
</div>
<div id="attrition-vs-overtime" class="section level1">
<h1>Attrition vs Overtime</h1>
<pre class="r"><code>OT_att = data2 %&gt;% group_by(Attrition) %&gt;% count(OverTime)
OT_att %&gt;% ggplot() + geom_boxplot(aes(x = OT_att$Attrition, y = OT_att$OverTime, color = OT_att$Attrition)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<pre class="r"><code>OT_att %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = OverTime, y = n, x = Attrition, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition vs Overtime&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
</div>
<div id="job-specific-analysis-travel" class="section level1">
<h1>Job Specific analysis Travel</h1>
<pre class="r"><code>count = data %&gt;% group_by(JobRole) %&gt;% count(BusinessTravel)
jobcount = data %&gt;% count(JobRole)

count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = BusinessTravel, y = pct, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = .5), vjust = -0.0, size = 3)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<pre class="r"><code>count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = BusinessTravel, y = pct, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = .7), vjust = 0.5, hjust = 0.0, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
</div>
<div id="most-involved-jobs" class="section level1">
<h1>Most involved jobs</h1>
<pre class="r"><code>involved_count = data %&gt;% group_by(JobRole) %&gt;% count(JobInvolvement)
involved_count$JobInvolvement = factor(involved_count$JobInvolvement)
involved_count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobInvolvement, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;, ) + coord_flip() + geom_text(position = position_dodge(width = .7), vjust = 0.5, hjust = 0.0, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="job-specific-analysis-marital-status" class="section level1">
<h1>Job Specific analysis Marital Status</h1>
<pre class="r"><code>marital_count = data %&gt;% group_by(JobRole) %&gt;% count(MaritalStatus)
marital_count %&gt;% ggplot(aes(fill = MaritalStatus, y = n, x = JobRole)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="overtime-by-job-role-where-we-need-to-hire-more-people" class="section level1">
<h1>Overtime by job role (Where we need to hire more people)</h1>
<pre class="r"><code>ot_count = data %&gt;% group_by(JobRole) %&gt;% count(OverTime)
ot_count %&gt;% ggplot(aes(fill = OverTime, y = n, x = JobRole)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Overtime By Department&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
<div id="overtime-by-job-level-where-we-need-to-hire-more-people" class="section level1">
<h1>Overtime by job level (Where we need to hire more people)</h1>
<pre class="r"><code>ot_count = data %&gt;% group_by(JobLevel) %&gt;% count(OverTime)
ot_count %&gt;% ggplot(aes(fill = OverTime, y = n, x = JobLevel)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Overtime By Job Level&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="environment-satisfaction-by-job-level-where-we-need-to-hire-more-people" class="section level1">
<h1>Environment satisfaction by job level (Where we need to hire more people)</h1>
<pre class="r"><code>sat_count = data %&gt;% group_by(JobLevel) %&gt;% count(EnvironmentSatisfaction)
sat_count %&gt;% ggplot(aes(fill = EnvironmentSatisfaction, y = n, x = JobLevel)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Environment Satisfaction By Job Level&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="worklifebalance-by-department" class="section level1">
<h1>WorkLifeBalance by Department</h1>
<pre class="r"><code>wl_count = data %&gt;% group_by(JobRole) %&gt;% count(WorkLifeBalance)
wl_count$WorkLifeBalance = as.factor(wl_count$WorkLifeBalance)

wl_count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = wl_count$WorkLifeBalance, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Work-Life Balance By Department&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent) + geom_text(position = position_dodge(width = .7), vjust = 0.5, hjust = 0.0, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-job-role" class="section level1">
<h1>Monthly income by job role</h1>
<pre class="r"><code>data %&gt;% ggplot() + geom_boxplot(aes(x = data$JobRole, y = data$MonthlyIncome, color = data$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div id="other-trends" class="section level48">
<p>Other Trends</p>
</div>
</div>
<div id="job-involvement-by-environment-satisfaction" class="section level1">
<h1>Job involvement by environment satisfaction</h1>
<pre class="r"><code>count = data %&gt;% group_by(EnvironmentSatisfaction) %&gt;% count(JobInvolvement)
count$EnvironmentSatisfaction = factor(count$EnvironmentSatisfaction)
count$JobInvolvement = factor(count$JobInvolvement)

count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = EnvironmentSatisfaction, y = pct, x = JobInvolvement, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<pre class="r"><code>count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobInvolvement, y = pct, x = EnvironmentSatisfaction, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-50-2.png" width="672" /></p>
</div>
<div id="job-involvement-by-job-satisfaction" class="section level1">
<h1>Job involvement by job satisfaction</h1>
<pre class="r"><code>count = data %&gt;% group_by(JobSatisfaction) %&gt;% count(JobInvolvement)
count$JobSatisfaction = factor(count$JobSatisfaction)
count$JobInvolvement = factor(count$JobInvolvement)

count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobSatisfaction, y = pct, x = JobInvolvement, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<pre class="r"><code>count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobInvolvement, y = pct, x = JobSatisfaction, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-51-2.png" width="672" /></p>
</div>
<div id="monthly-income-by-job-role-and-job-satisfaction" class="section level1">
<h1>Monthly Income by job role and job satisfaction</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$MonthlyIncome, fill = factor(data$JobSatisfaction))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-job-role-and-job-involvement" class="section level1">
<h1>Monthly Income by job role and job involvement</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$MonthlyIncome, fill = factor(data$JobInvolvement))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
<div id="percent-salary-hike-by-job-role-and-job-satisfaction" class="section level1">
<h1>percent salary hike by job role and job satisfaction</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$PercentSalaryHike, fill = factor(data$JobSatisfaction))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="percent-salary-hike-by-job-role-and-job-involvement" class="section level1">
<h1>Percent salary hike by job role and job involvement</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$PercentSalaryHike, fill = factor(data$JobInvolvement))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-education-and-job-involvement" class="section level1">
<h1>Monthly Income by Education and job involvement</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = factor(data$Education), y = data$MonthlyIncome, fill = factor(data$JobInvolvement))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-education-and-jobrole" class="section level1">
<h1>Monthly Income by Education and jobrole</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = factor(data$JobRole), y = data$MonthlyIncome, fill = factor(data$Education))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div id="end-eda" class="section level37">
<p>END EDA</p>
<div id="classification" class="section level43">
<p>CLASSIFICATION</p>
</div>
</div>
</div>
<div id="create-a-classification-algorithm-using-k-nn-or-naive-bayes" class="section level1">
<h1>Create a classification algorithm using K-NN or Naive-Bayes</h1>
</div>
<div id="import-libraries" class="section level1">
<h1>Import Libraries</h1>
<pre class="r"><code>library(e1071)
library(class)
library(caret)
library(mlbench)</code></pre>
<pre><code>## Warning: package &#39;mlbench&#39; was built under R version 3.6.3</code></pre>
</div>
<div id="reset-data-and-check-for-missing-values" class="section level1">
<h1>Reset data and check for missing values</h1>
<pre class="r"><code>data = read.csv(&#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2-data.csv&#39;, header = T)
sum(is.na.data.frame(data))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="factorize-some-of-the-numeric-data" class="section level1">
<h1>Factorize some of the numeric data</h1>
<pre class="r"><code>data$Education = as.factor(data$Education)
data$EnvironmentSatisfaction = as.factor(data$EnvironmentSatisfaction)
data$JobInvolvement = as.factor(data$JobInvolvement)
data$JobLevel = as.factor(data$JobLevel)
data$JobSatisfaction = as.factor(data$JobSatisfaction)</code></pre>
</div>
<div id="split-training-data-into-training-and-test-sets-to-compare-models-will-train-on-full-training-set-later" class="section level1">
<h1>Split training data into training and test sets (to compare models, will train on full training set later)</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(data$Attrition)), round(.8*length(data$Attrition)))
trainData = data[trainIndices,]
testData = data[-trainIndices,]</code></pre>
<div id="naive-bayes-classifier" class="section level45">
<p>NAIVE-BAYES CLASSIFIER</p>
</div>
</div>
<div id="train-naive-bayes-classifier-on-traindata-using-only-variables-thought-to-be-significant-or-potentially-significant" class="section level1">
<h1>Train Naive-Bayes Classifier on trainData using only variables thought to be significant or potentially significant</h1>
</div>
<div id="this-uses-numeric-variables-for-some-factored-numeric-data" class="section level1">
<h1>This uses Numeric variables for some factored numeric data</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24:27, 29:36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24:27, 29:36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  132   8
##   Yes  28   6
##                                           
##                Accuracy : 0.7931          
##                  95% CI : (0.7253, 0.8507)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 1.000000        
##                                           
##                   Kappa : 0.1535          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.001542        
##                                           
##             Sensitivity : 0.8250          
##             Specificity : 0.4286          
##          Pos Pred Value : 0.9429          
##          Neg Pred Value : 0.1765          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7586          
##    Detection Prevalence : 0.8046          
##       Balanced Accuracy : 0.6268          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="iteratively-remove-variables-using-backward-elimination" class="section level1">
<h1>Iteratively Remove variables using backward elimination</h1>
</div>
<div id="remove-percentsalhike-25" class="section level1">
<h1>Remove PercentSalHike (25)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 29:36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 29:36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  132   8
##   Yes  28   6
##                                           
##                Accuracy : 0.7931          
##                  95% CI : (0.7253, 0.8507)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 1.000000        
##                                           
##                   Kappa : 0.1535          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.001542        
##                                           
##             Sensitivity : 0.8250          
##             Specificity : 0.4286          
##          Pos Pred Value : 0.9429          
##          Neg Pred Value : 0.1765          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7586          
##    Detection Prevalence : 0.8046          
##       Balanced Accuracy : 0.6268          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-stockopts-29" class="section level1">
<h1>Remove StockOpts (29)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 30:36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 30:36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  133   7
##   Yes  27   7
##                                           
##                Accuracy : 0.8046          
##                  95% CI : (0.7378, 0.8607)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 1.00000         
##                                           
##                   Kappa : 0.2005          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.00112         
##                                           
##             Sensitivity : 0.8313          
##             Specificity : 0.5000          
##          Pos Pred Value : 0.9500          
##          Neg Pred Value : 0.2059          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7644          
##    Detection Prevalence : 0.8046          
##       Balanced Accuracy : 0.6656          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-yearssincepromotion-35" class="section level1">
<h1>Remove YearssincePromotion (35)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 30:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 30:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  133   7
##   Yes  27   7
##                                           
##                Accuracy : 0.8046          
##                  95% CI : (0.7378, 0.8607)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 1.00000         
##                                           
##                   Kappa : 0.2005          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.00112         
##                                           
##             Sensitivity : 0.8313          
##             Specificity : 0.5000          
##          Pos Pred Value : 0.9500          
##          Neg Pred Value : 0.2059          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7644          
##    Detection Prevalence : 0.8046          
##       Balanced Accuracy : 0.6656          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-trainingtimes-31" class="section level1">
<h1>Remove Trainingtimes (31)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  129   7
##   Yes  31   7
##                                           
##                Accuracy : 0.7816          
##                  95% CI : (0.7128, 0.8406)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 1.0000000       
##                                           
##                   Kappa : 0.1718          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0001907       
##                                           
##             Sensitivity : 0.8063          
##             Specificity : 0.5000          
##          Pos Pred Value : 0.9485          
##          Neg Pred Value : 0.1842          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7414          
##    Detection Prevalence : 0.7816          
##       Balanced Accuracy : 0.6531          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-perfrating-26" class="section level1">
<h1>Remove PerfRating (26)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 27, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 27, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  131   7
##   Yes  29   7
##                                           
##                Accuracy : 0.7931          
##                  95% CI : (0.7253, 0.8507)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 1.0000000       
##                                           
##                   Kappa : 0.1856          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0004653       
##                                           
##             Sensitivity : 0.8187          
##             Specificity : 0.5000          
##          Pos Pred Value : 0.9493          
##          Neg Pred Value : 0.1944          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7529          
##    Detection Prevalence : 0.7931          
##       Balanced Accuracy : 0.6594          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-joblevel-16" class="section level1">
<h1>Remove JobLevel (16)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:15, 17:22, 24, 27, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:15, 17:22, 24, 27, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  139   6
##   Yes  21   8
##                                           
##                Accuracy : 0.8448          
##                  95% CI : (0.7823, 0.8952)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 0.999658        
##                                           
##                   Kappa : 0.2957          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.007054        
##                                           
##             Sensitivity : 0.8688          
##             Specificity : 0.5714          
##          Pos Pred Value : 0.9586          
##          Neg Pred Value : 0.2759          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7989          
##    Detection Prevalence : 0.8333          
##       Balanced Accuracy : 0.7201          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-relsatis-27" class="section level1">
<h1>Remove RelSatis (27)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:15, 17:22, 24, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:15, 17:22, 24, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  137   6
##   Yes  23   8
##                                           
##                Accuracy : 0.8333          
##                  95% CI : (0.7695, 0.8854)
##     No Information Rate : 0.9195          
##     P-Value [Acc &gt; NIR] : 0.999940        
##                                           
##                   Kappa : 0.2752          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.002967        
##                                           
##             Sensitivity : 0.8562          
##             Specificity : 0.5714          
##          Pos Pred Value : 0.9580          
##          Neg Pred Value : 0.2581          
##              Prevalence : 0.9195          
##          Detection Rate : 0.7874          
##    Detection Prevalence : 0.8218          
##       Balanced Accuracy : 0.7138          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-daily-rate-5" class="section level1">
<h1>Remove Daily Rate (5)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4, 6:9, 12:15, 17:22, 24, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4, 6:9, 12:15, 17:22, 24, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  139   5
##   Yes  21   9
##                                        
##                Accuracy : 0.8506       
##                  95% CI : (0.7888, 0.9)
##     No Information Rate : 0.9195       
##     P-Value [Acc &gt; NIR] : 0.999232     
##                                        
##                   Kappa : 0.3363       
##                                        
##  Mcnemar&#39;s Test P-Value : 0.003264     
##                                        
##             Sensitivity : 0.8688       
##             Specificity : 0.6429       
##          Pos Pred Value : 0.9653       
##          Neg Pred Value : 0.3000       
##              Prevalence : 0.9195       
##          Detection Rate : 0.7989       
##    Detection Prevalence : 0.8276       
##       Balanced Accuracy : 0.7558       
##                                        
##        &#39;Positive&#39; Class : No           
## </code></pre>
</div>
<div id="experiment-with-derived-features" class="section level1">
<h1>Experiment with derived features</h1>
<pre class="r"><code>derived_data = data

derived_data$PerformanceRating = as.numeric(derived_data$PerformanceRating)
derived_data$Education = as.numeric(derived_data$Education)
derived_data$JobLevel = as.numeric(derived_data$JobLevel)

#37
derived_data$PerformancePromotion = derived_data$PerformanceRating * derived_data$YearsSinceLastPromotion
#38
derived_data$Potential = derived_data$Education * derived_data$JobLevel
#39
derived_data$YearsatCoinRole = derived_data$YearsAtCompany * derived_data$YearsInCurrentRole
#40 
derived_data$GoodManager = derived_data$RelationshipSatisfaction * derived_data$YearsWithCurrManager</code></pre>
</div>
<div id="create-train-test-split-with-new-derived-data-set" class="section level1">
<h1>Create Train / Test Split with new derived data set</h1>
<pre class="r"><code>derived_train = derived_data[trainIndices,]
derived_test = derived_data[-trainIndices,]</code></pre>
<div id="final-naive-bayes-model" class="section level3">
<h3>Final Naive-Bayes Model</h3>
</div>
<div id="included-derived-features" class="section level2">
<h2>Included derived features</h2>
</div>
</div>
<div id="create-a-loop-to-resample-data-with-new-seed-100-times-and-get-average-acc-sens-spec" class="section level1">
<h1>Create a loop to resample data with new seed 100 times and get average acc, sens, spec</h1>
<pre class="r"><code>accuracy = c(500)
sensitivity = c(500)
specificity = c(500)
seeds = sample(0:10000, 500, replace = FALSE)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
  trainSet = derived_data[trainIndices,]
  testSet = derived_data[-trainIndices,]
  
  final_class_model = naiveBayes(x = trainSet[c(2, 4, 6, 7, 9, 12:15, 17:22, 24, 30, 32:34, 36, 38, 39)], trainSet$Attrition)
  CM = confusionMatrix(table(predict(final_class_model, testSet[,c(2, 4, 6, 7, 9, 12:15, 17:22, 24, 30, 32:34, 36, 38, 39)]), testSet$Attrition))
  accuracy[i] = CM$overall[1]
  sensitivity[i] = CM$byClass[1]
  specificity[i] = CM$byClass[2]
  
  i = i + 1
}

avg_acc = mean(accuracy)
avg_sen = mean(sensitivity)
avg_spec = mean(specificity)

cat(&#39;The average accuracy is: &#39;, avg_acc, &#39;\n&#39;)</code></pre>
<pre><code>## The average accuracy is:  0.8014713</code></pre>
<pre class="r"><code>cat(&#39;The average sensitivity is: &#39;, avg_sen, &#39;\n&#39;)</code></pre>
<pre><code>## The average sensitivity is:  0.8369746</code></pre>
<pre class="r"><code>cat(&#39;The average specificity is: &#39;, avg_spec, &#39;\n&#39;)</code></pre>
<pre><code>## The average specificity is:  0.6172006</code></pre>
</div>
<div id="using-the-above-model-best-so-far-output-model-performance-and-parameter-estimates-to-determine-the-most-significant-factors" class="section level1">
<h1>Using the above model (best so far), output model performance and parameter estimates to determine the most significant factors</h1>
<pre class="r"><code>final_class_model.summary = summary(final_class_model)
final_class_model$tables</code></pre>
<pre><code>## $Age
##                   Age
## trainSet$Attrition     [,1]     [,2]
##                No  37.38946 8.625051
##                Yes 33.93519 9.458491
## 
## $BusinessTravel
##                   BusinessTravel
## trainSet$Attrition Non-Travel Travel_Frequently Travel_Rarely
##                No  0.11224490        0.17346939    0.71428571
##                Yes 0.09259259        0.26851852    0.63888889
## 
## $Department
##                   Department
## trainSet$Attrition Human Resources Research &amp; Development      Sales
##                No       0.04251701             0.65986395 0.29761905
##                Yes      0.02777778             0.54629630 0.42592593
## 
## $DistanceFromHome
##                   DistanceFromHome
## trainSet$Attrition      [,1]     [,2]
##                No   9.146259 8.084459
##                Yes 11.046296 8.809918
## 
## $EducationField
##                   EducationField
## trainSet$Attrition Human Resources Life Sciences   Marketing     Medical
##                No      0.017006803   0.399659864 0.115646259 0.329931973
##                Yes     0.009259259   0.388888889 0.148148148 0.250000000
##                   EducationField
## trainSet$Attrition       Other Technical Degree
##                No  0.054421769      0.083333333
##                Yes 0.055555556      0.148148148
## 
## $EnvironmentSatisfaction
##                   EnvironmentSatisfaction
## trainSet$Attrition         1         2         3         4
##                No  0.1819728 0.2193878 0.3027211 0.2959184
##                Yes 0.2407407 0.1666667 0.2870370 0.3055556
## 
## $Gender
##                   Gender
## trainSet$Attrition    Female      Male
##                No  0.4115646 0.5884354
##                Yes 0.3796296 0.6203704
## 
## $HourlyRate
##                   HourlyRate
## trainSet$Attrition     [,1]     [,2]
##                No  65.84354 20.28920
##                Yes 66.99074 20.04271
## 
## $JobInvolvement
##                   JobInvolvement
## trainSet$Attrition          1          2          3          4
##                No  0.04081633 0.25000000 0.60884354 0.10034014
##                Yes 0.14814815 0.27777778 0.51851852 0.05555556
## 
## $JobRole
##                   JobRole
## trainSet$Attrition Healthcare Representative Human Resources
##                No                0.102040816     0.032312925
##                Yes               0.064814815     0.027777778
##                   JobRole
## trainSet$Attrition Laboratory Technician     Manager Manufacturing Director
##                No            0.173469388 0.054421769            0.108843537
##                Yes           0.212962963 0.018518519            0.018518519
##                   JobRole
## trainSet$Attrition Research Director Research Scientist Sales Executive
##                No        0.071428571        0.181972789     0.236394558
##                Yes       0.009259259        0.231481481     0.231481481
##                   JobRole
## trainSet$Attrition Sales Representative
##                No           0.039115646
##                Yes          0.185185185
## 
## $JobSatisfaction
##                   JobSatisfaction
## trainSet$Attrition         1         2         3         4
##                No  0.1802721 0.1904762 0.2891156 0.3401361
##                Yes 0.2592593 0.2129630 0.3148148 0.2129630
## 
## $MaritalStatus
##                   MaritalStatus
## trainSet$Attrition  Divorced   Married    Single
##                No  0.2517007 0.4812925 0.2670068
##                Yes 0.1018519 0.3888889 0.5092593
## 
## $MonthlyIncome
##                   MonthlyIncome
## trainSet$Attrition     [,1]     [,2]
##                No  6655.170 4525.618
##                Yes 4651.778 3570.245
## 
## $MonthlyRate
##                   MonthlyRate
## trainSet$Attrition     [,1]     [,2]
##                No  14486.72 7155.028
##                Yes 13825.25 6953.812
## 
## $NumCompaniesWorked
##                   NumCompaniesWorked
## trainSet$Attrition     [,1]     [,2]
##                No  2.629252 2.455456
##                Yes 3.064815 2.809441
## 
## $OverTime
##                   OverTime
## trainSet$Attrition        No       Yes
##                No  0.7602041 0.2397959
##                Yes 0.4074074 0.5925926
## 
## $TotalWorkingYears
##                   TotalWorkingYears
## trainSet$Attrition      [,1]     [,2]
##                No  11.574830 7.354924
##                Yes  7.740741 6.522958
## 
## $WorkLifeBalance
##                   WorkLifeBalance
## trainSet$Attrition     [,1]      [,2]
##                No  2.831633 0.6910620
##                Yes 2.638889 0.7908157
## 
## $YearsAtCompany
##                   YearsAtCompany
## trainSet$Attrition     [,1]     [,2]
##                No  7.156463 5.555605
##                Yes 4.768519 5.381878
## 
## $YearsInCurrentRole
##                   YearsInCurrentRole
## trainSet$Attrition     [,1]     [,2]
##                No  4.452381 3.660570
##                Yes 2.712963 3.232576
## 
## $YearsWithCurrManager
##                   YearsWithCurrManager
## trainSet$Attrition     [,1]     [,2]
##                No  4.401361 3.615526
##                Yes 2.842593 3.174554
## 
## $Potential
##                   Potential
## trainSet$Attrition     [,1]     [,2]
##                No  6.287415 4.132067
##                Yes 4.370370 3.175822
## 
## $YearsatCoinRole
##                   YearsatCoinRole
## trainSet$Attrition     [,1]     [,2]
##                No  47.71769 63.32754
##                Yes 27.81481 62.21475</code></pre>
<div id="logistic-regression-classifier" class="section level43">
<p>LOGISTIC REGRESSION CLASSIFIER</p>
</div>
</div>
<div id="load-libraries-for-logistic-regression" class="section level1">
<h1>Load libraries for logistic regression</h1>
<pre class="r"><code>library(ISLR)
library(gridExtra)</code></pre>
</div>
<div id="experiment-with-additional-derived-features-for-logistic-regression-analysis" class="section level1">
<h1>Experiment with additional derived features for logistic regression analysis</h1>
<pre class="r"><code>derived_data = data
derived_data$PerformanceRating = as.numeric(derived_data$PerformanceRating)
derived_data$Education = as.numeric(derived_data$Education)
derived_data$JobLevel = as.numeric(derived_data$JobLevel)

#37
derived_data$PerformancePromotion = derived_data$PerformanceRating * derived_data$YearsSinceLastPromotion
#38
derived_data$Potential = derived_data$Education * derived_data$JobLevel
#39
derived_data$YearsatCoinRole = derived_data$YearsAtCompany * derived_data$YearsInCurrentRole
#40 
derived_data$GoodManager = as.numeric(derived_data$RelationshipSatisfaction) * derived_data$YearsWithCurrManager
#41 
derived_data$BinOver = as.numeric(ifelse(derived_data$OverTime == &#39;Yes&#39;, 1, 0))
#42
derived_data$EnvOver = derived_data$BinOver * as.numeric(derived_data$EnvironmentSatisfaction)</code></pre>
</div>
<div id="cast-factored-numeric-data-as-numeric" class="section level1">
<h1>Cast factored numeric data as numeric</h1>
<pre class="r"><code>derived_data$EnvironmentSatisfaction = as.numeric(derived_data$EnvironmentSatisfaction)
derived_data$JobSatisfaction = as.numeric(derived_data$JobSatisfaction)
derived_data$JobInvolvement = as.numeric(derived_data$JobInvolvement)
derived_data$PerformanceRating = as.numeric(derived_data$PerformanceRating)
derived_data$RelationshipSatisfaction = as.numeric(derived_data$RelationshipSatisfaction)
derived_data$Education = as.numeric(derived_data$Education)</code></pre>
</div>
<div id="standardize-data-for-logistic-regression" class="section level1">
<h1>Standardize data for logistic regression</h1>
<pre class="r"><code>standard_data = standardize(formula = Attrition ~ Age + BusinessTravel + DistanceFromHome + 
                                   EnvironmentSatisfaction + HourlyRate + JobInvolvement + JobSatisfaction +
                                   MaritalStatus + NumCompaniesWorked + OverTime + 
                                   RelationshipSatisfaction + TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany +
                                   WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager + 
                                   YearsatCoinRole + JobRole + JobLevel + Potential + Education + Gender + MonthlyRate + DailyRate +
                                   PerformanceRating + MonthlyIncome + PerformancePromotion + EducationField + Department + PercentSalaryHike +
                                   StockOptionLevel + GoodManager + EnvOver -1, data = derived_data, family = binomial(link = &#39;logit&#39;))</code></pre>
</div>
<div id="add-categorical-data-back-into-standardized-data-frame" class="section level1">
<h1>Add categorical data back into standardized data frame</h1>
<pre class="r"><code>standardized = data.frame(&#39;Attrition&#39; = standard_data$data$Attrition, &#39;Age&#39; = standard_data$data$Age, 
                          &#39;BusinessTravel&#39; = derived_data$BusinessTravel, &#39;DistanceFromHome&#39; = standard_data$data$DistanceFromHome,
                          &#39;EnvironmentSatisfaction&#39;= standard_data$data$EnvironmentSatisfaction, &#39;HourlyRate&#39;= standard_data$data$HourlyRate, 
                          &#39;JobInvolvement&#39; = standard_data$data$JobInvolvement, &#39;JobSatisfaction&#39;= standard_data$data$JobSatisfaction,
                          &#39;MaritalStatus&#39; = derived_data$MaritalStatus, &#39;NumCompaniesWorked&#39;= standard_data$data$NumCompaniesWorked,
                          &#39;OverTime&#39; = derived_data$OverTime, &#39;RelationshipSatisfaction&#39;= standard_data$data$RelationshipSatisfaction,
                          &#39;TotalWorkingYears&#39;= standard_data$data$TotalWorkingYears, 
                          &#39;TrainingTimesLastYear&#39;= standard_data$data$TrainingTimesLastYear, &#39;WorkLifeBalance&#39; = standard_data$data$WorkLifeBalance,
                          &#39;YearsAtCompany&#39; = standard_data$data$YearsAtCompany,
                          &#39;YearsInCurrentRole&#39;= standard_data$data$YearsInCurrentRole, 
                          &#39;YearsSinceLastPromotion&#39;= standard_data$data$YearsSinceLastPromotion, 
                          &#39;YearsWithCurrManager&#39;= standard_data$data$YearsWithCurrManager, &#39;YearsatCoinRole&#39;= standard_data$data$YearsatCoinRole,
                          &#39;JobRole&#39;= derived_data$JobRole, &#39;JobLevel&#39; = standard_data$data$JobLevel, &#39;Potential&#39; = standard_data$data$Potential,
                          &#39;Education&#39; = standard_data$data$Education, &#39;Gender&#39; = derived_data$Gender, 
                          &#39;MonthlyRate&#39; = standard_data$data$MonthlyRate, &#39;DailyRate&#39; = standard_data$data$DailyRate,
                          &#39;PerformanceRating&#39;= standard_data$data$PerformanceRating, &#39;MonthlyIncome&#39;= standard_data$data$MonthlyIncome, 
                          &#39;PerformancePromotion&#39;= standard_data$data$PerformancePromotion, &#39;EducationField&#39;= derived_data$EducationField, 
                          &#39;Department&#39;= derived_data$Department, &#39;PercentSalaryHike&#39;= standard_data$data$PercentSalaryHike,
                          &#39;StockOptionLevel&#39;= standard_data$data$StockOptionLevel, &#39;GoodManager&#39; = standard_data$data$GoodManager, 
                          &#39;EnvOver&#39; = standard_data$data$EnvOver)</code></pre>
</div>
<div id="determine-which-variables-are-correlated.-remove-if-correlation-0.5" class="section level1">
<h1>Determine which variables are correlated. Remove if correlation &gt; 0.5</h1>
<pre class="r"><code>correlationMatrix &lt;- cor(standardized[,c(2, 4:8, 10, 12:20, 22:24, 26, 27, 29, 30, 33:36)])

highlyCorrelated &lt;- findCorrelation(correlationMatrix, cutoff = 0.5)
print(highlyCorrelated)</code></pre>
<pre><code>## [1] 12  9 16 17 13 22 18 15 14</code></pre>
<pre class="r"><code>print(correlationMatrix)</code></pre>
<pre><code>##                                   Age DistanceFromHome EnvironmentSatisfaction
## Age                       1.000000000      0.006647112           -7.449882e-03
## DistanceFromHome          0.006647112      1.000000000           -3.870075e-02
## EnvironmentSatisfaction  -0.007449882     -0.038700752            1.000000e+00
## HourlyRate                0.052328259      0.067040911           -3.418928e-02
## JobInvolvement            0.016073296     -0.004277505           -3.419785e-05
## JobSatisfaction          -0.022363414     -0.021218476           -1.841649e-02
## NumCompaniesWorked        0.293521877     -0.048909244            1.294575e-02
## RelationshipSatisfaction -0.005340777      0.036234469            4.550669e-03
## TotalWorkingYears         0.652613137      0.004186191           -1.995653e-02
## TrainingTimesLastYear    -0.045281792     -0.038949194           -1.450192e-02
## WorkLifeBalance          -0.012229885     -0.013820292            8.412080e-02
## YearsAtCompany            0.289538716     -0.020830094           -1.510054e-02
## YearsInCurrentRole        0.208349696     -0.008407782            2.249029e-02
## YearsSinceLastPromotion   0.217191680     -0.016595666            9.176822e-03
## YearsWithCurrManager      0.185383795     -0.017700612           -2.329230e-02
## YearsatCoinRole           0.273684204     -0.014858807            1.260086e-03
## JobLevel                  0.479423564      0.021727054            1.545152e-04
## Potential                 0.457160510      0.048761805           -3.059007e-02
## Education                 0.217290207      0.049512940           -3.652790e-02
## MonthlyRate               0.071740854     -0.007839039            5.927864e-02
## DailyRate                 0.012736692      0.014944536           -1.338386e-02
## MonthlyIncome             0.484288301     -0.006667155           -1.687744e-02
## PerformancePromotion      0.208467601     -0.015993994            4.844743e-03
## PercentSalaryHike        -0.030804192      0.054293690            1.139159e-03
## StockOptionLevel          0.044759576      0.071680428            3.028302e-02
## GoodManager               0.155829400      0.018035307           -1.853702e-02
## EnvOver                   0.015979904      0.054326588            2.707745e-01
##                             HourlyRate JobInvolvement JobSatisfaction
## Age                       5.232826e-02   1.607330e-02    -0.022363414
## DistanceFromHome          6.704091e-02  -4.277505e-03    -0.021218476
## EnvironmentSatisfaction  -3.418928e-02  -3.419785e-05    -0.018416488
## HourlyRate                1.000000e+00   7.036098e-02    -0.089040641
## JobInvolvement            7.036098e-02   1.000000e+00    -0.052949460
## JobSatisfaction          -8.904064e-02  -5.294946e-02     1.000000000
## NumCompaniesWorked        1.412012e-02  -5.613845e-03    -0.075753415
## RelationshipSatisfaction  1.537703e-02   1.685454e-02    -0.033860142
## TotalWorkingYears         2.947671e-02  -1.398641e-02    -0.049281026
## TrainingTimesLastYear     5.822839e-03  -2.241602e-02    -0.029577808
## WorkLifeBalance          -2.548651e-02   7.736011e-03    -0.026470304
## YearsAtCompany            4.990148e-05  -4.159642e-02     0.028363964
## YearsInCurrentRole        2.159320e-04   1.317048e-02    -0.003471690
## YearsSinceLastPromotion   8.053699e-03  -3.043052e-02    -0.021795589
## YearsWithCurrManager     -2.493375e-03   1.088728e-02     0.007359588
## YearsatCoinRole           1.418603e-02  -3.311681e-02     0.016605818
## JobLevel                 -8.070074e-03  -1.587505e-02    -0.050306065
## Potential                 2.285554e-03   1.190657e-02    -0.039344026
## Education                 6.750312e-03   3.225524e-02     0.013111079
## MonthlyRate              -1.603517e-02  -1.827518e-02     0.025139100
## DailyRate                 4.849597e-02   6.011801e-02    -0.002716745
## MonthlyIncome             2.391151e-03   4.473792e-04    -0.053148530
## PerformancePromotion      5.939831e-03  -2.223147e-02    -0.022921028
## PercentSalaryHike        -2.270814e-02   1.432785e-02     0.011967235
## StockOptionLevel          6.461446e-02   7.230297e-02    -0.008030339
## GoodManager               1.140587e-02   2.259161e-02    -0.002291812
## EnvOver                  -3.143698e-02  -2.208532e-02     0.029465654
##                          NumCompaniesWorked RelationshipSatisfaction
## Age                             0.293521877             -0.005340777
## DistanceFromHome               -0.048909244              0.036234469
## EnvironmentSatisfaction         0.012945750              0.004550669
## HourlyRate                      0.014120123              0.015377027
## JobInvolvement                 -0.005613845              0.016854535
## JobSatisfaction                -0.075753415             -0.033860142
## NumCompaniesWorked              1.000000000              0.042047644
## RelationshipSatisfaction        0.042047644              1.000000000
## TotalWorkingYears               0.258099959             -0.017575299
## TrainingTimesLastYear          -0.070591665              0.015752447
## WorkLifeBalance                 0.021316529              0.037105402
## YearsAtCompany                 -0.142025883              0.008377778
## YearsInCurrentRole             -0.103814233             -0.001097767
## YearsSinceLastPromotion        -0.071218393              0.032135460
## YearsWithCurrManager           -0.122974681             -0.016131001
## YearsatCoinRole                -0.102237354              0.017738692
## JobLevel                        0.140834828             -0.004820462
## Potential                       0.181187075             -0.009031528
## Education                       0.160918010             -0.025717762
## MonthlyRate                     0.016753747             -0.024004655
## DailyRate                       0.051559831              0.013643236
## MonthlyIncome                   0.155894318             -0.003884678
## PerformancePromotion           -0.076781988              0.031843058
## PercentSalaryHike              -0.022434259             -0.045721608
## StockOptionLevel                0.032887211             -0.032980838
## GoodManager                    -0.068311398              0.397221066
## EnvOver                        -0.004615721              0.023535064
##                          TotalWorkingYears TrainingTimesLastYear
## Age                            0.652613137          -0.045281792
## DistanceFromHome               0.004186191          -0.038949194
## EnvironmentSatisfaction       -0.019956530          -0.014501924
## HourlyRate                     0.029476711           0.005822839
## JobInvolvement                -0.013986410          -0.022416021
## JobSatisfaction               -0.049281026          -0.029577808
## NumCompaniesWorked             0.258099959          -0.070591665
## RelationshipSatisfaction      -0.017575299           0.015752447
## TotalWorkingYears              1.000000000          -0.041912467
## TrainingTimesLastYear         -0.041912467           1.000000000
## WorkLifeBalance                0.018724536           0.021735800
## YearsAtCompany                 0.636083586           0.020192712
## YearsInCurrentRole             0.486590295          -0.016429957
## YearsSinceLastPromotion        0.445838540          -0.042382617
## YearsWithCurrManager           0.461485375           0.003914247
## YearsatCoinRole                0.592099292           0.004733390
## JobLevel                       0.780752353          -0.045864316
## Potential                      0.663928921          -0.071040607
## Education                      0.146044538          -0.063134803
## MonthlyRate                    0.057889875          -0.013358464
## DailyRate                     -0.007402129          -0.010589800
## MonthlyIncome                  0.778511205          -0.039014567
## PerformancePromotion           0.436158482          -0.049678258
## PercentSalaryHike             -0.064304461           0.001525276
## StockOptionLevel               0.036235025           0.017341207
## GoodManager                    0.395269311           0.005006081
## EnvOver                       -0.026015625          -0.049930740
##                          WorkLifeBalance YearsAtCompany YearsInCurrentRole
## Age                         -0.012229885   2.895387e-01       0.2083496959
## DistanceFromHome            -0.013820292  -2.083009e-02      -0.0084077816
## EnvironmentSatisfaction      0.084120802  -1.510054e-02       0.0224902874
## HourlyRate                  -0.025486510   4.990148e-05       0.0002159320
## JobInvolvement               0.007736011  -4.159642e-02       0.0131704795
## JobSatisfaction             -0.026470304   2.836396e-02      -0.0034716898
## NumCompaniesWorked           0.021316529  -1.420259e-01      -0.1038142325
## RelationshipSatisfaction     0.037105402   8.377778e-03      -0.0010977668
## TotalWorkingYears            0.018724536   6.360836e-01       0.4865902950
## TrainingTimesLastYear        0.021735800   2.019271e-02      -0.0164299570
## WorkLifeBalance              1.000000000   2.947258e-02       0.0821049336
## YearsAtCompany               0.029472580   1.000000e+00       0.7761164180
## YearsInCurrentRole           0.082104934   7.761164e-01       1.0000000000
## YearsSinceLastPromotion      0.041653100   6.440298e-01       0.5537100485
## YearsWithCurrManager         0.018378039   7.652262e-01       0.7094612168
## YearsatCoinRole              0.076997849   8.868509e-01       0.8730029478
## JobLevel                     0.030283868   5.205835e-01       0.3913048192
## Potential                    0.028600905   4.086092e-01       0.3020069611
## Education                    0.009824289   6.197449e-02       0.0613816197
## MonthlyRate                  0.006510198  -1.803946e-02       0.0252185990
## DailyRate                   -0.029869221  -3.714277e-02      -0.0006759731
## MonthlyIncome                0.020804889   4.913790e-01       0.3618405206
## PerformancePromotion         0.045669102   6.342111e-01       0.5518384949
## PercentSalaryHike            0.007475735  -5.748031e-02      -0.0229356539
## StockOptionLevel             0.046998821   2.849091e-02       0.0809014903
## GoodManager                  0.046618250   6.577632e-01       0.5997600265
## EnvOver                      0.006499293  -1.820520e-02      -0.0216839356
##                          YearsSinceLastPromotion YearsWithCurrManager
## Age                                  0.217191680          0.185383795
## DistanceFromHome                    -0.016595666         -0.017700612
## EnvironmentSatisfaction              0.009176822         -0.023292298
## HourlyRate                           0.008053699         -0.002493375
## JobInvolvement                      -0.030430518          0.010887282
## JobSatisfaction                     -0.021795589          0.007359588
## NumCompaniesWorked                  -0.071218393         -0.122974681
## RelationshipSatisfaction             0.032135460         -0.016131001
## TotalWorkingYears                    0.445838540          0.461485375
## TrainingTimesLastYear               -0.042382617          0.003914247
## WorkLifeBalance                      0.041653100          0.018378039
## YearsAtCompany                       0.644029778          0.765226243
## YearsInCurrentRole                   0.553710048          0.709461217
## YearsSinceLastPromotion              1.000000000          0.508935431
## YearsWithCurrManager                 0.508935431          1.000000000
## YearsatCoinRole                      0.612666442          0.637439812
## JobLevel                             0.330435705          0.366567472
## Potential                            0.271272365          0.306603084
## Education                            0.068329974          0.088446276
## MonthlyRate                          0.007491151         -0.021310286
## DailyRate                           -0.058558731         -0.024346829
## MonthlyIncome                        0.315911576          0.328487453
## PerformancePromotion                 0.991687559          0.506022609
## PercentSalaryHike                   -0.074040285         -0.045232326
## StockOptionLevel                     0.012955322          0.036542574
## GoodManager                          0.453173111          0.845923908
## EnvOver                             -0.009981863         -0.057875794
##                          YearsatCoinRole      JobLevel    Potential
## Age                          0.273684204  0.4794235642  0.457160510
## DistanceFromHome            -0.014858807  0.0217270544  0.048761805
## EnvironmentSatisfaction      0.001260086  0.0001545152 -0.030590068
## HourlyRate                   0.014186033 -0.0080700744  0.002285554
## JobInvolvement              -0.033116809 -0.0158750522  0.011906568
## JobSatisfaction              0.016605818 -0.0503060650 -0.039344026
## NumCompaniesWorked          -0.102237354  0.1408348284  0.181187075
## RelationshipSatisfaction     0.017738692 -0.0048204622 -0.009031528
## TotalWorkingYears            0.592099292  0.7807523526  0.663928921
## TrainingTimesLastYear        0.004733390 -0.0458643163 -0.071040607
## WorkLifeBalance              0.076997849  0.0302838677  0.028600905
## YearsAtCompany               0.886850897  0.5205835070  0.408609205
## YearsInCurrentRole           0.873002948  0.3913048192  0.302006961
## YearsSinceLastPromotion      0.612666442  0.3304357051  0.271272365
## YearsWithCurrManager         0.637439812  0.3665674724  0.306603084
## YearsatCoinRole              1.000000000  0.4738319265  0.367063131
## JobLevel                     0.473831927  1.0000000000  0.831845133
## Potential                    0.367063131  0.8318451334  1.000000000
## Education                    0.050108011  0.1303859075  0.593402075
## MonthlyRate                  0.008372327  0.0744538290  0.047014918
## DailyRate                   -0.030298899  0.0018376264  0.012324827
## MonthlyIncome                0.456378847  0.9516400488  0.800150585
## PerformancePromotion         0.605473074  0.3212745642  0.260832053
## PercentSalaryHike           -0.038207773 -0.0622671489 -0.054946701
## StockOptionLevel             0.050889267  0.0188872312  0.021472702
## GoodManager                  0.554986362  0.3119767397  0.263907836
## EnvOver                     -0.001788085 -0.0156095369 -0.036360939
##                             Education  MonthlyRate     DailyRate MonthlyIncome
## Age                       0.217290207  0.071740854  1.273669e-02  4.842883e-01
## DistanceFromHome          0.049512940 -0.007839039  1.494454e-02 -6.667155e-03
## EnvironmentSatisfaction  -0.036527898  0.059278643 -1.338386e-02 -1.687744e-02
## HourlyRate                0.006750312 -0.016035168  4.849597e-02  2.391151e-03
## JobInvolvement            0.032255238 -0.018275178  6.011801e-02  4.473792e-04
## JobSatisfaction           0.013111079  0.025139100 -2.716745e-03 -5.314853e-02
## NumCompaniesWorked        0.160918010  0.016753747  5.155983e-02  1.558943e-01
## RelationshipSatisfaction -0.025717762 -0.024004655  1.364324e-02 -3.884678e-03
## TotalWorkingYears         0.146044538  0.057889875 -7.402129e-03  7.785112e-01
## TrainingTimesLastYear    -0.063134803 -0.013358464 -1.058980e-02 -3.901457e-02
## WorkLifeBalance           0.009824289  0.006510198 -2.986922e-02  2.080489e-02
## YearsAtCompany            0.061974487 -0.018039461 -3.714277e-02  4.913790e-01
## YearsInCurrentRole        0.061381620  0.025218599 -6.759731e-04  3.618405e-01
## YearsSinceLastPromotion   0.068329974  0.007491151 -5.855873e-02  3.159116e-01
## YearsWithCurrManager      0.088446276 -0.021310286 -2.434683e-02  3.284875e-01
## YearsatCoinRole           0.050108011  0.008372327 -3.029890e-02  4.563788e-01
## JobLevel                  0.130385908  0.074453829  1.837626e-03  9.516400e-01
## Potential                 0.593402075  0.047014918  1.232483e-02  8.001506e-01
## Education                 1.000000000 -0.020183862 -1.453569e-02  1.271314e-01
## MonthlyRate              -0.020183862  1.000000000 -2.764077e-02  6.459407e-02
## DailyRate                -0.014535694 -0.027640771  1.000000e+00  8.790339e-05
## MonthlyIncome             0.127131394  0.064594067  8.790339e-05  1.000000e+00
## PerformancePromotion      0.060710483  0.002683928 -6.241501e-02  3.061470e-01
## PercentSalaryHike        -0.002387120  0.001642760  2.787530e-02 -5.386594e-02
## StockOptionLevel          0.030706874 -0.036521825  2.358864e-02  1.888872e-02
## GoodManager               0.073332636 -0.044140150 -1.018722e-02  2.850042e-01
## EnvOver                  -0.039442966  0.020088262  8.316250e-03 -2.318921e-02
##                          PerformancePromotion PercentSalaryHike
## Age                               0.208467601      -0.030804192
## DistanceFromHome                 -0.015993994       0.054293690
## EnvironmentSatisfaction           0.004844743       0.001139159
## HourlyRate                        0.005939831      -0.022708145
## JobInvolvement                   -0.022231473       0.014327853
## JobSatisfaction                  -0.022921028       0.011967235
## NumCompaniesWorked               -0.076781988      -0.022434259
## RelationshipSatisfaction          0.031843058      -0.045721608
## TotalWorkingYears                 0.436158482      -0.064304461
## TrainingTimesLastYear            -0.049678258       0.001525276
## WorkLifeBalance                   0.045669102       0.007475735
## YearsAtCompany                    0.634211093      -0.057480309
## YearsInCurrentRole                0.551838495      -0.022935654
## YearsSinceLastPromotion           0.991687559      -0.074040285
## YearsWithCurrManager              0.506022609      -0.045232326
## YearsatCoinRole                   0.605473074      -0.038207773
## JobLevel                          0.321274564      -0.062267149
## Potential                         0.260832053      -0.054946701
## Education                         0.060710483      -0.002387120
## MonthlyRate                       0.002683928       0.001642760
## DailyRate                        -0.062415014       0.027875304
## MonthlyIncome                     0.306146984      -0.053865939
## PerformancePromotion              1.000000000      -0.014713883
## PercentSalaryHike                -0.014713883       1.000000000
## StockOptionLevel                  0.014729747      -0.004891114
## GoodManager                       0.452197558      -0.047658956
## EnvOver                          -0.009695530      -0.001030365
##                          StockOptionLevel  GoodManager       EnvOver
## Age                          4.475958e-02  0.155829400  1.597990e-02
## DistanceFromHome             7.168043e-02  0.018035307  5.432659e-02
## EnvironmentSatisfaction      3.028302e-02 -0.018537016  2.707745e-01
## HourlyRate                   6.461446e-02  0.011405869 -3.143698e-02
## JobInvolvement               7.230297e-02  0.022591613 -2.208532e-02
## JobSatisfaction             -8.030339e-03 -0.002291812  2.946565e-02
## NumCompaniesWorked           3.288721e-02 -0.068311398 -4.615721e-03
## RelationshipSatisfaction    -3.298084e-02  0.397221066  2.353506e-02
## TotalWorkingYears            3.623502e-02  0.395269311 -2.601562e-02
## TrainingTimesLastYear        1.734121e-02  0.005006081 -4.993074e-02
## WorkLifeBalance              4.699882e-02  0.046618250  6.499293e-03
## YearsAtCompany               2.849091e-02  0.657763224 -1.820520e-02
## YearsInCurrentRole           8.090149e-02  0.599760026 -2.168394e-02
## YearsSinceLastPromotion      1.295532e-02  0.453173111 -9.981863e-03
## YearsWithCurrManager         3.654257e-02  0.845923908 -5.787579e-02
## YearsatCoinRole              5.088927e-02  0.554986362 -1.788085e-03
## JobLevel                     1.888723e-02  0.311976740 -1.560954e-02
## Potential                    2.147270e-02  0.263907836 -3.636094e-02
## Education                    3.070687e-02  0.073332636 -3.944297e-02
## MonthlyRate                 -3.652183e-02 -0.044140150  2.008826e-02
## DailyRate                    2.358864e-02 -0.010187222  8.316250e-03
## MonthlyIncome                1.888872e-02  0.285004211 -2.318921e-02
## PerformancePromotion         1.472975e-02  0.452197558 -9.695530e-03
## PercentSalaryHike           -4.891114e-03 -0.047658956 -1.030365e-03
## StockOptionLevel             1.000000e+00  0.030883080 -6.619217e-06
## GoodManager                  3.088308e-02  1.000000000 -3.752610e-02
## EnvOver                     -6.619217e-06 -0.037526104  1.000000e+00</code></pre>
</div>
<div id="remove-correlated-variables" class="section level1">
<h1>Remove Correlated variables</h1>
<pre class="r"><code>reducedStandardized = standardized[, c(1, 3:15, 17, 21, 22, 24:29, 31:34, 36)]</code></pre>
<div id="section-3" class="section level7">
<p></p>
</div>
</div>
<div id="create-training-and-test-sets-dont-use" class="section level1">
<h1>Create training and test sets # Don’t use</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
trainSet = reducedStandardized[trainIndices,]
testSet = reducedStandardized[-trainIndices,]</code></pre>
<div id="section-4" class="section level6">
<h6></h6>
</div>
</div>
<div id="create-training-and-test-sets" class="section level1">
<h1>Create training and test sets</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
trainSet = standardized[trainIndices,]
testSet = standardized[-trainIndices,]</code></pre>
</div>
<div id="train-and-test-logistic-regression-model-and-output-its-performance-metrics.-this-model-is-capable-of-ascertaining-the-statistical-significance-of-the-relationships." class="section level1">
<h1>Train and test logistic regression model and output its performance metrics. This model is capable of ascertaining the statistical significance of the relationships.</h1>
</div>
<div id="full-model" class="section level1">
<h1>FULL MODEL</h1>
<pre class="r"><code>logistic_regression_model = glm(Attrition ~ Age + BusinessTravel + DailyRate + Department + DistanceFromHome + Education + 
                                EducationField + Gender + EnvironmentSatisfaction + HourlyRate + JobInvolvement + JobLevel + JobRole +
                                JobSatisfaction + MaritalStatus + MonthlyIncome + MonthlyRate + NumCompaniesWorked + OverTime + 
                                PercentSalaryHike + PerformanceRating + RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + 
                                TrainingTimesLastYear + YearsAtCompany + WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion +
                                YearsWithCurrManager + Potential + YearsatCoinRole + PerformancePromotion + GoodManager + EnvOver -1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)</code></pre>
<pre><code>## Warning: contrasts dropped from factor PerformanceRating</code></pre>
<pre class="r"><code>summary(logistic_regression_model)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Attrition ~ Age + BusinessTravel + DailyRate + 
##     Department + DistanceFromHome + Education + EducationField + 
##     Gender + EnvironmentSatisfaction + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + JobSatisfaction + MaritalStatus + MonthlyIncome + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     PerformanceRating + RelationshipSatisfaction + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager + Potential + YearsatCoinRole + PerformancePromotion + 
##     GoodManager + EnvOver - 1, family = binomial(link = &quot;logit&quot;), 
##     data = standardized)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5766  -0.4361  -0.1769  -0.0444   3.4535  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## Age                               -0.24610    0.17144  -1.436 0.151134    
## BusinessTravelNon-Travel         -16.88124  721.54625  -0.023 0.981334    
## BusinessTravelTravel_Frequently  -15.12126  721.54604  -0.021 0.983280    
## BusinessTravelTravel_Rarely      -15.99073  721.54608  -0.022 0.982319    
## DailyRate                         -0.13024    0.13018  -1.000 0.317098    
## DepartmentResearch &amp; Development  11.73262  721.54476   0.016 0.987027    
## DepartmentSales                   12.08711  721.54458   0.017 0.986635    
## DistanceFromHome                   0.43297    0.12616   3.432 0.000599 ***
## Education                          0.35157    0.26059   1.349 0.177290    
## EducationFieldLife Sciences       -1.01360    1.26380  -0.802 0.422538    
## EducationFieldMarketing           -1.09025    1.32201  -0.825 0.409546    
## EducationFieldMedical             -0.81567    1.25887  -0.648 0.517025    
## EducationFieldOther               -0.73904    1.32169  -0.559 0.576049    
## EducationFieldTechnical Degree    -0.20041    1.29968  -0.154 0.877450    
## GenderMale                         0.27319    0.26008   1.050 0.293533    
## EnvironmentSatisfaction           -0.35279    0.17435  -2.023 0.043030 *  
## HourlyRate                         0.23283    0.13262   1.756 0.079165 .  
## JobInvolvement                    -0.60464    0.12494  -4.840 1.30e-06 ***
## JobLevel                           0.56554    0.63890   0.885 0.376064    
## JobRoleHuman Resources            13.06540  721.54535   0.018 0.985553    
## JobRoleLaboratory Technician       1.02502    0.62954   1.628 0.103484    
## JobRoleManager                    -1.33640    1.32386  -1.009 0.312748    
## JobRoleManufacturing Director     -2.09870    0.93835  -2.237 0.025313 *  
## JobRoleResearch Director          -2.40307    1.40176  -1.714 0.086470 .  
## JobRoleResearch Scientist          0.43876    0.63365   0.692 0.488668    
## JobRoleSales Executive             0.53229    1.40672   0.378 0.705140    
## JobRoleSales Representative        1.88142    1.47494   1.276 0.202098    
## JobSatisfaction                   -0.59999    0.13246  -4.530 5.91e-06 ***
## MaritalStatusMarried               0.95937    0.43307   2.215 0.026741 *  
## MaritalStatusSingle                1.92360    0.53361   3.605 0.000312 ***
## MonthlyIncome                      0.54641    0.57156   0.956 0.339072    
## MonthlyRate                       -0.11614    0.12930  -0.898 0.369059    
## NumCompaniesWorked                 0.64159    0.14797   4.336 1.45e-05 ***
## OverTimeYes                        2.51288    0.67086   3.746 0.000180 ***
## PercentSalaryHike                 -0.16083    0.20850  -0.771 0.440503    
## PerformanceRating3                -0.38022    0.30655  -1.240 0.214855    
## RelationshipSatisfaction          -0.42864    0.18057  -2.374 0.017605 *  
## StockOptionLevel                  -0.04602    0.18274  -0.252 0.801181    
## TotalWorkingYears                 -1.00960    0.33255  -3.036 0.002398 ** 
## TrainingTimesLastYear             -0.40064    0.13945  -2.873 0.004067 ** 
## YearsAtCompany                    -0.60485    0.40480  -1.494 0.135127    
## WorkLifeBalance                   -0.49903    0.12944  -3.855 0.000116 ***
## YearsInCurrentRole                -1.40000    0.31328  -4.469 7.87e-06 ***
## YearsSinceLastPromotion            1.54226    1.16438   1.325 0.185325    
## YearsWithCurrManager              -0.46760    0.42600  -1.098 0.272362    
## Potential                         -0.83083    0.50989  -1.629 0.103221    
## YearsatCoinRole                    1.87677    0.39696   4.728 2.27e-06 ***
## PerformancePromotion              -0.76189    1.15314  -0.661 0.508799    
## GoodManager                        0.40442    0.38715   1.045 0.296206    
## EnvOver                           -0.19052    0.32544  -0.585 0.558274    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1206.08  on 870  degrees of freedom
## Residual deviance:  443.59  on 820  degrees of freedom
## AIC: 543.59
## 
## Number of Fisher Scoring iterations: 15</code></pre>
<pre class="r"><code>fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)</code></pre>
<pre><code>## Warning: contrasts dropped from factor PerformanceRating</code></pre>
<pre class="r"><code>log.probs = as.data.frame(fitted.results)$fitted.results
testSet$Prob_Attrition = log.probs
fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)

misclass_error = mean(fitted.results != testSet$Attrition)
fitted.df = as.data.frame(fitted.results)

TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)

TruePos = testSet[TruePosIndices,]
TrueNeg = testSet[TrueNegIndices,]
fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])

sensitivity = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
specificity = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)


print(paste(&#39;Accuracy is &#39;, 1 - misclass_error))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.908045977011494&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, sensitivity))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.538461538461538&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, specificity))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.972972972972973&quot;</code></pre>
</div>
<div id="cross-validation-for-full-model" class="section level1">
<h1>Cross validation for FULL model</h1>
<pre class="r"><code>accuracy = c(500)
sensitivity = c(500)
specificity = c(500)
seeds = sample(0:10000, 500, replace = FALSE)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
  trainSet = standardized[trainIndices,]
  testSet = standardized[-trainIndices,]
  
logistic_regression_model = glm(Attrition ~ Age + BusinessTravel + DailyRate + Department + DistanceFromHome + Education + 
                                EducationField + Gender + EnvironmentSatisfaction + HourlyRate + JobInvolvement + JobLevel + JobRole +
                                JobSatisfaction + MaritalStatus + MonthlyIncome + MonthlyRate + NumCompaniesWorked + OverTime + 
                                PercentSalaryHike + PerformanceRating + RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + 
                                TrainingTimesLastYear + YearsAtCompany + WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion +
                                YearsWithCurrManager + Potential + YearsatCoinRole + PerformancePromotion + GoodManager + EnvOver -1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)
log.probs = as.data.frame(fitted.results)$fitted.results
testSet$Prob_Attrition = log.probs
fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)

misclass_error = mean(fitted.results != testSet$Attrition)
fitted.df = as.data.frame(fitted.results)

TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)

TruePos = testSet[TruePosIndices,]
TrueNeg = testSet[TrueNegIndices,]
fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])

accuracy[i] = 1 - misclass_error
sensitivity[i] = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
specificity[i] = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)
  
  i = i + 1
}</code></pre>
<pre><code>## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating</code></pre>
<pre class="r"><code>avg_acc = mean(accuracy)
avg_sen = mean(sensitivity)
avg_spec = mean(specificity)

print(paste(&#39;Accuracy is &#39;, avg_acc))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.899574712643678&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, avg_sen))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.536042554464981&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, avg_spec))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.970119802236214&quot;</code></pre>
<div id="be" class="section level28">
<p>BE</p>
<div id="use-this-for-top-3" class="section level80">
<p>USE THIS FOR TOP 3</p>
</div>
</div>
</div>
<div id="create-training-and-test-sets-1" class="section level1">
<h1>Create training and test sets</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
trainSet = standardized[trainIndices,]
testSet = standardized[-trainIndices,]</code></pre>
</div>
<div id="correlated-variables-removed" class="section level1">
<h1>Correlated variables removed</h1>
</div>
<div id="removed-businesstravel-education-joblevel-percentsalaryhike-performancerating-monthlyrate-stockoptionlevel-gender-yearsincurrentrole-monthlyincome" class="section level1">
<h1>Removed: BusinessTravel Education JobLevel PercentSalaryHike PerformanceRating MonthlyRate StockOptionLevel Gender YearsInCurrentRole MonthlyIncome</h1>
</div>
<div id="hourlyrate-dailyrate-educationfield-relationshipsatisfaction" class="section level1">
<h1>HourlyRate DailyRate EducationField RelationshipSatisfaction</h1>
</div>
<div id="yes-true-pos-0-no-department" class="section level1">
<h1>1 = YES (TRUE POS) 0 = NO Department +</h1>
<pre class="r"><code>logistic_regression_model = glm(Attrition ~ DistanceFromHome + 
                                EnvironmentSatisfaction + JobInvolvement + JobRole +
                                JobSatisfaction + MaritalStatus + + NumCompaniesWorked + OverTime + 
                                TotalWorkingYears + 
                                TrainingTimesLastYear + WorkLifeBalance - 1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)
summary(logistic_regression_model)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Attrition ~ DistanceFromHome + EnvironmentSatisfaction + 
##     JobInvolvement + JobRole + JobSatisfaction + MaritalStatus + 
##     +NumCompaniesWorked + OverTime + TotalWorkingYears + TrainingTimesLastYear + 
##     WorkLifeBalance - 1, family = binomial(link = &quot;logit&quot;), data = standardized)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7762  -0.4891  -0.2780  -0.1246   3.3041  
## 
## Coefficients:
##                                  Estimate Std. Error z value Pr(&gt;|z|)    
## DistanceFromHome                   0.3111     0.1095   2.841 0.004495 ** 
## EnvironmentSatisfaction           -0.2505     0.1122  -2.233 0.025577 *  
## JobInvolvement                    -0.5343     0.1095  -4.881 1.05e-06 ***
## JobRoleHealthcare Representative  -4.1361     0.5666  -7.300 2.89e-13 ***
## JobRoleHuman Resources            -3.1261     0.6209  -5.035 4.79e-07 ***
## JobRoleLaboratory Technician      -3.5409     0.4288  -8.258  &lt; 2e-16 ***
## JobRoleManager                    -4.0087     0.7460  -5.373 7.73e-08 ***
## JobRoleManufacturing Director     -5.9640     0.8391  -7.107 1.18e-12 ***
## JobRoleResearch Director          -5.5875     1.1152  -5.010 5.43e-07 ***
## JobRoleResearch Scientist         -3.9408     0.4270  -9.229  &lt; 2e-16 ***
## JobRoleSales Executive            -3.7667     0.4099  -9.189  &lt; 2e-16 ***
## JobRoleSales Representative       -2.3005     0.4979  -4.620 3.83e-06 ***
## JobSatisfaction                   -0.4556     0.1117  -4.079 4.52e-05 ***
## MaritalStatusMarried               0.9844     0.3714   2.651 0.008033 ** 
## MaritalStatusSingle                1.7042     0.3739   4.558 5.16e-06 ***
## NumCompaniesWorked                 0.4233     0.1121   3.777 0.000159 ***
## OverTimeYes                        1.7725     0.2345   7.560 4.02e-14 ***
## TotalWorkingYears                 -0.4761     0.1729  -2.754 0.005889 ** 
## TrainingTimesLastYear             -0.2746     0.1218  -2.255 0.024154 *  
## WorkLifeBalance                   -0.3367     0.1102  -3.056 0.002245 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1206.08  on 870  degrees of freedom
## Residual deviance:  530.39  on 850  degrees of freedom
## AIC: 570.39
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)
log.probs = as.data.frame(fitted.results)$fitted.results
testSet$Prob_Attrition = log.probs
fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)

misclass_error = mean(fitted.results != testSet$Attrition)
fitted.df = as.data.frame(fitted.results)

TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)

TruePos = testSet[TruePosIndices,]
TrueNeg = testSet[TrueNegIndices,]
fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])

sensitivity = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
specificity = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)


print(paste(&#39;Accuracy is &#39;, 1 - misclass_error))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.850574712643678&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, sensitivity))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.441176470588235&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, specificity))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.95&quot;</code></pre>
<div id="use-this-for-top-3-1" class="section level80">
<p>USE THIS FOR TOP 3</p>
</div>
</div>
<div id="cross-validation-for-reduced-model" class="section level1">
<h1>Cross validation for Reduced model</h1>
<pre class="r"><code>accuracy = c(500)
sensitivity = c(500)
specificity = c(500)
seeds = sample(0:10000, 500, replace = FALSE)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.7*length(derived_data$Attrition)))
  trainSet = reducedStandardized[trainIndices,]
  testSet = reducedStandardized[-trainIndices,]
  
logistic_regression_model = glm(Attrition ~ Department + DistanceFromHome + 
                                EnvironmentSatisfaction + JobInvolvement + JobRole +
                                JobSatisfaction + MaritalStatus + + NumCompaniesWorked + OverTime + 
                                TotalWorkingYears + 
                                TrainingTimesLastYear + WorkLifeBalance - 1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

  fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:28)), type = &#39;response&#39;)
  log.probs = as.data.frame(fitted.results)$fitted.results
  testSet$Prob_Attrition = log.probs
  fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)
  
  misclass_error = mean(fitted.results != testSet$Attrition)
  fitted.df = as.data.frame(fitted.results)
  
  TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
  TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)
  
  TruePos = testSet[TruePosIndices,]
  TrueNeg = testSet[TrueNegIndices,]
  fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
  fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])
  
  accuracy[i] = 1 - misclass_error
  sensitivity[i] = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
  specificity[i] = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)
  
  i = i + 1
}

avg_acc = mean(accuracy)
avg_sen = mean(sensitivity)
avg_spec = mean(specificity)

print(paste(&#39;Accuracy is &#39;, avg_acc))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.88935632183908&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, avg_sen))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.448355803558635&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, avg_spec))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.97428872721112&quot;</code></pre>
<div id="create-classification-output-predictions" class="section level3">
<h3>Create classification output predictions</h3>
<div id="read-in-test-data" class="section level4">
<h4>Read in test data</h4>
<pre class="r"><code>class_test_data = read.csv(file = &#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2CompSet No Attrition.csv&#39;, header = T)

class_test_data</code></pre>
<pre><code>##      ID Age    BusinessTravel DailyRate             Department DistanceFromHome
## 1  1171  35     Travel_Rarely       750 Research &amp; Development               28
## 2  1172  33     Travel_Rarely       147        Human Resources                2
## 3  1173  26     Travel_Rarely      1330 Research &amp; Development               21
## 4  1174  55     Travel_Rarely      1311 Research &amp; Development                2
## 5  1175  29     Travel_Rarely      1246                  Sales               19
## 6  1176  51 Travel_Frequently      1456 Research &amp; Development                1
## 7  1177  52        Non-Travel       585                  Sales               29
## 8  1178  39     Travel_Rarely      1387 Research &amp; Development               10
## 9  1179  31     Travel_Rarely      1062 Research &amp; Development               24
## 10 1180  31 Travel_Frequently       534 Research &amp; Development               20
## 11 1181  40 Travel_Frequently      1469 Research &amp; Development                9
## 12 1182  31     Travel_Rarely      1082 Research &amp; Development                1
## 13 1183  33        Non-Travel       775 Research &amp; Development                4
## 14 1184  50     Travel_Rarely       691 Research &amp; Development                2
## 15 1185  33     Travel_Rarely       516 Research &amp; Development                8
## 16 1186  42        Non-Travel       335 Research &amp; Development               23
## 17 1187  33     Travel_Rarely       575 Research &amp; Development               25
## 18 1188  29     Travel_Rarely       694 Research &amp; Development                1
## 19 1189  55     Travel_Rarely       436                  Sales                2
## 20 1190  49     Travel_Rarely      1184                  Sales               11
## 21 1191  32     Travel_Rarely       267 Research &amp; Development               29
## 22 1192  50     Travel_Rarely      1126 Research &amp; Development                1
## 23 1193  54     Travel_Rarely       157 Research &amp; Development               10
## 24 1194  24 Travel_Frequently       897        Human Resources               10
## 25 1195  45     Travel_Rarely      1038 Research &amp; Development               20
## 26 1196  36        Non-Travel       635                  Sales               10
## 27 1197  41        Non-Travel       552        Human Resources                4
## 28 1198  21     Travel_Rarely      1343                  Sales               22
##    Education   EducationField EmployeeCount EmployeeNumber
## 1          3    Life Sciences             1           1596
## 2          3  Human Resources             1           1207
## 3          3          Medical             1           1107
## 4          3    Life Sciences             1            505
## 5          3    Life Sciences             1           1497
## 6          4          Medical             1            145
## 7          4    Life Sciences             1           2019
## 8          5          Medical             1           1618
## 9          3          Medical             1           1252
## 10         3    Life Sciences             1            587
## 11         4          Medical             1            964
## 12         4          Medical             1             95
## 13         3 Technical Degree             1           1771
## 14         3          Medical             1            815
## 15         5    Life Sciences             1           1515
## 16         2    Life Sciences             1           1976
## 17         3    Life Sciences             1           1545
## 18         3    Life Sciences             1           1264
## 19         1          Medical             1            842
## 20         3        Marketing             1            840
## 21         4    Life Sciences             1           2010
## 22         2          Medical             1            997
## 23         3          Medical             1           1980
## 24         3          Medical             1           1746
## 25         3          Medical             1           1460
## 26         4          Medical             1            592
## 27         3  Human Resources             1           1722
## 28         1 Technical Degree             1            669
##    EnvironmentSatisfaction Gender HourlyRate JobInvolvement JobLevel
## 1                        2   Male         46              4        2
## 2                        2   Male         99              3        1
## 3                        1   Male         37              3        1
## 4                        3 Female         97              3        4
## 5                        3   Male         77              2        2
## 6                        1 Female         30              2        3
## 7                        1   Male         40              3        1
## 8                        2   Male         76              3        2
## 9                        3 Female         96              2        2
## 10                       1   Male         66              3        3
## 11                       4   Male         35              3        1
## 12                       3   Male         87              3        1
## 13                       4   Male         90              3        2
## 14                       3   Male         64              3        4
## 15                       4   Male         69              3        2
## 16                       4   Male         37              2        2
## 17                       4   Male         44              2        2
## 18                       4 Female         87              2        4
## 19                       3   Male         37              3        2
## 20                       3 Female         43              3        3
## 21                       3 Female         49              2        1
## 22                       4   Male         66              3        4
## 23                       3 Female         77              3        2
## 24                       1   Male         59              3        1
## 25                       2   Male         95              1        3
## 26                       2   Male         32              3        3
## 27                       3   Male         60              1        2
## 28                       3   Male         49              3        1
##                      JobRole JobSatisfaction MaritalStatus MonthlyIncome
## 1      Laboratory Technician               3       Married          3407
## 2            Human Resources               3       Married          3600
## 3      Laboratory Technician               3      Divorced          2377
## 4                    Manager               4        Single         16659
## 5            Sales Executive               3      Divorced          8620
## 6  Healthcare Representative               1        Single          7484
## 7       Sales Representative               4      Divorced          3482
## 8     Manufacturing Director               1       Married          5377
## 9  Healthcare Representative               1        Single          6812
## 10 Healthcare Representative               3       Married          9824
## 11        Research Scientist               2      Divorced          3617
## 12        Research Scientist               2        Single          2501
## 13        Research Scientist               2      Divorced          3055
## 14         Research Director               3       Married         17639
## 15 Healthcare Representative               3        Single          6388
## 16        Research Scientist               3        Single          4332
## 17    Manufacturing Director               2        Single          4320
## 18         Research Director               4      Divorced         16124
## 19           Sales Executive               4        Single          5160
## 20           Sales Executive               4       Married          7654
## 21     Laboratory Technician               2        Single          2837
## 22         Research Director               4      Divorced         17399
## 23    Manufacturing Director               1        Single          4440
## 24           Human Resources               4       Married          2145
## 25 Healthcare Representative               1      Divorced         10851
## 26           Sales Executive               4        Single          9980
## 27           Human Resources               2       Married          6430
## 28      Sales Representative               3        Single          3447
##    MonthlyRate NumCompaniesWorked Over18 OverTime PercentSalaryHike
## 1        25348                  1      Y       No                17
## 2         8429                  1      Y       No                13
## 3        19373                  1      Y       No                20
## 4        23258                  2      Y      Yes                13
## 5        23757                  1      Y       No                14
## 6        25796                  3      Y       No                20
## 7        19788                  2      Y       No                15
## 8         3835                  2      Y       No                13
## 9        17198                  1      Y       No                19
## 10       22908                  3      Y       No                12
## 11       25063                  8      Y      Yes                14
## 12       18775                  1      Y       No                17
## 13        6194                  5      Y       No                15
## 14        6881                  5      Y       No                16
## 15       22049                  2      Y      Yes                17
## 16       14811                  1      Y       No                12
## 17       24152                  1      Y       No                13
## 18        3423                  3      Y       No                14
## 19       21519                  4      Y       No                16
## 20        5860                  1      Y       No                18
## 21       15919                  1      Y       No                13
## 22        6615                  9      Y       No                22
## 23       25198                  6      Y      Yes                19
## 24        2097                  0      Y       No                14
## 25       19863                  2      Y      Yes                18
## 26       15318                  1      Y       No                14
## 27       20794                  6      Y       No                19
## 28       24444                  1      Y       No                11
##    PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel
## 1                  3                        4            80                2
## 2                  3                        4            80                1
## 3                  4                        3            80                1
## 4                  3                        3            80                0
## 5                  3                        3            80                2
## 6                  4                        3            80                0
## 7                  3                        2            80                2
## 8                  3                        4            80                3
## 9                  3                        2            80                0
## 10                 3                        1            80                0
## 11                 3                        4            80                1
## 12                 3                        2            80                0
## 13                 3                        4            80                2
## 14                 3                        4            80                0
## 15                 3                        1            80                0
## 16                 3                        4            80                0
## 17                 3                        4            80                0
## 18                 3                        2            80                2
## 19                 3                        3            80                0
## 20                 3                        1            80                2
## 21                 3                        3            80                0
## 22                 4                        3            80                1
## 23                 3                        4            80                0
## 24                 3                        4            80                1
## 25                 3                        2            80                1
## 26                 3                        4            80                0
## 27                 3                        2            80                1
## 28                 3                        3            80                0
##    TotalWorkingYears TrainingTimesLastYear WorkLifeBalance YearsAtCompany
## 1                 10                     3               2             10
## 2                  5                     2               3              5
## 3                  1                     0               2              1
## 4                 30                     2               3              5
## 5                 10                     3               3             10
## 6                 23                     1               2             13
## 7                 16                     3               2              9
## 8                 10                     3               3              7
## 9                 10                     2               3             10
## 10                12                     2               3              1
## 11                 3                     2               3              1
## 12                 1                     4               3              1
## 13                11                     2               2              9
## 14                30                     3               3              4
## 15                14                     6               3              0
## 16                20                     2               3             20
## 17                 5                     2               3              5
## 18                 9                     2               2              7
## 19                12                     3               2              9
## 20                 9                     3               4              9
## 21                 6                     3               3              6
## 22                32                     1               2              5
## 23                 9                     3               3              5
## 24                 3                     2               3              2
## 25                24                     2               3              7
## 26                10                     3               2             10
## 27                10                     4               3              3
## 28                 3                     2               3              3
##    YearsInCurrentRole YearsSinceLastPromotion YearsWithCurrManager
## 1                   9                       6                    8
## 2                   4                       1                    4
## 3                   1                       0                    0
## 4                   4                       1                    2
## 5                   7                       0                    4
## 6                  12                      12                    8
## 7                   8                       0                    0
## 8                   7                       7                    7
## 9                   9                       1                    8
## 10                  0                       0                    0
## 11                  1                       0                    0
## 12                  1                       1                    0
## 13                  8                       1                    7
## 14                  3                       0                    3
## 15                  0                       0                    0
## 16                  9                       3                    7
## 17                  3                       0                    2
## 18                  7                       1                    7
## 19                  7                       7                    3
## 20                  8                       7                    7
## 21                  2                       4                    1
## 22                  4                       1                    3
## 23                  2                       1                    4
## 24                  2                       2                    1
## 25                  7                       0                    7
## 26                  3                       9                    7
## 27                  2                       1                    2
## 28                  2                       1                    2
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 272 rows ]</code></pre>
</div>
</div>
</div>
<div id="experiment-with-derived-features-1" class="section level1">
<h1>Experiment with derived features</h1>
<pre class="r"><code>class_test_data$Education = as.factor(class_test_data$Education)
class_test_data$EnvironmentSatisfaction = as.factor(class_test_data$EnvironmentSatisfaction)
class_test_data$JobInvolvement = as.factor(class_test_data$JobInvolvement)
class_test_data$JobLevel = as.factor(class_test_data$JobLevel)
class_test_data$JobSatisfaction = as.factor(class_test_data$JobSatisfaction)

derived_test_data = class_test_data

derived_test_data$PerformanceRating = as.numeric(derived_test_data$PerformanceRating)
derived_test_data$Education = as.numeric(derived_test_data$Education)
derived_test_data$JobLevel = as.numeric(derived_test_data$JobLevel)

#37
derived_test_data$PerformancePromotion = derived_test_data$PerformanceRating * derived_test_data$YearsSinceLastPromotion
#38
derived_test_data$Potential = derived_test_data$Education * derived_test_data$JobLevel
#39
derived_test_data$YearsatCoinRole = derived_test_data$YearsAtCompany * derived_test_data$YearsInCurrentRole
#40 
derived_test_data$GoodManager = derived_test_data$RelationshipSatisfaction * derived_test_data$YearsWithCurrManager</code></pre>
</div>
<div id="create-predictions-and-write-to-csv-file" class="section level1">
<h1>Create predictions and write to CSV file</h1>
<pre class="r"><code>test_predictions = predict(final_class_model, class_test_data)</code></pre>
<pre><code>## Warning in predict.naiveBayes(final_class_model, class_test_data): Type mismatch
## between training and new data for variable &#39;Potential&#39;. Did you use factors with
## numeric labels for training, and numeric values for new data?</code></pre>
<pre><code>## Warning in predict.naiveBayes(final_class_model, class_test_data): Type mismatch
## between training and new data for variable &#39;YearsatCoinRole&#39;. Did you use
## factors with numeric labels for training, and numeric values for new data?</code></pre>
<pre class="r"><code>test_class_predictions = data.frame(&#39;ID&#39; = class_test_data$ID, &#39;Attrition&#39; = test_predictions)
test_class_predictions</code></pre>
<pre><code>##       ID Attrition
## 1   1171        No
## 2   1172        No
## 3   1173        No
## 4   1174        No
## 5   1175        No
## 6   1176        No
## 7   1177        No
## 8   1178        No
## 9   1179        No
## 10  1180        No
## 11  1181       Yes
## 12  1182        No
## 13  1183        No
## 14  1184        No
## 15  1185        No
## 16  1186        No
## 17  1187        No
## 18  1188        No
## 19  1189        No
## 20  1190        No
## 21  1191       Yes
## 22  1192        No
## 23  1193        No
## 24  1194        No
## 25  1195        No
## 26  1196        No
## 27  1197        No
## 28  1198       Yes
## 29  1199       Yes
## 30  1200        No
## 31  1201       Yes
## 32  1202        No
## 33  1203        No
## 34  1204        No
## 35  1205       Yes
## 36  1206       Yes
## 37  1207        No
## 38  1208        No
## 39  1209        No
## 40  1210        No
## 41  1211        No
## 42  1212        No
## 43  1213        No
## 44  1214        No
## 45  1215       Yes
## 46  1216        No
## 47  1217        No
## 48  1218        No
## 49  1219        No
## 50  1220        No
## 51  1221        No
## 52  1222        No
## 53  1223        No
## 54  1224        No
## 55  1225        No
## 56  1226        No
## 57  1227        No
## 58  1228        No
## 59  1229        No
## 60  1230        No
## 61  1231        No
## 62  1232        No
## 63  1233       Yes
## 64  1234        No
## 65  1235        No
## 66  1236       Yes
## 67  1237        No
## 68  1238        No
## 69  1239       Yes
## 70  1240        No
## 71  1241        No
## 72  1242        No
## 73  1243        No
## 74  1244        No
## 75  1245        No
## 76  1246       Yes
## 77  1247        No
## 78  1248        No
## 79  1249        No
## 80  1250        No
## 81  1251        No
## 82  1252        No
## 83  1253        No
## 84  1254        No
## 85  1255        No
## 86  1256        No
## 87  1257        No
## 88  1258        No
## 89  1259        No
## 90  1260       Yes
## 91  1261        No
## 92  1262        No
## 93  1263        No
## 94  1264        No
## 95  1265        No
## 96  1266        No
## 97  1267        No
## 98  1268        No
## 99  1269        No
## 100 1270       Yes
## 101 1271        No
## 102 1272        No
## 103 1273        No
## 104 1274        No
## 105 1275       Yes
## 106 1276        No
## 107 1277       Yes
## 108 1278        No
## 109 1279        No
## 110 1280        No
## 111 1281       Yes
## 112 1282        No
## 113 1283        No
## 114 1284        No
## 115 1285        No
## 116 1286        No
## 117 1287        No
## 118 1288        No
## 119 1289        No
## 120 1290        No
## 121 1291        No
## 122 1292        No
## 123 1293        No
## 124 1294        No
## 125 1295        No
## 126 1296        No
## 127 1297       Yes
## 128 1298        No
## 129 1299        No
## 130 1300        No
## 131 1301        No
## 132 1302        No
## 133 1303        No
## 134 1304       Yes
## 135 1305        No
## 136 1306        No
## 137 1307        No
## 138 1308        No
## 139 1309       Yes
## 140 1310       Yes
## 141 1311        No
## 142 1312        No
## 143 1313        No
## 144 1314        No
## 145 1315        No
## 146 1316        No
## 147 1317       Yes
## 148 1318       Yes
## 149 1319        No
## 150 1320        No
## 151 1321        No
## 152 1322        No
## 153 1323        No
## 154 1324        No
## 155 1325       Yes
## 156 1326        No
## 157 1327        No
## 158 1328       Yes
## 159 1329       Yes
## 160 1330        No
## 161 1331        No
## 162 1332        No
## 163 1333        No
## 164 1334        No
## 165 1335        No
## 166 1336       Yes
## 167 1337        No
## 168 1338        No
## 169 1339        No
## 170 1340        No
## 171 1341       Yes
## 172 1342        No
## 173 1343        No
## 174 1344        No
## 175 1345        No
## 176 1346        No
## 177 1347        No
## 178 1348        No
## 179 1349        No
## 180 1350        No
## 181 1351       Yes
## 182 1352        No
## 183 1353        No
## 184 1354        No
## 185 1355        No
## 186 1356        No
## 187 1357        No
## 188 1358       Yes
## 189 1359        No
## 190 1360        No
## 191 1361        No
## 192 1362        No
## 193 1363        No
## 194 1364        No
## 195 1365        No
## 196 1366        No
## 197 1367        No
## 198 1368        No
## 199 1369        No
## 200 1370        No
## 201 1371        No
## 202 1372        No
## 203 1373        No
## 204 1374        No
## 205 1375        No
## 206 1376       Yes
## 207 1377        No
## 208 1378        No
## 209 1379        No
## 210 1380        No
## 211 1381       Yes
## 212 1382        No
## 213 1383        No
## 214 1384        No
## 215 1385        No
## 216 1386        No
## 217 1387        No
## 218 1388        No
## 219 1389        No
## 220 1390        No
## 221 1391        No
## 222 1392       Yes
## 223 1393        No
## 224 1394        No
## 225 1395        No
## 226 1396        No
## 227 1397       Yes
## 228 1398        No
## 229 1399       Yes
## 230 1400        No
## 231 1401       Yes
## 232 1402       Yes
## 233 1403        No
## 234 1404       Yes
## 235 1405        No
## 236 1406        No
## 237 1407        No
## 238 1408        No
## 239 1409        No
## 240 1410        No
## 241 1411       Yes
## 242 1412        No
## 243 1413        No
## 244 1414        No
## 245 1415        No
## 246 1416        No
## 247 1417       Yes
## 248 1418        No
## 249 1419        No
## 250 1420       Yes
## 251 1421       Yes
## 252 1422        No
## 253 1423        No
## 254 1424        No
## 255 1425        No
## 256 1426        No
## 257 1427        No
## 258 1428        No
## 259 1429        No
## 260 1430        No
## 261 1431        No
## 262 1432        No
## 263 1433        No
## 264 1434        No
## 265 1435        No
## 266 1436        No
## 267 1437        No
## 268 1438        No
## 269 1439       Yes
## 270 1440        No
## 271 1441       Yes
## 272 1442       Yes
## 273 1443        No
## 274 1444       Yes
## 275 1445       Yes
## 276 1446        No
## 277 1447        No
## 278 1448        No
## 279 1449       Yes
## 280 1450        No
## 281 1451        No
## 282 1452        No
## 283 1453        No
## 284 1454        No
## 285 1455       Yes
## 286 1456       Yes
## 287 1457        No
## 288 1458       Yes
## 289 1459       Yes
## 290 1460        No
## 291 1461        No
## 292 1462        No
## 293 1463        No
## 294 1464        No
## 295 1465        No
## 296 1466        No
## 297 1467        No
## 298 1468       Yes
## 299 1469        No
## 300 1470        No</code></pre>
<pre class="r"><code>write.csv(test_class_predictions, &#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/Case2PredictionsPengilly Attrition.csv&#39;)</code></pre>
<div id="regression-model" class="section level58">
<p>REGRESSION MODEL</p>
</div>
</div>
<div id="predict-salary-monthly-income-using-mlr-then-possibly-lasso-random-forest-ensemble-models-etc." class="section level1">
<h1>Predict Salary (Monthly Income) Using MLR (then possibly LASSO, random forest, ensemble models, etc.</h1>
</div>
<div id="backwards-elimination" class="section level1">
<h1>Backwards elimination</h1>
</div>
<div id="import-libraries-1" class="section level1">
<h1>Import Libraries</h1>
<pre class="r"><code>library(MASS)</code></pre>
<pre><code>## Warning: package &#39;MASS&#39; was built under R version 3.6.3</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
</div>
<div id="create-training-and-test-sets-dont-use-1" class="section level1">
<h1>Create training and test sets # Don’t use</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(data$Attrition)), round(.8*length(data$Attrition)))
trainData = data[trainIndices,]
testData = data[-trainIndices,]</code></pre>
</div>
<div id="fit-the-model-with-all-variables-excluding-distancefromhome-employeecount-employeenumber-environmentsatisfaction-performancerating" class="section level1">
<h1>Fit the model with ALL variables, excluding distancefromhome, employeecount, employeenumber, environmentsatisfaction, performanceRating,</h1>
</div>
<div id="worklifebalance-yearssincelastpromotion-yearswithcurrentmanager" class="section level1">
<h1>worklifebalance, yearssincelastpromotion, yearswithcurrentmanager</h1>
<pre class="r"><code>regModel = lm(data = trainData, MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + Education + EducationField + Gender + HourlyRate +
              JobInvolvement + JobLevel + JobRole + JobSatisfaction + MaritalStatus + MonthlyRate + NumCompaniesWorked + OverTime + 
              PercentSalaryHike + RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany +
              YearsInCurrentRole)
step = stepAIC(regModel, direction = &#39;backward&#39;)</code></pre>
<pre><code>## Start:  AIC=9651.39
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + EducationField + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + JobSatisfaction + MaritalStatus + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - EducationField            5    2921786  641248480  9644.6
## - JobSatisfaction           3     551928  638878622  9646.0
## - MaritalStatus             2    1439019  639765713  9649.0
## - Education                 4    5354170  643680864  9649.2
## - HourlyRate                1      12955  638339649  9649.4
## - Age                       1      22818  638349511  9649.4
## - RelationshipSatisfaction  1      44151  638370844  9649.4
## - PercentSalaryHike         1     244907  638571601  9649.7
## - Gender                    1     271739  638598433  9649.7
## - StockOptionLevel          1     506547  638833241  9649.9
## - MonthlyRate               1    1069320  639396014  9650.6
## - OverTime                  1    1140156  639466850  9650.6
## - YearsAtCompany            1    1282095  639608789  9650.8
## - JobInvolvement            3    5018507  643345201  9650.8
## - DailyRate                 1    1408976  639735670  9650.9
## - NumCompaniesWorked        1    1793402  640120095  9651.3
## &lt;none&gt;                                    638326694  9651.4
## - YearsInCurrentRole        1    2271813  640598507  9651.9
## - Department                2    4883563  643210256  9652.7
## - TrainingTimesLastYear     1    3837810  642164504  9653.6
## - BusinessTravel            2    5955424  644282118  9653.9
## - TotalWorkingYears         1    9533000  647859694  9659.7
## - JobRole                   8  297870392  936197085  9901.9
## - JobLevel                  4 1149606020 1787932714 10360.2
## 
## Step:  AIC=9644.57
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + Gender + HourlyRate + JobInvolvement + JobLevel + 
##     JobRole + JobSatisfaction + MaritalStatus + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - JobSatisfaction           3     576080  641824561  9639.2
## - Education                 4    4931349  646179830  9641.9
## - MaritalStatus             2    1489758  642738238  9642.2
## - Age                       1          2  641248482  9642.6
## - HourlyRate                1       1686  641250167  9642.6
## - RelationshipSatisfaction  1      49553  641298033  9642.6
## - PercentSalaryHike         1     246464  641494944  9642.8
## - Gender                    1     328595  641577075  9642.9
## - StockOptionLevel          1     603549  641852029  9643.2
## - OverTime                  1    1011099  642259580  9643.7
## - YearsAtCompany            1    1068776  642317257  9643.7
## - MonthlyRate               1    1103877  642352357  9643.8
## - JobInvolvement            3    4846646  646095127  9643.8
## - DailyRate                 1    1490300  642738781  9644.2
## - NumCompaniesWorked        1    1844722  643093202  9644.6
## &lt;none&gt;                                    641248480  9644.6
## - YearsInCurrentRole        1    2071360  643319840  9644.8
## - Department                2    4511805  645760285  9645.5
## - TrainingTimesLastYear     1    3343209  644591689  9646.2
## - BusinessTravel            2    6025016  647273497  9647.1
## - TotalWorkingYears         1    9135518  650383998  9652.4
## - JobRole                   8  300230407  941478887  9895.9
## - JobLevel                  4 1154694496 1795942977 10353.4
## 
## Step:  AIC=9639.2
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + Gender + HourlyRate + JobInvolvement + JobLevel + 
##     JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - Education                 4    5206197  647030757  9636.8
## - MaritalStatus             2    1615000  643439561  9636.9
## - Age                       1        728  641825289  9637.2
## - HourlyRate                1       7976  641832536  9637.2
## - RelationshipSatisfaction  1      43852  641868412  9637.2
## - PercentSalaryHike         1     249480  642074041  9637.5
## - Gender                    1     355381  642179941  9637.6
## - StockOptionLevel          1     719164  642543724  9638.0
## - OverTime                  1    1041689  642866249  9638.3
## - YearsAtCompany            1    1048269  642872829  9638.3
## - MonthlyRate               1    1068708  642893269  9638.4
## - JobInvolvement            3    4897774  646722334  9638.5
## - DailyRate                 1    1396878  643221439  9638.7
## - NumCompaniesWorked        1    1751310  643575871  9639.1
## &lt;none&gt;                                    641824561  9639.2
## - YearsInCurrentRole        1    2062450  643887011  9639.4
## - Department                2    4384882  646209443  9639.9
## - TrainingTimesLastYear     1    3419878  645244438  9640.9
## - BusinessTravel            2    6186716  648011277  9641.9
## - TotalWorkingYears         1    9196210  651020771  9647.1
## - JobRole                   8  300054297  941878858  9890.2
## - JobLevel                  4 1156853324 1798677885 10348.4
## 
## Step:  AIC=9636.82
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Gender + HourlyRate + JobInvolvement + JobLevel + JobRole + 
##     MaritalStatus + MonthlyRate + NumCompaniesWorked + OverTime + 
##     PercentSalaryHike + RelationshipSatisfaction + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - MaritalStatus             2    1633830  648664587  9634.6
## - HourlyRate                1      34445  647065202  9634.9
## - Age                       1      60112  647090870  9634.9
## - RelationshipSatisfaction  1     134843  647165600  9635.0
## - PercentSalaryHike         1     138884  647169641  9635.0
## - JobInvolvement            3    4132394  651163151  9635.2
## - Gender                    1     451070  647481828  9635.3
## - YearsAtCompany            1     725773  647756530  9635.6
## - StockOptionLevel          1     854470  647885227  9635.7
## - OverTime                  1     868857  647899614  9635.8
## - DailyRate                 1    1348158  648378915  9636.3
## - MonthlyRate               1    1438932  648469690  9636.4
## - YearsInCurrentRole        1    1531323  648562080  9636.5
## &lt;none&gt;                                    647030757  9636.8
## - NumCompaniesWorked        1    2144048  649174806  9637.1
## - Department                2    4559819  651590576  9637.7
## - TrainingTimesLastYear     1    2891163  649921920  9637.9
## - BusinessTravel            2    6179331  653210089  9639.4
## - TotalWorkingYears         1    9480583  656511341  9644.9
## - JobRole                   8  306771260  953802017  9890.9
## - JobLevel                  4 1159450777 1806481534 10343.4
## 
## Step:  AIC=9634.57
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Gender + HourlyRate + JobInvolvement + JobLevel + JobRole + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - HourlyRate                1       8395  648672982  9632.6
## - Age                       1      50085  648714672  9632.6
## - PercentSalaryHike         1     102334  648766922  9632.7
## - RelationshipSatisfaction  1     114102  648778690  9632.7
## - JobInvolvement            3    3992131  652656718  9632.8
## - Gender                    1     284321  648948908  9632.9
## - StockOptionLevel          1     380024  649044612  9633.0
## - YearsAtCompany            1     795438  649460025  9633.4
## - OverTime                  1     804021  649468608  9633.4
## - DailyRate                 1    1272141  649936729  9633.9
## - MonthlyRate               1    1341668  650006255  9634.0
## - YearsInCurrentRole        1    1790331  650454918  9634.5
## &lt;none&gt;                                    648664587  9634.6
## - NumCompaniesWorked        1    2316875  650981462  9635.1
## - TrainingTimesLastYear     1    2731211  651395799  9635.5
## - Department                2    4677773  653342361  9635.6
## - BusinessTravel            2    6643180  655307767  9637.7
## - TotalWorkingYears         1    9586817  658251405  9642.8
## - JobRole                   8  309322867  957987454  9890.0
## - JobLevel                  4 1157833707 1806498294 10339.4
## 
## Step:  AIC=9632.58
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Gender + JobInvolvement + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - Age                       1      47098  648720080  9630.6
## - PercentSalaryHike         1     100974  648773957  9630.7
## - RelationshipSatisfaction  1     111987  648784969  9630.7
## - JobInvolvement            3    4011881  652684864  9630.9
## - Gender                    1     281795  648954777  9630.9
## - StockOptionLevel          1     375124  649048107  9631.0
## - YearsAtCompany            1     794028  649467011  9631.4
## - OverTime                  1     809636  649482619  9631.5
## - DailyRate                 1    1264193  649937175  9631.9
## - MonthlyRate               1    1334545  650007528  9632.0
## - YearsInCurrentRole        1    1793419  650466402  9632.5
## &lt;none&gt;                                    648672982  9632.6
## - NumCompaniesWorked        1    2327335  651000318  9633.1
## - TrainingTimesLastYear     1    2736042  651409025  9633.5
## - Department                2    4683905  653356888  9633.6
## - BusinessTravel            2    6655400  655328382  9635.7
## - TotalWorkingYears         1    9581032  658254015  9640.8
## - JobRole                   8  309757142  958430124  9888.3
## - JobLevel                  4 1161833590 1810506572 10339.0
## 
## Step:  AIC=9630.63
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + Gender + 
##     JobInvolvement + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - PercentSalaryHike         1      99737  648819817  9628.7
## - RelationshipSatisfaction  1     114560  648834640  9628.8
## - JobInvolvement            3    3980735  652700815  9628.9
## - Gender                    1     278710  648998791  9628.9
## - StockOptionLevel          1     378928  649099008  9629.0
## - OverTime                  1     828612  649548692  9629.5
## - YearsAtCompany            1     840783  649560864  9629.5
## - DailyRate                 1    1256558  649976639  9630.0
## - MonthlyRate               1    1310838  650030919  9630.0
## - YearsInCurrentRole        1    1773185  650493265  9630.5
## &lt;none&gt;                                    648720080  9630.6
## - NumCompaniesWorked        1    2388299  651108379  9631.2
## - TrainingTimesLastYear     1    2735532  651455612  9631.6
## - Department                2    4699384  653419464  9631.7
## - BusinessTravel            2    6627148  655347228  9633.7
## - TotalWorkingYears         1   13186834  661906914  9642.6
## - JobRole                   8  309949404  958669484  9886.5
## - JobLevel                  4 1165001526 1813721607 10338.2
## 
## Step:  AIC=9628.74
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + Gender + 
##     JobInvolvement + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + RelationshipSatisfaction + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - RelationshipSatisfaction  1     121600  648941417  9626.9
## - JobInvolvement            3    3918453  652738270  9626.9
## - Gender                    1     276727  649096544  9627.0
## - StockOptionLevel          1     396339  649216156  9627.2
## - OverTime                  1     814444  649634261  9627.6
## - YearsAtCompany            1     827469  649647286  9627.6
## - DailyRate                 1    1249110  650068927  9628.1
## - MonthlyRate               1    1316764  650136580  9628.2
## - YearsInCurrentRole        1    1742775  650562592  9628.6
## &lt;none&gt;                                    648819817  9628.7
## - NumCompaniesWorked        1    2388468  651208285  9629.3
## - TrainingTimesLastYear     1    2710031  651529848  9629.6
## - Department                2    4694575  653514392  9629.8
## - BusinessTravel            2    6635801  655455618  9631.8
## - TotalWorkingYears         1   13320180  662139997  9640.9
## - JobRole                   8  310256801  959076618  9884.7
## - JobLevel                  4 1166454899 1815274716 10336.8
## 
## Step:  AIC=9626.87
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + Gender + 
##     JobInvolvement + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - JobInvolvement         3    3929145  652870562  9625.1
## - Gender                 1     282961  649224378  9625.2
## - StockOptionLevel       1     384321  649325737  9625.3
## - YearsAtCompany         1     796614  649738030  9625.7
## - OverTime               1     825257  649766673  9625.8
## - DailyRate              1    1283109  650224526  9626.2
## - MonthlyRate            1    1324347  650265763  9626.3
## - YearsInCurrentRole     1    1760993  650702409  9626.8
## &lt;none&gt;                                 648941417  9626.9
## - NumCompaniesWorked     1    2470314  651411731  9627.5
## - TrainingTimesLastYear  1    2766993  651708410  9627.8
## - Department             2    4739480  653680896  9627.9
## - BusinessTravel         2    6558465  655499882  9629.9
## - TotalWorkingYears      1   13209193  662150609  9638.9
## - JobRole                8  310623972  959565389  9883.1
## - JobLevel               4 1167055267 1815996684 10335.1
## 
## Step:  AIC=9625.07
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + OverTime + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - Gender                 1     393137  653263699  9623.5
## - StockOptionLevel       1     394004  653264565  9623.5
## - YearsAtCompany         1     755203  653625765  9623.9
## - OverTime               1     866046  653736608  9624.0
## - MonthlyRate            1     925652  653796214  9624.1
## - DailyRate              1    1235556  654106118  9624.4
## - YearsInCurrentRole     1    1693333  654563894  9624.9
## &lt;none&gt;                                 652870562  9625.1
## - Department             2    4166770  657037332  9625.5
## - NumCompaniesWorked     1    2353249  655223811  9625.6
## - TrainingTimesLastYear  1    2885298  655755860  9626.1
## - BusinessTravel         2    6353125  659223686  9627.8
## - TotalWorkingYears      1   13828545  666699107  9637.7
## - JobRole                8  311012323  963882885  9880.2
## - JobLevel               4 1167151615 1820022177 10330.6
## 
## Step:  AIC=9623.49
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - StockOptionLevel       1     422133  653685831  9621.9
## - YearsAtCompany         1     817062  654080761  9622.4
## - OverTime               1     902577  654166276  9622.5
## - MonthlyRate            1     947851  654211550  9622.5
## - DailyRate              1    1186315  654450014  9622.8
## - YearsInCurrentRole     1    1675467  654939166  9623.3
## &lt;none&gt;                                 653263699  9623.5
## - Department             2    4197044  657460743  9623.9
## - NumCompaniesWorked     1    2318092  655581791  9624.0
## - TrainingTimesLastYear  1    2912364  656176062  9624.6
## - BusinessTravel         2    6273389  659537088  9626.1
## - TotalWorkingYears      1   13904860  667168559  9636.1
## - JobRole                8  310727380  963991079  9878.3
## - JobLevel               4 1168279112 1821542811 10329.2
## 
## Step:  AIC=9621.94
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - YearsAtCompany         1     837871  654523702  9620.8
## - OverTime               1     955616  654641448  9621.0
## - MonthlyRate            1    1019335  654705167  9621.0
## - DailyRate              1    1225552  654911383  9621.2
## - YearsInCurrentRole     1    1828693  655514524  9621.9
## &lt;none&gt;                                 653685831  9621.9
## - Department             2    4174575  657860407  9622.4
## - NumCompaniesWorked     1    2419979  656105810  9622.5
## - TrainingTimesLastYear  1    2981974  656667805  9623.1
## - BusinessTravel         2    6218685  659904516  9624.5
## - TotalWorkingYears      1   13928416  667614248  9634.6
## - JobRole                8  312469062  966154894  9877.9
## - JobLevel               4 1169034232 1822720064 10327.7
## 
## Step:  AIC=9620.83
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - MonthlyRate            1     885878  655409581  9619.8
## - OverTime               1     950076  655473779  9619.8
## - YearsInCurrentRole     1     997836  655521538  9619.9
## - DailyRate              1    1345939  655869642  9620.3
## &lt;none&gt;                                 654523702  9620.8
## - Department             2    4219363  658743065  9621.3
## - TrainingTimesLastYear  1    2822995  657346697  9621.8
## - NumCompaniesWorked     1    3820148  658343851  9622.9
## - BusinessTravel         2    6416627  660940330  9623.6
## - TotalWorkingYears      1   13436958  667960660  9633.0
## - JobRole                8  322799391  977323094  9883.9
## - JobLevel               4 1176719243 1831242946 10328.9
## 
## Step:  AIC=9619.77
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + NumCompaniesWorked + OverTime + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - OverTime               1     974660  656384241  9618.8
## - YearsInCurrentRole     1    1032484  656442064  9618.9
## - DailyRate              1    1375345  656784925  9619.2
## &lt;none&gt;                                 655409581  9619.8
## - Department             2    4144883  659554463  9620.2
## - TrainingTimesLastYear  1    2910632  658320213  9620.9
## - NumCompaniesWorked     1    3790425  659200006  9621.8
## - BusinessTravel         2    6458792  661868372  9622.6
## - TotalWorkingYears      1   13382703  668792284  9631.8
## - JobRole                8  321914290  977323871  9881.9
## - JobLevel               4 1177264880 1832674460 10327.5
## 
## Step:  AIC=9618.81
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - YearsInCurrentRole     1     920201  657304442  9617.8
## - DailyRate              1    1461720  657845961  9618.4
## &lt;none&gt;                                 656384241  9618.8
## - Department             2    4366501  660750742  9619.4
## - TrainingTimesLastYear  1    2693705  659077946  9619.7
## - NumCompaniesWorked     1    3741005  660125246  9620.8
## - BusinessTravel         2    6666791  663051032  9621.8
## - TotalWorkingYears      1   13431380  669815621  9630.9
## - JobRole                8  321647150  978031391  9880.4
## - JobLevel               4 1180338264 1836722504 10327.0
## 
## Step:  AIC=9617.78
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - DailyRate              1    1578777  658883219  9617.5
## &lt;none&gt;                                 657304442  9617.8
## - Department             2    4263233  661567674  9618.3
## - TrainingTimesLastYear  1    2528169  659832610  9618.5
## - NumCompaniesWorked     1    2974524  660278966  9618.9
## - BusinessTravel         2    6832152  664136594  9621.0
## - TotalWorkingYears      1   20228156  677532598  9636.9
## - JobRole                8  321074898  978379340  9878.6
## - JobLevel               4 1183310525 1840614967 10326.5
## 
## Step:  AIC=9617.45
## MonthlyIncome ~ BusinessTravel + Department + JobLevel + JobRole + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## &lt;none&gt;                                 658883219  9617.5
## - Department             2    4271235  663154454  9617.9
## - TrainingTimesLastYear  1    2653625  661536843  9618.2
## - NumCompaniesWorked     1    3332819  662216038  9619.0
## - BusinessTravel         2    6745316  665628535  9620.5
## - TotalWorkingYears      1   20045861  678929079  9636.3
## - JobRole                8  319952445  978835664  9876.9
## - JobLevel               4 1184231925 1843115144 10325.4</code></pre>
</div>
<div id="predict-on-test-set" class="section level1">
<h1>Predict on test set</h1>
<pre class="r"><code>predictions = as.data.frame(predict(step, data = testData))
residuals = testData$MonthlyIncome - predictions
n = length(testData$MonthlyIncome)
RMSE = sqrt(sum((residuals^2)/n))
RMSE</code></pre>
<pre><code>## [1] 13569.2</code></pre>
<pre class="r"><code>mean(abs(residuals$`predict(step, data = testData)`))</code></pre>
<pre><code>## [1] 4958.949</code></pre>
<div id="stepwise" class="section level27">
<p>Stepwise</p>
</div>
</div>
<div id="fit-the-model-with-all-variables-excluding-employeecount-employeenumber-environmentsatisfaction-performancerating" class="section level1">
<h1>Fit the model with ALL variables, excluding employeecount, employeenumber, environmentsatisfaction, performanceRating,</h1>
</div>
<div id="worklifebalance-yearssincelastpromotion-yearswithcurrentmanager-1" class="section level1">
<h1>worklifebalance, yearssincelastpromotion, yearswithcurrentmanager</h1>
</div>
<div id="removed-maritalstatus-relationshipsatisfaction-yearsincurrentrole" class="section level1">
<h1>Removed MaritalStatus, RelationshipSatisfaction, YearsInCurrentRole</h1>
<pre class="r"><code>regModel = lm(data = trainData, MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + Department + Education + EducationField + 
              Gender + HourlyRate + JobInvolvement + JobLevel + JobRole + JobSatisfaction + MonthlyRate + 
              NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears +
              TrainingTimesLastYear + YearsAtCompany)
step = stepAIC(regModel, direction = &#39;both&#39;)</code></pre>
<pre><code>## Start:  AIC=9648.33
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + JobSatisfaction + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - EducationField         5    2703624  643732839  9641.3
## - JobSatisfaction        3     622069  641651283  9643.0
## - Education              4    4816905  645846120  9645.5
## - HourlyRate             1       1561  641030776  9646.3
## - Age                    1      52719  641081933  9646.4
## - PercentSalaryHike      1      68948  641098163  9646.4
## - YearsAtCompany         1     100341  641129556  9646.4
## - Gender                 1     134834  641164048  9646.5
## - StockOptionLevel       1     469388  641498602  9646.8
## - MonthlyRate            1     877925  641907139  9647.3
## - OverTime               1    1031167  642060382  9647.5
## - JobInvolvement         3    4734504  645763719  9647.5
## - DistanceFromHome       1    1338764  642367978  9647.8
## - NumCompaniesWorked     1    1599896  642629110  9648.1
## - DailyRate              1    1681151  642710366  9648.2
## &lt;none&gt;                                 641029215  9648.3
## - Department             2    4809388  645838602  9649.5
## - TrainingTimesLastYear  1    2995707  644024921  9649.6
## - BusinessTravel         2    6372955  647402169  9651.2
## - TotalWorkingYears      1   10728233  651757448  9657.9
## - JobRole                8  298632798  939662012  9898.5
## - JobLevel               4 1148540119 1789569333 10354.9
## 
## Step:  AIC=9641.26
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + JobSatisfaction + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - JobSatisfaction        3     633175  644366013  9635.9
## - Education              4    4455535  648188374  9638.1
## - Age                    1       7868  643740706  9639.3
## - HourlyRate             1      14560  643747399  9639.3
## - YearsAtCompany         1      59637  643792476  9639.3
## - PercentSalaryHike      1      73578  643806417  9639.3
## - Gender                 1     170562  643903401  9639.4
## - StockOptionLevel       1     557320  644290159  9639.9
## - JobInvolvement         3    4606385  648339223  9640.2
## - MonthlyRate            1     907594  644640433  9640.2
## - OverTime               1     917291  644650130  9640.3
## - DistanceFromHome       1    1412078  645144917  9640.8
## - NumCompaniesWorked     1    1659778  645392617  9641.1
## - DailyRate              1    1749422  645482261  9641.2
## &lt;none&gt;                                 643732839  9641.3
## - Department             2    4414925  648147764  9642.0
## - TrainingTimesLastYear  1    2601270  646334108  9642.1
## - BusinessTravel         2    6405611  650138450  9644.2
## + EducationField         5    2703624  641029215  9648.3
## - TotalWorkingYears      1   10273935  654006773  9650.3
## - JobRole                8  300853593  944586431  9892.2
## - JobLevel               4 1153329508 1797062347 10347.8
## 
## Step:  AIC=9635.95
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + OverTime + 
##     PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - Education              4    4700300  649066314  9633.0
## - Age                    1       4350  644370363  9634.0
## - HourlyRate             1       7439  644373452  9634.0
## - YearsAtCompany         1      54717  644420731  9634.0
## - PercentSalaryHike      1      71065  644437078  9634.0
## - Gender                 1     180982  644546996  9634.1
## - StockOptionLevel       1     597438  644963452  9634.6
## - MonthlyRate            1     879708  645245722  9634.9
## - OverTime               1     940340  645306353  9635.0
## - JobInvolvement         3    4675980  649041994  9635.0
## - DistanceFromHome       1    1470714  645836728  9635.5
## - NumCompaniesWorked     1    1584584  645950597  9635.7
## - DailyRate              1    1600907  645966920  9635.7
## &lt;none&gt;                                 644366013  9635.9
## - Department             2    4268786  648634799  9636.5
## - TrainingTimesLastYear  1    2688427  647054441  9636.8
## - BusinessTravel         2    6586217  650952230  9639.0
## + JobSatisfaction        3     633175  643732839  9641.3
## + EducationField         5    2714730  641651283  9643.0
## - TotalWorkingYears      1   10386459  654752473  9645.1
## - JobRole                8  300413455  944779469  9886.3
## - JobLevel               4 1155394560 1799760573 10342.8
## 
## Step:  AIC=9633
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Gender + HourlyRate + JobInvolvement + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - HourlyRate             1          8  649066322  9631.0
## - Age                    1      23428  649089742  9631.0
## - YearsAtCompany         1      26596  649092910  9631.0
## - PercentSalaryHike      1      27314  649093628  9631.0
## - Gender                 1     249159  649315473  9631.3
## - JobInvolvement         3    3999764  653066078  9631.3
## - StockOptionLevel       1     656217  649722531  9631.7
## - OverTime               1     798351  649864665  9631.9
## - MonthlyRate            1    1234053  650300367  9632.3
## - DailyRate              1    1521760  650588074  9632.6
## - DistanceFromHome       1    1522900  650589214  9632.6
## &lt;none&gt;                                 649066314  9633.0
## - NumCompaniesWorked     1    1980992  651047306  9633.1
## - TrainingTimesLastYear  1    2293988  651360302  9633.5
## - Department             2    4434905  653501219  9633.7
## + Education              4    4700300  644366013  9635.9
## - BusinessTravel         2    6519250  655585564  9636.0
## + JobSatisfaction        3     877940  648188374  9638.1
## + EducationField         5    2366331  646699982  9640.5
## - TotalWorkingYears      1   10545115  659611428  9642.2
## - JobRole                8  307209631  956275945  9886.7
## - JobLevel               4 1158237972 1807304286 10337.7
## 
## Step:  AIC=9631
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Gender + JobInvolvement + JobLevel + JobRole + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - Age                    1      23669  649089990  9629.0
## - YearsAtCompany         1      26608  649092930  9629.0
## - PercentSalaryHike      1      27374  649093696  9629.0
## - Gender                 1     249471  649315793  9629.3
## - JobInvolvement         3    4004168  653070490  9629.3
## - StockOptionLevel       1     657734  649724056  9629.7
## - OverTime               1     799005  649865327  9629.9
## - MonthlyRate            1    1237291  650303613  9630.3
## - DailyRate              1    1528275  650594597  9630.6
## - DistanceFromHome       1    1531694  650598016  9630.6
## &lt;none&gt;                                 649066322  9631.0
## - NumCompaniesWorked     1    1981657  651047978  9631.1
## - TrainingTimesLastYear  1    2294083  651360404  9631.5
## - Department             2    4435070  653501392  9631.7
## + HourlyRate             1          8  649066314  9633.0
## + Education              4    4692869  644373452  9634.0
## - BusinessTravel         2    6521307  655587629  9634.0
## + JobSatisfaction        3     875152  648191170  9636.1
## + EducationField         5    2359362  646706960  9638.5
## - TotalWorkingYears      1   10545547  659611869  9640.2
## - JobRole                8  307896820  956963142  9885.2
## - JobLevel               4 1162048457 1811114779 10337.2
## 
## Step:  AIC=9629.03
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Gender + JobInvolvement + JobLevel + JobRole + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - PercentSalaryHike      1      26966  649116956  9627.1
## - YearsAtCompany         1      35931  649125921  9627.1
## - JobInvolvement         3    3986026  653076016  9627.3
## - Gender                 1     247520  649337511  9627.3
## - StockOptionLevel       1     660668  649750658  9627.7
## - OverTime               1     813755  649903746  9627.9
## - MonthlyRate            1    1222482  650312473  9628.3
## - DailyRate              1    1521903  650611893  9628.7
## - DistanceFromHome       1    1536903  650626893  9628.7
## &lt;none&gt;                                 649089990  9629.0
## - NumCompaniesWorked     1    2024404  651114395  9629.2
## - TrainingTimesLastYear  1    2295425  651385415  9629.5
## - Department             2    4446511  653536501  9629.8
## + Age                    1      23669  649066322  9631.0
## + HourlyRate             1        249  649089742  9631.0
## + Education              4    4713151  644376839  9632.0
## - BusinessTravel         2    6502025  655592016  9632.0
## + JobSatisfaction        3     884098  648205893  9634.1
## + EducationField         5    2382886  646707104  9636.5
## - TotalWorkingYears      1   14189504  663279495  9642.1
## - JobRole                8  308045558  957135548  9883.3
## - JobLevel               4 1165211419 1814301410 10336.4
## 
## Step:  AIC=9627.06
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Gender + JobInvolvement + JobLevel + JobRole + 
##     MonthlyRate + NumCompaniesWorked + OverTime + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - YearsAtCompany         1      36347  649153303  9625.1
## - JobInvolvement         3    3961048  653078004  9625.3
## - Gender                 1     246522  649363478  9625.3
## - StockOptionLevel       1     674277  649791233  9625.8
## - OverTime               1     808266  649925222  9625.9
## - MonthlyRate            1    1226510  650343466  9626.4
## - DailyRate              1    1517568  650634525  9626.7
## - DistanceFromHome       1    1585453  650702409  9626.8
## &lt;none&gt;                                 649116956  9627.1
## - NumCompaniesWorked     1    2022164  651139120  9627.2
## - TrainingTimesLastYear  1    2284388  651401344  9627.5
## - Department             2    4443284  653560240  9627.8
## + PercentSalaryHike      1      26966  649089990  9629.0
## + Age                    1      23260  649093696  9629.0
## + HourlyRate             1        442  649116515  9629.1
## - BusinessTravel         2    6498987  655615943  9630.0
## + Education              4    4667210  644449747  9630.0
## + JobSatisfaction        3     880350  648236606  9632.1
## + EducationField         5    2385327  646731629  9634.5
## - TotalWorkingYears      1   14276965  663393921  9640.2
## - JobRole                8  308728110  957845066  9881.9
## - JobLevel               4 1166729755 1815846711 10335.0
## 
## Step:  AIC=9625.1
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Gender + JobInvolvement + JobLevel + JobRole + 
##     MonthlyRate + NumCompaniesWorked + OverTime + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - JobInvolvement         3    3957140  653110443  9623.3
## - Gender                 1     263305  649416608  9623.4
## - StockOptionLevel       1     659562  649812865  9623.8
## - OverTime               1     819195  649972498  9624.0
## - MonthlyRate            1    1202648  650355951  9624.4
## - DailyRate              1    1524951  650678254  9624.7
## - DistanceFromHome       1    1554917  650708220  9624.8
## &lt;none&gt;                                 649153303  9625.1
## - TrainingTimesLastYear  1    2284254  651437557  9625.5
## - Department             2    4467247  653620550  9625.9
## - NumCompaniesWorked     1    2796904  651950207  9626.1
## + YearsAtCompany         1      36347  649116956  9627.1
## + Age                    1      32573  649120730  9627.1
## + PercentSalaryHike      1      27382  649125921  9627.1
## + HourlyRate             1        654  649152649  9627.1
## - BusinessTravel         2    6517103  655670406  9628.1
## + Education              4    4650731  644502572  9628.1
## + JobSatisfaction        3     876613  648276690  9630.2
## + EducationField         5    2377859  646775444  9632.5
## - TotalWorkingYears      1   19329276  668482579  9643.5
## - JobRole                8  318373401  967526704  9886.9
## - JobLevel               4 1179961920 1829115223 10338.1
## 
## Step:  AIC=9623.33
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Gender + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + OverTime + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - Gender                 1     375453  653485897  9621.7
## - StockOptionLevel       1     679498  653789941  9622.1
## - MonthlyRate            1     831010  653941453  9622.2
## - OverTime               1     851859  653962303  9622.2
## - DistanceFromHome       1    1458231  654568675  9622.9
## - DailyRate              1    1505861  654616304  9622.9
## &lt;none&gt;                                 653110443  9623.3
## - Department             2    3922575  657033019  9623.5
## - TrainingTimesLastYear  1    2400869  655511313  9623.9
## - NumCompaniesWorked     1    2650178  655760622  9624.1
## + JobInvolvement         3    3957140  649153303  9625.1
## + YearsAtCompany         1      32439  653078004  9625.3
## + Age                    1      10282  653100162  9625.3
## + HourlyRate             1       2925  653107518  9625.3
## + PercentSalaryHike      1       2104  653108339  9625.3
## - BusinessTravel         2    6361564  659472007  9626.1
## + Education              4    3991072  649119371  9627.1
## + JobSatisfaction        3     930339  652180105  9628.3
## + EducationField         5    2197847  650912597  9631.0
## - TotalWorkingYears      1   20251157  673361600  9642.6
## - JobRole                8  319113098  972223541  9884.2
## - JobLevel               4 1180238783 1833349226 10333.7
## 
## Step:  AIC=9621.73
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - StockOptionLevel       1     711400  654197297  9620.5
## - MonthlyRate            1     845821  654331718  9620.6
## - OverTime               1     891655  654377551  9620.7
## - DailyRate              1    1453445  654939341  9621.3
## - DistanceFromHome       1    1466974  654952871  9621.3
## &lt;none&gt;                                 653485897  9621.7
## - Department             2    3955014  657440910  9621.9
## - TrainingTimesLastYear  1    2425911  655911808  9622.3
## - NumCompaniesWorked     1    2683645  656169542  9622.6
## + Gender                 1     375453  653110443  9623.3
## + JobInvolvement         3    4069288  649416608  9623.4
## + YearsAtCompany         1      51830  653434066  9623.7
## + Age                    1       9989  653475908  9623.7
## + PercentSalaryHike      1       1575  653484322  9623.7
## + HourlyRate             1       1182  653484714  9623.7
## - BusinessTravel         2    6286014  659771911  9624.4
## + Education              4    4057909  649427987  9625.4
## + JobSatisfaction        3     952009  652533887  9626.7
## + EducationField         5    2252865  651233031  9629.3
## - TotalWorkingYears      1   20090995  673576891  9640.8
## - JobRole                8  318991292  972477188  9882.4
## - JobLevel               4 1180697112 1834183009 10332.0
## 
## Step:  AIC=9620.48
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - MonthlyRate            1     933071  655130368  9619.5
## - OverTime               1     944104  655141401  9619.5
## - DistanceFromHome       1    1324242  655521538  9619.9
## - DailyRate              1    1518745  655716042  9620.1
## &lt;none&gt;                                 654197297  9620.5
## - Department             2    3929120  658126417  9620.7
## - TrainingTimesLastYear  1    2497243  656694539  9621.1
## - NumCompaniesWorked     1    2783094  656980391  9621.4
## + StockOptionLevel       1     711400  653485897  9621.7
## + Gender                 1     407355  653789941  9622.1
## + JobInvolvement         3    4096190  650101107  9622.1
## + YearsAtCompany         1      34007  654163290  9622.4
## + Age                    1      10935  654186361  9622.5
## + PercentSalaryHike      1       5924  654191373  9622.5
## + HourlyRate             1         55  654197242  9622.5
## - BusinessTravel         2    6251319  660448616  9623.1
## + Education              4    4102855  650094441  9624.1
## + JobSatisfaction        3    1017990  653179307  9625.4
## + EducationField         5    2330816  651866480  9628.0
## - TotalWorkingYears      1   20429835  674627132  9639.9
## - JobRole                8  320975482  975172778  9882.3
## - JobLevel               4 1180784138 1834981435 10330.3
## 
## Step:  AIC=9619.48
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + NumCompaniesWorked + OverTime + 
##     TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - OverTime               1     966669  656097037  9618.5
## - DistanceFromHome       1    1311697  656442064  9618.9
## - DailyRate              1    1552796  656683164  9619.1
## &lt;none&gt;                                 655130368  9619.5
## - Department             2    3855198  658985565  9619.6
## - TrainingTimesLastYear  1    2578962  657709330  9620.2
## - NumCompaniesWorked     1    2738740  657869107  9620.4
## + MonthlyRate            1     933071  654197297  9620.5
## + StockOptionLevel       1     798650  654331718  9620.6
## + Gender                 1     425609  654704758  9621.0
## + YearsAtCompany         1      12929  655117438  9621.5
## + PercentSalaryHike      1       9201  655121166  9621.5
## + HourlyRate             1       2976  655127391  9621.5
## + Age                    1       2370  655127997  9621.5
## + JobInvolvement         3    3705143  651425224  9621.5
## - BusinessTravel         2    6292353  661422721  9622.1
## + Education              4    4391895  650738473  9622.8
## + JobSatisfaction        3     995921  654134447  9624.4
## + EducationField         5    2366830  652763538  9627.0
## - TotalWorkingYears      1   20426586  675556953  9638.8
## - JobRole                8  320042825  975173193  9880.3
## - JobLevel               4 1181287662 1836418030 10328.9
## 
## Step:  AIC=9618.5
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + NumCompaniesWorked + TotalWorkingYears + 
##     TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - DistanceFromHome       1    1207405  657304442  9617.8
## - DailyRate              1    1634216  657731253  9618.2
## &lt;none&gt;                                 656097037  9618.5
## - Department             2    4082996  660180033  9618.8
## - TrainingTimesLastYear  1    2389239  658486275  9619.0
## - NumCompaniesWorked     1    2764287  658861324  9619.4
## + OverTime               1     966669  655130368  9619.5
## + MonthlyRate            1     955636  655141401  9619.5
## + StockOptionLevel       1     855839  655241198  9619.6
## + Gender                 1     471202  655625834  9620.0
## + YearsAtCompany         1      20483  656076554  9620.5
## + Age                    1       9654  656087382  9620.5
## + PercentSalaryHike      1       6349  656090688  9620.5
## + HourlyRate             1        660  656096377  9620.5
## + JobInvolvement         3    3739852  652357185  9620.5
## - BusinessTravel         2    6492719  662589756  9621.4
## + Education              4    4271149  651825888  9622.0
## + JobSatisfaction        3    1054492  655042545  9623.4
## + EducationField         5    2283942  653813094  9626.1
## - TotalWorkingYears      1   20252471  676349507  9637.7
## - JobRole                8  319963264  976060301  9879.0
## - JobLevel               4 1184058161 1840155197 10328.3
## 
## Step:  AIC=9617.78
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - DailyRate              1    1578777  658883219  9617.5
## &lt;none&gt;                                 657304442  9617.8
## - Department             2    4263233  661567674  9618.3
## - TrainingTimesLastYear  1    2528169  659832610  9618.5
## + DistanceFromHome       1    1207405  656097037  9618.5
## + MonthlyRate            1     942199  656362243  9618.8
## + OverTime               1     862377  656442064  9618.9
## - NumCompaniesWorked     1    2974524  660278966  9618.9
## + StockOptionLevel       1     701147  656603294  9619.0
## + Gender                 1     473884  656830558  9619.3
## + PercentSalaryHike      1      30183  657274259  9619.8
## + Age                    1       8186  657296256  9619.8
## + HourlyRate             1       3648  657300794  9619.8
## + YearsAtCompany         1       2131  657302311  9619.8
## + JobInvolvement         3    3642012  653662430  9619.9
## - BusinessTravel         2    6832152  664136594  9621.0
## + Education              4    4341478  652962964  9621.2
## + JobSatisfaction        3    1128331  656176111  9622.6
## + EducationField         5    2357929  654946513  9625.3
## - TotalWorkingYears      1   20228156  677532598  9636.9
## - JobRole                8  321074898  978379340  9878.6
## - JobLevel               4 1183310525 1840614967 10326.5
## 
## Step:  AIC=9617.45
## MonthlyIncome ~ BusinessTravel + Department + JobLevel + JobRole + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## &lt;none&gt;                                 658883219  9617.5
## + DailyRate              1    1578777  657304442  9617.8
## - Department             2    4271235  663154454  9617.9
## + DistanceFromHome       1    1151965  657731253  9618.2
## - TrainingTimesLastYear  1    2653625  661536843  9618.2
## + MonthlyRate            1     977972  657905246  9618.4
## + OverTime               1     940311  657942907  9618.5
## + StockOptionLevel       1     774238  658108980  9618.6
## - NumCompaniesWorked     1    3332819  662216038  9619.0
## + Gender                 1     415994  658467224  9619.0
## + PercentSalaryHike      1      26109  658857110  9619.4
## + Age                    1       6765  658876454  9619.4
## + YearsAtCompany         1       3818  658879400  9619.4
## + HourlyRate             1        497  658882721  9619.5
## + JobInvolvement         3    3626581  655256638  9619.6
## - BusinessTravel         2    6745316  665628535  9620.5
## + Education              4    4223697  654659522  9621.0
## + JobSatisfaction        3     918225  657964993  9622.5
## + EducationField         5    2444807  656438411  9624.9
## - TotalWorkingYears      1   20045861  678929079  9636.3
## - JobRole                8  319952445  978835664  9876.9
## - JobLevel               4 1184231925 1843115144 10325.4</code></pre>
<pre class="r"><code>step$anova</code></pre>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + JobSatisfaction + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany
## 
## Final Model:
## MonthlyIncome ~ BusinessTravel + Department + JobLevel + JobRole + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
## 
##                   Step Df     Deviance Resid. Df Resid. Dev      AIC
## 1                                            651  641029215 9648.332
## 2     - EducationField  5 2703624.1482       656  643732839 9641.262
## 3    - JobSatisfaction  3  633174.7816       659  644366013 9635.946
## 4          - Education  4 4700300.2948       663  649066314 9633.004
## 5         - HourlyRate  1       7.9186       664  649066322 9631.004
## 6                - Age  1   23668.7802       665  649089990 9629.030
## 7  - PercentSalaryHike  1   26965.7862       666  649116956 9627.059
## 8     - YearsAtCompany  1   36346.7968       667  649153303 9625.098
## 9     - JobInvolvement  3 3957140.4233       670  653110443 9623.327
## 10            - Gender  1  375453.1228       671  653485897 9621.727
## 11  - StockOptionLevel  1  711400.1059       672  654197297 9620.485
## 12       - MonthlyRate  1  933070.9710       673  655130368 9619.477
## 13          - OverTime  1  966669.0738       674  656097037 9618.503
## 14  - DistanceFromHome  1 1207404.9396       675  657304442 9617.783
## 15         - DailyRate  1 1578776.9354       676  658883219 9617.452</code></pre>
</div>
<div id="predict-on-test-set-1" class="section level1">
<h1>Predict on test set</h1>
<pre class="r"><code>predictions = as.data.frame(predict(step, data = testData))
residuals = testData$MonthlyIncome - predictions
n = length(testData$MonthlyIncome)
RMSE = sqrt(sum((residuals^2)/n))
RMSE</code></pre>
<pre><code>## [1] 13569.2</code></pre>
<div id="derived-variables-included" class="section level3">
<h3>Derived Variables included</h3>
</div>
</div>
<div id="custom-model" class="section level1">
<h1>Custom Model</h1>
<pre class="r"><code>regModel = lm(data = trainData, MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + Department + Education + EducationField + 
              Gender + HourlyRate + JobInvolvement + JobLevel + JobRole + MaritalStatus + JobSatisfaction + MonthlyRate + 
              NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + WorkLifeBalance +
              TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager)
step = stepAIC(regModel, direction = &#39;both&#39;)</code></pre>
<pre><code>## Start:  AIC=9652.74
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + MaritalStatus + JobSatisfaction + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + WorkLifeBalance + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - EducationField           5    2933715  637007588  9646.0
## - JobSatisfaction          3     510891  634584763  9647.3
## - MaritalStatus            2    1749681  635823554  9650.7
## - HourlyRate               1        365  634074237  9650.7
## - WorkLifeBalance          1      35745  634109618  9650.8
## - Age                      1      70246  634144119  9650.8
## - PercentSalaryHike        1     139518  634213391  9650.9
## - Gender                   1     244637  634318510  9651.0
## - Education                4    5870597  639944470  9651.2
## - StockOptionLevel         1     708018  634781890  9651.5
## - YearsAtCompany           1     809528  634883401  9651.6
## - MonthlyRate              1    1191857  635265729  9652.0
## - YearsSinceLastPromotion  1    1227135  635301008  9652.1
## - OverTime                 1    1280594  635354467  9652.1
## - YearsWithCurrManager     1    1403512  635477385  9652.3
## - DailyRate                1    1449151  635523024  9652.3
## - JobInvolvement           3    5118638  639192511  9652.3
## - NumCompaniesWorked       1    1477521  635551394  9652.4
## - DistanceFromHome         1    1672999  635746871  9652.6
## &lt;none&gt;                                   634073873  9652.7
## - YearsInCurrentRole       1    2697218  636771091  9653.7
## - Department               2    4557786  638631659  9653.7
## - BusinessTravel           2    5590098  639663971  9654.8
## - TrainingTimesLastYear    1    4117084  638190957  9655.2
## - TotalWorkingYears        1    9801100  643874973  9661.4
## - JobRole                  8  295243026  929316899  9902.8
## - JobLevel                 4 1136990343 1771064215 10359.6
## 
## Step:  AIC=9645.95
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + MaritalStatus + JobSatisfaction + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + WorkLifeBalance + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - JobSatisfaction          3     527450  637535038  9640.5
## - Education                4    5443249  642450837  9643.9
## - MaritalStatus            2    1795041  638802629  9643.9
## - HourlyRate               1       3308  637010896  9644.0
## - Age                      1      13045  637020633  9644.0
## - WorkLifeBalance          1      79737  637087325  9644.0
## - PercentSalaryHike        1     134635  637142223  9644.1
## - Gender                   1     292299  637299887  9644.3
## - YearsAtCompany           1     668074  637675662  9644.7
## - StockOptionLevel         1     830084  637837671  9644.9
## - OverTime                 1    1148002  638155590  9645.2
## - YearsSinceLastPromotion  1    1174448  638182035  9645.2
## - JobInvolvement           3    4899797  641907385  9645.3
## - MonthlyRate              1    1227310  638234898  9645.3
## - YearsWithCurrManager     1    1374711  638382299  9645.5
## - DailyRate                1    1505172  638512760  9645.6
## - NumCompaniesWorked       1    1506734  638514322  9645.6
## - DistanceFromHome         1    1748584  638756172  9645.9
## &lt;none&gt;                                   637007588  9646.0
## - Department               2    4175004  641182592  9646.5
## - YearsInCurrentRole       1    2512189  639519777  9646.7
## - TrainingTimesLastYear    1    3595267  640602855  9647.9
## - BusinessTravel           2    5627807  642635395  9648.1
## + EducationField           5    2933715  634073873  9652.7
## - TotalWorkingYears        1    9436600  646444188  9654.2
## - JobRole                  8  297194955  934202543  9896.5
## - JobLevel                 4 1142435693 1779443281 10352.9
## 
## Step:  AIC=9640.53
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - HourlyRate               1         75  637535113  9638.5
## - Age                      1       7843  637542881  9638.5
## - WorkLifeBalance          1      96883  637631921  9638.6
## - MaritalStatus            2    1934349  639469388  9638.6
## - PercentSalaryHike        1     135897  637670935  9638.7
## - Education                4    5721153  643256192  9638.7
## - Gender                   1     316986  637852024  9638.9
## - YearsAtCompany           1     636112  638171150  9639.2
## - StockOptionLevel         1     962038  638497076  9639.6
## - YearsSinceLastPromotion  1    1117980  638653019  9639.7
## - OverTime                 1    1182497  638717535  9639.8
## - MonthlyRate              1    1184465  638719503  9639.8
## - JobInvolvement           3    4934393  642469431  9639.9
## - YearsWithCurrManager     1    1390529  638925567  9640.0
## - NumCompaniesWorked       1    1417754  638952792  9640.1
## - DailyRate                1    1424213  638959251  9640.1
## - DistanceFromHome         1    1832925  639367963  9640.5
## &lt;none&gt;                                   637535038  9640.5
## - Department               2    4059568  641594607  9640.9
## - YearsInCurrentRole       1    2523989  640059027  9641.3
## - TrainingTimesLastYear    1    3650675  641185714  9642.5
## - BusinessTravel           2    5733593  643268631  9642.8
## + JobSatisfaction          3     527450  637007588  9646.0
## + EducationField           5    2950275  634584763  9647.3
## - TotalWorkingYears        1    9508036  647043074  9648.8
## - JobRole                  8  297033066  934568104  9890.7
## - JobLevel                 4 1144342668 1781877707 10347.9
## 
## Step:  AIC=9638.53
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + JobInvolvement + JobLevel + 
##     JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - Age                      1       7768  637542882  9636.5
## - WorkLifeBalance          1      96875  637631989  9636.6
## - MaritalStatus            2    1944485  639479598  9636.6
## - PercentSalaryHike        1     136286  637671399  9636.7
## - Education                4    5728697  643263810  9636.8
## - Gender                   1     317803  637852917  9636.9
## - YearsAtCompany           1     636050  638171163  9637.2
## - StockOptionLevel         1     968296  638503409  9637.6
## - YearsSinceLastPromotion  1    1118084  638653197  9637.7
## - OverTime                 1    1183145  638718259  9637.8
## - MonthlyRate              1    1189043  638724156  9637.8
## - JobInvolvement           3    4939487  642474601  9637.9
## - YearsWithCurrManager     1    1390698  638925812  9638.0
## - NumCompaniesWorked       1    1417851  638952964  9638.1
## - DailyRate                1    1431943  638967057  9638.1
## &lt;none&gt;                                   637535113  9638.5
## - DistanceFromHome         1    1841556  639376669  9638.5
## - Department               2    4059655  641594768  9638.9
## - YearsInCurrentRole       1    2524286  640059400  9639.3
## - TrainingTimesLastYear    1    3650769  641185882  9640.5
## + HourlyRate               1         75  637535038  9640.5
## - BusinessTravel           2    5735442  643270555  9640.8
## + JobSatisfaction          3     524218  637010896  9644.0
## + EducationField           5    2945777  634589337  9645.3
## - TotalWorkingYears        1    9508174  647043288  9646.8
## - JobRole                  8  297872974  935408087  9889.4
## - JobLevel                 4 1148457279 1785992392 10347.5
## 
## Step:  AIC=9636.54
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + JobInvolvement + JobLevel + 
##     JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - WorkLifeBalance          1      93901  637636783  9634.6
## - MaritalStatus            2    1947208  639490089  9634.7
## - PercentSalaryHike        1     137194  637680076  9634.7
## - Education                4    5746308  643289190  9634.8
## - Gender                   1     319712  637862593  9634.9
## - YearsAtCompany           1     628659  638171540  9635.2
## - StockOptionLevel         1     975452  638518334  9635.6
## - YearsSinceLastPromotion  1    1115682  638658564  9635.8
## - OverTime                 1    1176514  638719395  9635.8
## - MonthlyRate              1    1206712  638749594  9635.9
## - JobInvolvement           3    4955119  642498000  9635.9
## - YearsWithCurrManager     1    1384209  638927090  9636.0
## - NumCompaniesWorked       1    1410737  638953618  9636.1
## - DailyRate                1    1437295  638980176  9636.1
## &lt;none&gt;                                   637542882  9636.5
## - DistanceFromHome         1    1836426  639379307  9636.5
## - Department               2    4054648  641597530  9636.9
## - YearsInCurrentRole       1    2527123  640070004  9637.3
## - TrainingTimesLastYear    1    3646137  641189018  9638.5
## + Age                      1       7768  637535113  9638.5
## + HourlyRate               1          0  637542881  9638.5
## - BusinessTravel           2    5757578  643300459  9638.8
## + JobSatisfaction          3     520078  637022804  9642.0
## + EducationField           5    2893961  634648921  9643.4
## - TotalWorkingYears        1   11957355  649500237  9647.5
## - JobRole                  8  297905918  935448799  9887.4
## - JobLevel                 4 1151045134 1788588016 10346.5
## 
## Step:  AIC=9634.64
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + JobInvolvement + JobLevel + 
##     JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - MaritalStatus            2    1970361  639607143  9632.8
## - PercentSalaryHike        1     143480  637780263  9632.8
## - Education                4    5709187  643345970  9632.8
## - Gender                   1     329259  637966042  9633.0
## - YearsAtCompany           1     605722  638242504  9633.3
## - StockOptionLevel         1     968697  638605480  9633.7
## - YearsSinceLastPromotion  1    1082466  638719249  9633.8
## - OverTime                 1    1170825  638807608  9633.9
## - MonthlyRate              1    1215689  638852472  9634.0
## - JobInvolvement           3    5007314  642644097  9634.1
## - YearsWithCurrManager     1    1355078  638991861  9634.1
## - NumCompaniesWorked       1    1377126  639013908  9634.1
## - DailyRate                1    1489809  639126592  9634.3
## - DistanceFromHome         1    1801819  639438602  9634.6
## &lt;none&gt;                                   637636783  9634.6
## - Department               2    4057258  641694041  9635.1
## - YearsInCurrentRole       1    2440712  640077495  9635.3
## + WorkLifeBalance          1      93901  637542882  9636.5
## - TrainingTimesLastYear    1    3600063  641236846  9636.6
## + Age                      1       4794  637631989  9636.6
## + HourlyRate               1          3  637636780  9636.6
## - BusinessTravel           2    5896417  643533200  9637.0
## + JobSatisfaction          3     537550  637099233  9640.1
## + EducationField           5    2946085  634690697  9641.4
## - TotalWorkingYears        1   12012446  649649228  9645.6
## - JobRole                  8  298270588  935907371  9885.7
## - JobLevel                 4 1151425186 1789061968 10344.7
## 
## Step:  AIC=9632.79
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + JobInvolvement + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - PercentSalaryHike        1     108597  639715741  9630.9
## - Education                4    5698715  645305859  9631.0
## - Gender                   1     180107  639787251  9631.0
## - StockOptionLevel         1     407871  640015015  9631.2
## - YearsAtCompany           1     655559  640262703  9631.5
## - YearsSinceLastPromotion  1    1062472  640669615  9631.9
## - OverTime                 1    1074353  640681497  9632.0
## - JobInvolvement           3    4802166  644409309  9632.0
## - MonthlyRate              1    1119312  640726455  9632.0
## - YearsWithCurrManager     1    1335854  640942997  9632.2
## - DailyRate                1    1415878  641023021  9632.3
## - DistanceFromHome         1    1482145  641089288  9632.4
## - NumCompaniesWorked       1    1547190  641154333  9632.5
## &lt;none&gt;                                   639607143  9632.8
## - Department               2    4206070  643813213  9633.3
## - YearsInCurrentRole       1    2756138  642363282  9633.8
## - TrainingTimesLastYear    1    3415134  643022277  9634.5
## + MaritalStatus            2    1970361  637636783  9634.6
## + WorkLifeBalance          1     117054  639490089  9634.7
## + HourlyRate               1       8709  639598435  9634.8
## + Age                      1       6665  639600479  9634.8
## - BusinessTravel           2    6439242  646046386  9635.8
## + JobSatisfaction          3     673841  638933303  9638.1
## + EducationField           5    3005778  636601366  9639.5
## - TotalWorkingYears        1   12051501  651658645  9643.8
## - JobRole                  8  301424550  941031693  9885.5
## - JobLevel                 4 1149646196 1789253340 10340.8
## 
## Step:  AIC=9630.9
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + JobInvolvement + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - Education                4    5631857  645347598  9629.0
## - Gender                   1     178707  639894448  9629.1
## - StockOptionLevel         1     431636  640147376  9629.4
## - YearsAtCompany           1     659034  640374775  9629.6
## - JobInvolvement           3    4725803  644441544  9630.0
## - OverTime                 1    1061540  640777281  9630.1
## - YearsSinceLastPromotion  1    1097666  640813407  9630.1
## - MonthlyRate              1    1125668  640841409  9630.1
## - YearsWithCurrManager     1    1312222  641027963  9630.3
## - DailyRate                1    1411403  641127144  9630.4
## - NumCompaniesWorked       1    1545306  641261047  9630.6
## - DistanceFromHome         1    1567999  641283740  9630.6
## &lt;none&gt;                                   639715741  9630.9
## - Department               2    4193164  643908905  9631.5
## - YearsInCurrentRole       1    2702066  642417807  9631.8
## - TrainingTimesLastYear    1    3385300  643101041  9632.6
## + WorkLifeBalance          1     122867  639592874  9632.8
## + PercentSalaryHike        1     108597  639607143  9632.8
## + MaritalStatus            2    1935478  637780263  9632.8
## + HourlyRate               1      10684  639705057  9632.9
## + Age                      1       7144  639708597  9632.9
## - BusinessTravel           2    6438819  646154560  9633.9
## + JobSatisfaction          3     671966  639043775  9636.2
## + EducationField           5    3001325  636714415  9637.6
## - TotalWorkingYears        1   12172899  651888640  9642.0
## - JobRole                  8  301656321  941372062  9883.8
## - JobLevel                 4 1150677768 1790393509 10339.2
## 
## Step:  AIC=9629.01
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Gender + JobInvolvement + JobLevel + JobRole + 
##     MonthlyRate + NumCompaniesWorked + OverTime + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - Gender                   1     245035  645592633  9627.3
## - JobInvolvement           3    3983981  649331579  9627.3
## - YearsAtCompany           1     443074  645790672  9627.5
## - StockOptionLevel         1     502279  645849877  9627.5
## - YearsSinceLastPromotion  1     852705  646200303  9627.9
## - OverTime                 1     911591  646259189  9628.0
## - YearsWithCurrManager     1    1153262  646500860  9628.2
## - DailyRate                1    1337795  646685393  9628.4
## - MonthlyRate              1    1480383  646827981  9628.6
## - DistanceFromHome         1    1613628  646961226  9628.7
## &lt;none&gt;                                   645347598  9629.0
## - NumCompaniesWorked       1    2034361  647381959  9629.2
## - YearsInCurrentRole       1    2092341  647439939  9629.3
## - Department               2    4419241  649766839  9629.8
## - TrainingTimesLastYear    1    2833466  648181065  9630.1
## + Education                4    5631857  639715741  9630.9
## + MaritalStatus            2    1939422  643408176  9630.9
## + WorkLifeBalance          1      80133  645267466  9630.9
## + PercentSalaryHike        1      41739  645305859  9631.0
## + Age                      1      23861  645323737  9631.0
## + HourlyRate               1        670  645346929  9631.0
## - BusinessTravel           2    6323044  651670642  9631.8
## + JobSatisfaction          3     988252  644359346  9633.9
## + EducationField           5    2631481  642716118  9636.2
## - TotalWorkingYears        1   13292098  658639697  9641.2
## - JobRole                  8  309157577  954505175  9885.4
## - JobLevel                 4 1152001834 1797349432 10333.9
## 
## Step:  AIC=9627.27
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobInvolvement + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + OverTime + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - JobInvolvement           3    4094508  649687141  9625.7
## - YearsAtCompany           1     468820  646061452  9625.8
## - StockOptionLevel         1     526801  646119434  9625.8
## - YearsSinceLastPromotion  1     851673  646444306  9626.2
## - OverTime                 1     942985  646535618  9626.3
## - YearsWithCurrManager     1    1174031  646766664  9626.5
## - DailyRate                1    1297790  646890423  9626.7
## - MonthlyRate              1    1510526  647103159  9626.9
## - DistanceFromHome         1    1631132  647223765  9627.0
## &lt;none&gt;                                   645592633  9627.3
## - NumCompaniesWorked       1    2009569  647602202  9627.4
## - YearsInCurrentRole       1    2080954  647673587  9627.5
## - Department               2    4451745  650044377  9628.1
## - TrainingTimesLastYear    1    2851983  648444616  9628.3
## + Gender                   1     245035  645347598  9629.0
## + Education                4    5698184  639894448  9629.1
## + WorkLifeBalance          1      87544  645505089  9629.2
## + PercentSalaryHike        1      40536  645552096  9629.2
## + Age                      1      21747  645570886  9629.2
## + HourlyRate               1       1594  645591038  9629.3
## + MaritalStatus            2    1772403  643820230  9629.4
## - BusinessTravel           2    6253300  651845933  9630.0
## + JobSatisfaction          3    1009910  644582723  9632.2
## + EducationField           5    2672777  642919856  9634.4
## - TotalWorkingYears        1   13350390  658943023  9639.5
## - JobRole                  8  308934020  954526653  9883.4
## - JobLevel                 4 1153243549 1798836182 10332.5
## 
## Step:  AIC=9625.67
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsAtCompany           1     494380  650181520  9624.2
## - StockOptionLevel         1     544748  650231889  9624.3
## - YearsSinceLastPromotion  1     958123  650645264  9624.7
## - OverTime                 1     981084  650668225  9624.7
## - MonthlyRate              1    1071100  650758240  9624.8
## - YearsWithCurrManager     1    1099793  650786934  9624.8
## - DailyRate                1    1243434  650930574  9625.0
## - DistanceFromHome         1    1551260  651238400  9625.3
## &lt;none&gt;                                   649687141  9625.7
## - NumCompaniesWorked       1    1898924  651586065  9625.7
## - YearsInCurrentRole       1    1980791  651667932  9625.8
## - Department               2    3878496  653565637  9625.8
## - TrainingTimesLastYear    1    2997484  652684624  9626.9
## + JobInvolvement           3    4094508  645592633  9627.3
## + Gender                   1     355561  649331579  9627.3
## + WorkLifeBalance          1     137738  649549403  9627.5
## + PercentSalaryHike        1       4878  649682263  9627.7
## + Age                      1       3205  649683936  9627.7
## + HourlyRate               1       1316  649685824  9627.7
## + MaritalStatus            2    1587858  648099282  9628.0
## - BusinessTravel           2    6133125  655820266  9628.2
## + Education                4    4960681  644726460  9628.3
## + JobSatisfaction          3    1039139  648648002  9630.6
## + EducationField           5    2480891  647206250  9633.0
## - TotalWorkingYears        1   13929453  663616593  9638.4
## - JobRole                  8  309554125  959241266  9880.9
## - JobLevel                 4 1152271737 1801958878 10327.7
## 
## Step:  AIC=9624.2
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - StockOptionLevel         1     546934  650728454  9622.8
## - YearsSinceLastPromotion  1     660449  650841969  9622.9
## - OverTime                 1     950796  651132317  9623.2
## - MonthlyRate              1     998227  651179747  9623.3
## - DailyRate                1    1302513  651484034  9623.6
## - DistanceFromHome         1    1435318  651616838  9623.7
## - YearsInCurrentRole       1    1517618  651699139  9623.8
## &lt;none&gt;                                   650181520  9624.2
## - YearsWithCurrManager     1    2165723  652347244  9624.5
## - Department               2    4048115  654229636  9624.5
## - NumCompaniesWorked       1    2611978  652793498  9625.0
## - TrainingTimesLastYear    1    2864363  653045883  9625.3
## + YearsAtCompany           1     494380  649687141  9625.7
## + JobInvolvement           3    4120068  646061452  9625.8
## + Gender                   1     389901  649791619  9625.8
## + WorkLifeBalance          1     114491  650067029  9626.1
## + Age                      1      12166  650169355  9626.2
## + PercentSalaryHike        1       5951  650175569  9626.2
## + HourlyRate               1        761  650180759  9626.2
## + MaritalStatus            2    1631482  648550038  9626.5
## - BusinessTravel           2    6199577  656381098  9626.8
## + Education                4    4755435  645426085  9627.1
## + JobSatisfaction          3    1006598  649174922  9629.1
## + EducationField           5    2404366  647777155  9631.6
## - TotalWorkingYears        1   13594389  663775909  9636.6
## - JobRole                  8  315506089  965687609  9883.5
## - JobLevel                 4 1161004551 1811186072 10329.2
## 
## Step:  AIC=9622.78
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + TotalWorkingYears + TrainingTimesLastYear + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsSinceLastPromotion  1     650555  651379010  9621.5
## - OverTime                 1    1006214  651734669  9621.9
## - MonthlyRate              1    1080930  651809384  9621.9
## - DistanceFromHome         1    1306152  652034606  9622.2
## - DailyRate                1    1346668  652075122  9622.2
## - YearsInCurrentRole       1    1696132  652424586  9622.6
## &lt;none&gt;                                   650728454  9622.8
## - Department               2    4038724  654767178  9623.1
## - YearsWithCurrManager     1    2201066  652929520  9623.1
## - NumCompaniesWorked       1    2758192  653486647  9623.7
## - TrainingTimesLastYear    1    2948885  653677340  9623.9
## + StockOptionLevel         1     546934  650181520  9624.2
## + YearsAtCompany           1     496565  650231889  9624.3
## + Gender                   1     422647  650305808  9624.3
## + JobInvolvement           3    4140723  646587731  9624.3
## + WorkLifeBalance          1      98346  650630108  9624.7
## + Age                      1      14932  650713522  9624.8
## + PercentSalaryHike        1      12753  650715701  9624.8
## + HourlyRate               1        108  650728347  9624.8
## - BusinessTravel           2    6153606  656882060  9625.3
## + Education                4    4817954  645910500  9625.6
## + MaritalStatus            2     926407  649802048  9625.8
## + JobSatisfaction          3    1062501  649665953  9627.6
## + EducationField           5    2464979  648263475  9630.1
## - TotalWorkingYears        1   13603512  664331966  9635.2
## - JobRole                  8  317632496  968360951  9883.5
## - JobLevel                 4 1161632819 1812361274 10327.7
## 
## Step:  AIC=9621.48
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     OverTime + TotalWorkingYears + TrainingTimesLastYear + YearsInCurrentRole + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - OverTime                 1     987225  652366235  9620.5
## - MonthlyRate              1    1092602  652471612  9620.6
## - DailyRate                1    1287150  652666159  9620.9
## - DistanceFromHome         1    1313611  652692621  9620.9
## &lt;none&gt;                                   651379010  9621.5
## - YearsWithCurrManager     1    1918492  653297501  9621.5
## - Department               2    4256167  655635177  9622.0
## - YearsInCurrentRole       1    2409399  653788409  9622.0
## - NumCompaniesWorked       1    2526097  653905106  9622.2
## - TrainingTimesLastYear    1    2810873  654189882  9622.5
## + YearsSinceLastPromotion  1     650555  650728454  9622.8
## + StockOptionLevel         1     537040  650841969  9622.9
## + JobInvolvement           3    4221951  647157059  9623.0
## + Gender                   1     409027  650969983  9623.0
## + YearsAtCompany           1     199553  651179456  9623.3
## + WorkLifeBalance          1      77265  651301745  9623.4
## + PercentSalaryHike        1      23854  651355156  9623.5
## + Age                      1      13728  651365282  9623.5
## + HourlyRate               1         96  651378913  9623.5
## - BusinessTravel           2    5907322  657286331  9623.8
## + Education                4    4663167  646715842  9624.5
## + MaritalStatus            2     931257  650447752  9624.5
## + JobSatisfaction          3     999776  650379233  9626.4
## + EducationField           5    2445065  648933945  9628.9
## - TotalWorkingYears        1   15277234  666656243  9635.6
## - JobRole                  8  317701578  969080588  9882.0
## - JobLevel                 4 1175762162 1827141172 10331.3
## 
## Step:  AIC=9620.53
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsInCurrentRole + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - MonthlyRate              1    1123075  653489309  9619.7
## - DistanceFromHome         1    1215212  653581446  9619.8
## - DailyRate                1    1366476  653732711  9620.0
## &lt;none&gt;                                   652366235  9620.5
## - YearsWithCurrManager     1    1980758  654346992  9620.6
## - YearsInCurrentRole       1    2302994  654669229  9621.0
## - NumCompaniesWorked       1    2483071  654849306  9621.2
## - TrainingTimesLastYear    1    2602623  654968857  9621.3
## - Department               2    4495811  656862045  9621.3
## + OverTime                 1     987225  651379010  9621.5
## + YearsSinceLastPromotion  1     631566  651734669  9621.9
## + StockOptionLevel         1     591581  651774653  9621.9
## + JobInvolvement           3    4257862  648108373  9622.0
## + Gender                   1     448863  651917372  9622.1
## + YearsAtCompany           1     183906  652182329  9622.3
## + WorkLifeBalance          1      72572  652293662  9622.5
## + Age                      1      25492  652340742  9622.5
## + PercentSalaryHike        1      18724  652347510  9622.5
## + HourlyRate               1        448  652365787  9622.5
## - BusinessTravel           2    6111277  658477511  9623.0
## + MaritalStatus            2     842410  651523825  9623.6
## + Education                4    4527877  647838357  9623.7
## + JobSatisfaction          3    1058463  651307771  9625.4
## + EducationField           5    2358185  650008050  9628.0
## - TotalWorkingYears        1   15361829  667728063  9634.7
## - JobRole                  8  317435064  969801299  9880.5
## - JobLevel                 4 1178714175 1831080410 10330.8
## 
## Step:  AIC=9619.73
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + JobLevel + JobRole + NumCompaniesWorked + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsInCurrentRole + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - DistanceFromHome         1    1193998  654683307  9619.0
## - DailyRate                1    1406941  654896251  9619.2
## - YearsWithCurrManager     1    1782511  655271821  9619.6
## &lt;none&gt;                                   653489309  9619.7
## - YearsInCurrentRole       1    2226228  655715538  9620.1
## - NumCompaniesWorked       1    2501546  655990856  9620.4
## - Department               2    4400698  657890007  9620.4
## + MonthlyRate              1    1123075  652366235  9620.5
## - TrainingTimesLastYear    1    2686657  656175966  9620.6
## + OverTime                 1    1017698  652471612  9620.6
## + StockOptionLevel         1     679905  652809404  9621.0
## + YearsSinceLastPromotion  1     642938  652846371  9621.0
## + Gender                   1     475845  653013464  9621.2
## + YearsAtCompany           1     138480  653350830  9621.6
## + WorkLifeBalance          1      77675  653411634  9621.6
## + JobInvolvement           3    3808481  649680829  9621.7
## + PercentSalaryHike        1      24104  653465205  9621.7
## + Age                      1      11406  653477904  9621.7
## + HourlyRate               1        970  653488339  9621.7
## - BusinessTravel           2    6178706  659668015  9622.3
## + Education                4    4852115  648637194  9622.5
## + MaritalStatus            2     774115  652715195  9622.9
## + JobSatisfaction          3    1029094  652460215  9624.6
## + EducationField           5    2393816  651095494  9627.2
## - TotalWorkingYears        1   15170259  668659568  9633.7
## - JobRole                  8  316359886  969849196  9878.5
## - JobLevel                 4 1179357994 1832847304 10329.5
## 
## Step:  AIC=9619
## MonthlyIncome ~ BusinessTravel + DailyRate + Department + JobLevel + 
##     JobRole + NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsInCurrentRole + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - DailyRate                1    1352638  656035945  9618.4
## - YearsWithCurrManager     1    1700934  656384241  9618.8
## &lt;none&gt;                                   654683307  9619.0
## - YearsInCurrentRole       1    2305314  656988620  9619.4
## + DistanceFromHome         1    1193998  653489309  9619.7
## + MonthlyRate              1    1101860  653581446  9619.8
## - Department               2    4585463  659268770  9619.9
## - NumCompaniesWorked       1    2763255  657446562  9619.9
## - TrainingTimesLastYear    1    2839660  657522967  9620.0
## + OverTime                 1     918277  653765030  9620.0
## + YearsSinceLastPromotion  1     650849  654032458  9620.3
## + StockOptionLevel         1     536792  654146515  9620.4
## + Gender                   1     484152  654199155  9620.5
## + YearsAtCompany           1      87431  654595876  9620.9
## + PercentSalaryHike        1      61901  654621406  9620.9
## + WorkLifeBalance          1      56370  654626937  9620.9
## + Age                      1      11697  654671610  9621.0
## + HourlyRate               1       2847  654680459  9621.0
## + JobInvolvement           3    3723814  650959493  9621.0
## + Education                4    4914204  649769103  9621.8
## - BusinessTravel           2    6507166  661190473  9621.9
## + MaritalStatus            2     566938  654116369  9622.4
## + JobSatisfaction          3    1109627  653573680  9623.8
## + EducationField           5    2461470  652221837  9626.4
## - TotalWorkingYears        1   14942522  669625829  9632.7
## - JobRole                  8  317748751  972432058  9878.4
## - JobLevel                 4 1178596772 1833280079 10327.7
## 
## Step:  AIC=9618.44
## MonthlyIncome ~ BusinessTravel + Department + JobLevel + JobRole + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsInCurrentRole + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsWithCurrManager     1    1810016  657845961  9618.4
## &lt;none&gt;                                   656035945  9618.4
## + DailyRate                1    1352638  654683307  9619.0
## - YearsInCurrentRole       1    2527737  658563682  9619.1
## + MonthlyRate              1    1141642  654894304  9619.2
## + DistanceFromHome         1    1139694  654896251  9619.2
## - Department               2    4606953  660642899  9619.3
## + OverTime                 1     997122  655038823  9619.4
## - TrainingTimesLastYear    1    2978681  659014626  9619.6
## - NumCompaniesWorked       1    3096901  659132846  9619.7
## + YearsSinceLastPromotion  1     589109  655446836  9619.8
## + StockOptionLevel         1     587671  655448275  9619.8
## + Gender                   1     431972  655603973  9620.0
## + YearsAtCompany           1     120105  655915840  9620.3
## + WorkLifeBalance          1      92124  655943821  9620.3
## + PercentSalaryHike        1      57854  655978092  9620.4
## + Age                      1      10884  656025061  9620.4
## + HourlyRate               1        565  656035380  9620.4
## + JobInvolvement           3    3682440  652353506  9620.5
## - BusinessTravel           2    6412438  662448383  9621.2
## + Education                4    4824371  651211574  9621.3
## + MaritalStatus            2     594914  655441031  9621.8
## + JobSatisfaction          3     927592  655108353  9623.5
## + EducationField           5    2543458  653492487  9625.7
## - TotalWorkingYears        1   14714822  670750767  9631.9
## - JobRole                  8  316780055  972816001  9876.6
## - JobLevel                 4 1179281621 1835317566 10326.5
## 
## Step:  AIC=9618.36
## MonthlyIncome ~ BusinessTravel + Department + JobLevel + JobRole + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsInCurrentRole
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsInCurrentRole       1    1037257  658883219  9617.5
## &lt;none&gt;                                   657845961  9618.4
## + YearsWithCurrManager     1    1810016  656035945  9618.4
## + DailyRate                1    1461720  656384241  9618.8
## - Department               2    4381080  662227042  9619.0
## + OverTime                 1    1061036  656784925  9619.2
## + DistanceFromHome         1    1055479  656790482  9619.2
## - TrainingTimesLastYear    1    2829437  660675398  9619.3
## + MonthlyRate              1     942323  656903639  9619.4
## + YearsAtCompany           1     810201  657035760  9619.5
## + StockOptionLevel         1     624304  657221657  9619.7
## + Gender                   1     496695  657349266  9619.8
## + YearsSinceLastPromotion  1     324869  657521093  9620.0
## + WorkLifeBalance          1      48099  657797862  9620.3
## + Age                      1      45496  657800465  9620.3
## + PercentSalaryHike        1      35126  657810836  9620.3
## + HourlyRate               1       1488  657844473  9620.4
## + JobInvolvement           3    3653388  654192573  9620.5
## - NumCompaniesWorked       1    4190549  662036510  9620.8
## - BusinessTravel           2    6573579  664419540  9621.3
## + Education                4    4460096  653385865  9621.6
## + MaritalStatus            2     680769  657165192  9621.6
## + JobSatisfaction          3     934103  656911858  9623.4
## + EducationField           5    2454838  655391123  9625.8
## - TotalWorkingYears        1   13135666  670981627  9630.1
## - JobRole                  8  320680530  978526491  9878.7
## - JobLevel                 4 1181074736 1838920697 10325.8
## 
## Step:  AIC=9617.45
## MonthlyIncome ~ BusinessTravel + Department + JobLevel + JobRole + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
##                           Df  Sum of Sq        RSS     AIC
## &lt;none&gt;                                   658883219  9617.5
## + DailyRate                1    1578777  657304442  9617.8
## - Department               2    4271235  663154454  9617.9
## + DistanceFromHome         1    1151965  657731253  9618.2
## - TrainingTimesLastYear    1    2653625  661536843  9618.2
## + YearsInCurrentRole       1    1037257  657845961  9618.4
## + MonthlyRate              1     977972  657905246  9618.4
## + OverTime                 1     940311  657942907  9618.5
## + YearsSinceLastPromotion  1     819098  658064121  9618.6
## + StockOptionLevel         1     774238  658108980  9618.6
## - NumCompaniesWorked       1    3332819  662216038  9619.0
## + Gender                   1     415994  658467224  9619.0
## + YearsWithCurrManager     1     319537  658563682  9619.1
## + PercentSalaryHike        1      26109  658857110  9619.4
## + WorkLifeBalance          1       6915  658876304  9619.4
## + Age                      1       6765  658876454  9619.4
## + YearsAtCompany           1       3818  658879400  9619.4
## + HourlyRate               1        497  658882721  9619.5
## + JobInvolvement           3    3626581  655256638  9619.6
## - BusinessTravel           2    6745316  665628535  9620.5
## + MaritalStatus            2     811892  658071327  9620.6
## + Education                4    4223697  654659522  9621.0
## + JobSatisfaction          3     918225  657964993  9622.5
## + EducationField           5    2444807  656438411  9624.9
## - TotalWorkingYears        1   20045861  678929079  9636.3
## - JobRole                  8  319952445  978835664  9876.9
## - JobLevel                 4 1184231925 1843115144 10325.4</code></pre>
<pre class="r"><code>step$anova</code></pre>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + MaritalStatus + JobSatisfaction + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + WorkLifeBalance + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
## Final Model:
## MonthlyIncome ~ BusinessTravel + Department + JobLevel + JobRole + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
## 
##                         Step Df     Deviance Resid. Df Resid. Dev      AIC
## 1                                                  645  634073873 9652.739
## 2           - EducationField  5 2.933715e+06       650  637007588 9645.952
## 3          - JobSatisfaction  3 5.274505e+05       653  637535038 9640.528
## 4               - HourlyRate  1 7.499237e+01       654  637535113 9638.528
## 5                      - Age  1 7.768141e+03       655  637542882 9636.537
## 6          - WorkLifeBalance  1 9.390104e+04       656  637636783 9634.639
## 7            - MaritalStatus  2 1.970361e+06       658  639607143 9632.786
## 8        - PercentSalaryHike  1 1.085974e+05       659  639715741 9630.905
## 9                - Education  4 5.631857e+06       663  645347598 9629.005
## 10                  - Gender  1 2.450346e+05       664  645592633 9627.269
## 11          - JobInvolvement  3 4.094508e+06       667  649687141 9625.670
## 12          - YearsAtCompany  1 4.943797e+05       668  650181520 9624.199
## 13        - StockOptionLevel  1 5.469339e+05       669  650728454 9622.784
## 14 - YearsSinceLastPromotion  1 6.505553e+05       670  651379010 9621.480
## 15                - OverTime  1 9.872250e+05       671  652366235 9620.534
## 16             - MonthlyRate  1 1.123075e+06       672  653489309 9619.731
## 17        - DistanceFromHome  1 1.193998e+06       673  654683307 9619.002
## 18               - DailyRate  1 1.352638e+06       674  656035945 9618.438
## 19    - YearsWithCurrManager  1 1.810016e+06       675  657845961 9618.356
## 20      - YearsInCurrentRole  1 1.037257e+06       676  658883219 9617.452</code></pre>
</div>
<div id="predict-on-test-set-2" class="section level1">
<h1>Predict on test set</h1>
<pre class="r"><code>predictions = as.data.frame(predict(step, data = testData))
residuals = testData$MonthlyIncome - predictions
n = length(testData$MonthlyIncome)
RMSE = sqrt(sum((residuals^2)/n))
RMSE</code></pre>
<pre><code>## [1] 13569.2</code></pre>
<div id="lasso-regression" class="section level30">
<p>LASSO REGRESSION</p>
</div>
</div>
<div id="import-libraries-2" class="section level1">
<h1>Import Libraries</h1>
<pre class="r"><code>library(glmnet)</code></pre>
<pre><code>## Warning: package &#39;glmnet&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## Loaded glmnet 3.0-2</code></pre>
<pre class="r"><code>library(fastDummies)</code></pre>
<pre><code>## Warning: package &#39;fastDummies&#39; was built under R version 3.6.3</code></pre>
</div>
<div id="run-a-lasso-regression" class="section level1">
<h1>Run a LASSO regression</h1>
</div>
<div id="remove-unused-variables-in-dataset" class="section level1">
<h1>Remove unused variables in dataset</h1>
<pre class="r"><code>lasso_data = data[,c(-1, -3, -10, -11, -23, -28)]</code></pre>
<pre class="r"><code># Ensure data is already split
x_vars = model.matrix(MonthlyIncome~., lasso_data)[,-1]
y_var = lasso_data$MonthlyIncome
lambda_seq = 10^seq(2, -2, by = -.1)

set.seed(75)
trainIndices = sample(1:nrow(x_vars), nrow(x_vars)/2)
x_test = (-trainIndices)
y_test = y_var[-trainIndices]

cv_output = cv.glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = lambda_seq)

best_lam = cv_output$lambda.min
best_lam</code></pre>
<pre><code>## [1] 39.81072</code></pre>
</div>
<div id="run-lasso-regression" class="section level1">
<h1>Run LASSO Regression</h1>
<pre class="r"><code>lassoBest = glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = best_lam)
pred = predict(lassoBest, s = best_lam, newx = x_vars[-trainIndices,])
final = cbind(y_var[-trainIndices], pred)</code></pre>
</div>
<div id="get-rmse" class="section level1">
<h1>Get RMSE</h1>
<pre class="r"><code>actual = y_var[-trainIndices]
residuals = actual - pred
n = length(pred)
RMSE = sqrt(sum(actual - pred)^2/n)
RMSE</code></pre>
<pre><code>## [1] 1126.208</code></pre>
</div>
<div id="create-a-loop-to-get-an-average-rmse-value" class="section level1">
<h1>Create a loop to get an average RMSE value</h1>
<pre class="r"><code>seeds = sample(0:10000, 500, replace = FALSE)
RMSEs = c(500)
resids = c(500)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(1:nrow(x_vars), nrow(x_vars)/2)
  x_test = (-trainIndices)
  y_test = y_var[-trainIndices]

  cv_output = cv.glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = lambda_seq)
  best_lam = cv_output$lambda.min

  lassoBest = glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = best_lam)
  pred = predict(lassoBest, s = best_lam, newx = x_vars[-trainIndices,])

  actual = y_var[-trainIndices]
  residuals = actual - pred
  resids[i] = abs(residuals)
  n = length(pred)
  RMSEs[i] = sqrt(sum(actual - pred)^2/n)
  i = i + 1
}</code></pre>
<pre><code>## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length</code></pre>
<pre class="r"><code>mean(resids)</code></pre>
<pre><code>## [1] 1005.223</code></pre>
<pre class="r"><code>mean(RMSEs)</code></pre>
<pre><code>## [1] 1136.051</code></pre>
<div id="create-test-predictions" class="section level4">
<h4>Create test predictions</h4>
</div>
</div>
<div id="import-test-set-and-manipulate-it" class="section level1">
<h1>Import test set and manipulate it</h1>
<pre class="r"><code>test_reg_data = read.csv(file = &#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2CompSet No Salary.csv&#39;, header = T)
id = test_reg_data$ID
test_reg_data = test_reg_data[,c(-1, -3, -10, -11, -22, -27)]

MonthlyIncomedf = data.frame(&#39;MonthlyIncome&#39; = matrix(0, ncol = 1, nrow = 300))
test_reg_data1 = test_reg_data[,c(1:15)]
test_reg_data2 = test_reg_data[,c(16:29)]
test_reg_data = cbind(test_reg_data1, MonthlyIncomedf, test_reg_data2)</code></pre>
</div>
<div id="remove-unused-variables-in-dataset-and-create-dummy-vars" class="section level1">
<h1>Remove unused variables in dataset and create dummy vars</h1>
<pre class="r"><code>test_x_vars = model.matrix(MonthlyIncome~., test_reg_data)[,-1]</code></pre>
</div>
<div id="refuses-to-knit" class="section level1">
<h1>Refuses to knit</h1>
<!-- # Predict on new data set and write to csv -->
<!-- ```{r} -->
<!-- pred = predict.glmnet(lassoBest, s = best_lam, newx = test_x_vars) -->
<!-- regression_preds = data.frame('ID' = id, 'MonthlyIncome' = pred) -->
<!-- colnames(regression_preds) = c('ID', 'MonthlyIncome') -->
<!-- ``` -->
<!-- # Write predictions to CSV -->
<!-- ```{r} -->
<!-- write.csv(regression_preds, file = 'C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/Case2PredictionsPengilly Salary.csv') -->
<!-- ``` -->
<div id="section-5" class="section level150">
<p></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
