<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Thomas Pengilly" />


<title>DDS Case Study 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Brewery_Case_Study.html">Beer Study</a>
</li>
<li>
  <a href="CaseStudy2_Pengilly.html">Attrition Study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">DDS Case Study 2</h1>
<h4 class="author">Thomas Pengilly</h4>
<h4 class="date">3/28/2020</h4>

</div>


<div id="case-study-2-tom-pengilly" class="section level1">
<h1>Case Study 2: Tom Pengilly</h1>
</div>
<div id="youtube-link-httpsyoutu.be7ylpnzwe0ei" class="section level1">
<h1>Youtube link: <a href="https://youtu.be/7yLpNzwe0EI" class="uri">https://youtu.be/7yLpNzwe0EI</a></h1>
<div id="summary" class="section level65">
<p>Summary</p>
<p>This file is for DDS Case Study 2. It explores employee attrition data provided by Frito-Lay to create to create multiple predictive models. The first 2 are classification algorithms (Naive-Bayes and logistic regression classifiers) that predict whether an employee will quit. The next 2 are regression algorithms that predict an employees salary. ######################################################################################################################################################</p>
</div>
<div id="section-1" class="section level3">
<h3>Section 1</h3>
</div>
</div>
<div id="perform-an-eda-of-case-study-2-data-in-order-to" class="section level1">
<h1>Perform an EDA of Case Study 2 data in order to:</h1>
</div>
<div id="find-the-top-3-factors-contributing-to-job-attrition-may-or-may-not-be-derived-factors" class="section level1">
<h1>Find the top 3 factors contributing to job attrition (may or may not be derived factors)</h1>
</div>
<div id="provide-any-job-specific-trends" class="section level1">
<h1>Provide any job specific trends</h1>
</div>
<div id="provide-any-other-interesting-findings" class="section level1">
<h1>Provide any other interesting findings</h1>
</div>
<div id="provide-clear-visualizations" class="section level1">
<h1>Provide clear visualizations</h1>
</div>
<div id="load-initial-libraries" class="section level1">
<h1>Load initial libraries</h1>
<pre class="r"><code>library(tidyverse)
library(ggplot2)
library(GGally)
library(scales)</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<pre class="r"><code>library(reshape2)</code></pre>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<pre class="r"><code>library(standardize)</code></pre>
<pre><code>## Warning: package &#39;standardize&#39; was built under R version 3.6.3</code></pre>
</div>
<div id="read-in-the-data-create-data-subsets" class="section level1">
<h1>Read in the data, create data subsets</h1>
<pre class="r"><code>data = read.csv(&#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2-data.csv&#39;, header = T)
data_left = data %&gt;% filter(Attrition == &#39;Yes&#39;)
data_stayed = data %&gt;% filter(Attrition == &#39;No&#39;)
data</code></pre>
<pre><code>##    ID Age Attrition    BusinessTravel DailyRate             Department
## 1   1  32        No     Travel_Rarely       117                  Sales
## 2   2  40        No     Travel_Rarely      1308 Research &amp; Development
## 3   3  35        No Travel_Frequently       200 Research &amp; Development
## 4   4  32        No     Travel_Rarely       801                  Sales
## 5   5  24        No Travel_Frequently       567 Research &amp; Development
## 6   6  27        No Travel_Frequently       294 Research &amp; Development
## 7   7  41        No     Travel_Rarely      1283 Research &amp; Development
## 8   8  37        No     Travel_Rarely       309                  Sales
## 9   9  34        No     Travel_Rarely      1333                  Sales
## 10 10  34        No Travel_Frequently       653 Research &amp; Development
## 11 11  43        No     Travel_Rarely       823 Research &amp; Development
## 12 12  28        No        Non-Travel       280        Human Resources
## 13 13  35        No     Travel_Rarely       950 Research &amp; Development
## 14 14  30        No     Travel_Rarely       202                  Sales
## 15 15  46        No     Travel_Rarely       991        Human Resources
## 16 16  31        No        Non-Travel      1188                  Sales
## 17 17  32        No     Travel_Rarely       498 Research &amp; Development
## 18 18  46        No        Non-Travel      1144 Research &amp; Development
## 19 19  34        No     Travel_Rarely       181 Research &amp; Development
## 20 20  44        No     Travel_Rarely       170 Research &amp; Development
## 21 21  36        No     Travel_Rarely       913 Research &amp; Development
## 22 22  48        No     Travel_Rarely       817                  Sales
## 23 23  43        No Travel_Frequently      1001 Research &amp; Development
## 24 24  31        No Travel_Frequently       715                  Sales
## 25 25  33        No     Travel_Rarely      1069 Research &amp; Development
## 26 26  44        No     Travel_Rarely      1099                  Sales
## 27 27  38        No     Travel_Rarely      1245                  Sales
##    DistanceFromHome Education   EducationField EmployeeCount EmployeeNumber
## 1                13         4    Life Sciences             1            859
## 2                14         3          Medical             1           1128
## 3                18         2    Life Sciences             1           1412
## 4                 1         4        Marketing             1           2016
## 5                 2         1 Technical Degree             1           1646
## 6                10         2    Life Sciences             1            733
## 7                 5         5          Medical             1           1448
## 8                10         4    Life Sciences             1           1105
## 9                10         4    Life Sciences             1           1055
## 10               10         4 Technical Degree             1           1597
## 11                6         3          Medical             1           1866
## 12                1         2    Life Sciences             1           1858
## 13                7         3            Other             1            845
## 14                2         1 Technical Degree             1            508
## 15                1         2    Life Sciences             1           1314
## 16               20         2        Marketing             1            947
## 17                3         4          Medical             1            966
## 18                7         4          Medical             1            487
## 19                2         4          Medical             1           1755
## 20                1         4    Life Sciences             1           1903
## 21                9         2          Medical             1            699
## 22                2         1        Marketing             1            712
## 23                9         5          Medical             1            663
## 24                2         4            Other             1           1613
## 25                1         3    Life Sciences             1            969
## 26                5         3        Marketing             1           1267
## 27               14         3    Life Sciences             1           1582
##    EnvironmentSatisfaction Gender HourlyRate JobInvolvement JobLevel
## 1                        2   Male         73              3        2
## 2                        3   Male         44              2        5
## 3                        3   Male         60              3        3
## 4                        3 Female         48              3        3
## 5                        1 Female         32              3        1
## 6                        4   Male         32              3        3
## 7                        2   Male         90              4        1
## 8                        4 Female         88              2        2
## 9                        3 Female         87              3        1
## 10                       4   Male         92              2        2
## 11                       1 Female         81              2        5
## 12                       3   Male         43              3        1
## 13                       3   Male         59              3        3
## 14                       3   Male         72              3        1
## 15                       4 Female         44              3        1
## 16                       4 Female         45              3        2
## 17                       3 Female         93              3        2
## 18                       3 Female         30              3        2
## 19                       4   Male         97              4        1
## 20                       2   Male         78              4        2
## 21                       2   Male         48              2        2
## 22                       2   Male         56              4        2
## 23                       4   Male         72              3        2
## 24                       4   Male         54              3        2
## 25                       2 Female         42              2        2
## 26                       2   Male         88              3        5
## 27                       3   Male         80              3        2
##                      JobRole JobSatisfaction MaritalStatus MonthlyIncome
## 1            Sales Executive               4      Divorced          4403
## 2          Research Director               3        Single         19626
## 3     Manufacturing Director               4        Single          9362
## 4            Sales Executive               4       Married         10422
## 5         Research Scientist               4        Single          3760
## 6     Manufacturing Director               1      Divorced          8793
## 7         Research Scientist               3       Married          2127
## 8            Sales Executive               4      Divorced          6694
## 9       Sales Representative               3       Married          2220
## 10 Healthcare Representative               3       Married          5063
## 11                   Manager               3       Married         19392
## 12           Human Resources               4      Divorced          2706
## 13    Manufacturing Director               3        Single         10221
## 14      Sales Representative               2       Married          2476
## 15           Human Resources               1        Single          3423
## 16           Sales Executive               3       Married          6932
## 17    Manufacturing Director               1       Married          6725
## 18    Manufacturing Director               3       Married          5258
## 19        Research Scientist               4       Married          2932
## 20 Healthcare Representative               1       Married          5033
## 21    Manufacturing Director               2      Divorced          8847
## 22           Sales Executive               2       Married          8120
## 23     Laboratory Technician               3      Divorced          5679
## 24           Sales Executive               1        Single          5332
## 25 Healthcare Representative               4        Single          6949
## 26                   Manager               2       Married         18213
## 27           Sales Executive               2       Married          9924
##    MonthlyRate NumCompaniesWorked Over18 OverTime PercentSalaryHike
## 1         9250                  2      Y       No                11
## 2        17544                  1      Y       No                14
## 3        19944                  2      Y       No                11
## 4        24032                  1      Y       No                19
## 5        17218                  1      Y      Yes                13
## 6         4809                  1      Y       No                21
## 7         5561                  2      Y      Yes                12
## 8        24223                  2      Y      Yes                14
## 9        18410                  1      Y      Yes                19
## 10       15332                  1      Y       No                14
## 11       22539                  7      Y       No                13
## 12       10494                  1      Y       No                15
## 13       18869                  3      Y       No                21
## 14       17434                  1      Y       No                18
## 15       22957                  6      Y       No                12
## 16       24406                  1      Y       No                13
## 17       13554                  1      Y       No                12
## 18       16044                  2      Y       No                14
## 19        5586                  0      Y      Yes                14
## 20        9364                  2      Y       No                15
## 21       13934                  2      Y      Yes                11
## 22       18597                  3      Y       No                12
## 23       19627                  3      Y      Yes                13
## 24       21602                  7      Y       No                13
## 25       12291                  0      Y       No                14
## 26        8751                  7      Y       No                11
## 27       12355                  0      Y       No                11
##    PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel
## 1                  3                        3            80                1
## 2                  3                        1            80                0
## 3                  3                        3            80                0
## 4                  3                        3            80                2
## 5                  3                        3            80                0
## 6                  4                        3            80                2
## 7                  3                        1            80                0
## 8                  3                        3            80                3
## 9                  3                        4            80                1
## 10                 3                        2            80                1
## 11                 3                        4            80                0
## 12                 3                        2            80                1
## 13                 4                        2            80                0
## 14                 3                        1            80                1
## 15                 3                        3            80                0
## 16                 3                        4            80                1
## 17                 3                        3            80                1
## 18                 3                        3            80                0
## 19                 3                        1            80                3
## 20                 3                        4            80                1
## 21                 3                        3            80                1
## 22                 3                        4            80                0
## 23                 3                        2            80                1
## 24                 3                        4            80                0
## 25                 3                        1            80                0
## 26                 3                        3            80                1
## 27                 3                        4            80                1
##    TotalWorkingYears TrainingTimesLastYear WorkLifeBalance YearsAtCompany
## 1                  8                     3               2              5
## 2                 21                     2               4             20
## 3                 10                     2               3              2
## 4                 14                     3               3             14
## 5                  6                     2               3              6
## 6                  9                     4               2              9
## 7                  7                     5               2              4
## 8                  8                     5               3              1
## 9                  1                     2               3              1
## 10                 8                     3               2              8
## 11                21                     2               3             16
## 12                 3                     2               3              3
## 13                17                     3               4              8
## 14                 1                     3               3              1
## 15                10                     3               4              7
## 16                 9                     2               2              9
## 17                 8                     2               4              8
## 18                 7                     2               4              1
## 19                 6                     3               3              5
## 20                10                     5               3              2
## 21                13                     2               3              3
## 22                12                     3               3              2
## 23                10                     3               3              8
## 24                10                     3               3              5
## 25                 6                     3               3              5
## 26                26                     5               3             22
## 27                10                     3               3              9
##    YearsInCurrentRole YearsSinceLastPromotion YearsWithCurrManager
## 1                   2                       0                    3
## 2                   7                       4                    9
## 3                   2                       2                    2
## 4                  10                       5                    7
## 5                   3                       1                    3
## 6                   7                       1                    7
## 7                   2                       0                    3
## 8                   0                       0                    0
## 9                   1                       0                    0
## 10                  2                       7                    7
## 11                 12                       6                   14
## 12                  2                       2                    2
## 13                  5                       1                    6
## 14                  0                       0                    0
## 15                  6                       5                    7
## 16                  8                       0                    0
## 17                  7                       6                    3
## 18                  0                       0                    0
## 19                  0                       1                    2
## 20                  0                       2                    2
## 21                  2                       0                    2
## 22                  2                       2                    2
## 23                  7                       4                    7
## 24                  2                       0                    3
## 25                  0                       1                    4
## 26                  9                       3                   10
## 27                  8                       7                    7
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 843 rows ]</code></pre>
<div id="eda" class="section level59">
<p>EDA</p>
</div>
</div>
<div id="ggally-correlation-matrix-to-explore-initial-corrlations" class="section level1">
<h1>GGally Correlation Matrix to explore initial corrlations</h1>
<pre class="r"><code>ggpairs(data, columns = c(3, 2, 4:6), title = &#39;Correlation Matrix&#39;, ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## 
 plot: [1,1] [=&gt;------------------------------------------------]  4% est: 0s 
 plot: [1,2] [===&gt;----------------------------------------------]  8% est: 1s 
 plot: [1,3] [=====&gt;--------------------------------------------] 12% est: 1s 
 plot: [1,4] [=======&gt;------------------------------------------] 16% est: 2s 
 plot: [1,5] [=========&gt;----------------------------------------] 20% est: 2s 
 plot: [2,1] [===========&gt;--------------------------------------] 24% est: 2s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [2,2] [=============&gt;------------------------------------] 28% est: 2s 
 plot: [2,3] [===============&gt;----------------------------------] 32% est: 2s 
 plot: [2,4] [=================&gt;--------------------------------] 36% est: 2s 
 plot: [2,5] [===================&gt;------------------------------] 40% est: 1s 
 plot: [3,1] [=====================&gt;----------------------------] 44% est: 1s 
 plot: [3,2] [=======================&gt;--------------------------] 48% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,3] [=========================&gt;------------------------] 52% est: 1s 
 plot: [3,4] [===========================&gt;----------------------] 56% est: 1s 
 plot: [3,5] [=============================&gt;--------------------] 60% est: 1s 
 plot: [4,1] [===============================&gt;------------------] 64% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [=================================&gt;----------------] 68% est: 1s 
 plot: [4,3] [===================================&gt;--------------] 72% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,4] [=====================================&gt;------------] 76% est: 1s 
 plot: [4,5] [=======================================&gt;----------] 80% est: 1s 
 plot: [5,1] [=========================================&gt;--------] 84% est: 0s 
 plot: [5,2] [===========================================&gt;------] 88% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,3] [=============================================&gt;----] 92% est: 0s 
 plot: [5,4] [===============================================&gt;--] 96% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,5] [==================================================]100% est: 0s 
                                                                              </code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>ggpairs(data, columns = c(3, 2, 7:10), title = &#39;Correlation Matrix&#39;, ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## 
 plot: [1,1] [&gt;-------------------------------------------------]  3% est: 0s 
 plot: [1,2] [==&gt;-----------------------------------------------]  6% est: 1s 
 plot: [1,3] [===&gt;----------------------------------------------]  8% est: 2s 
 plot: [1,4] [=====&gt;--------------------------------------------] 11% est: 2s 
 plot: [1,5] [======&gt;-------------------------------------------] 14% est: 2s 
 plot: [1,6] [=======&gt;------------------------------------------] 17% est: 2s 
 plot: [2,1] [=========&gt;----------------------------------------] 19% est: 2s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [2,2] [==========&gt;---------------------------------------] 22% est: 2s 
 plot: [2,3] [===========&gt;--------------------------------------] 25% est: 2s 
 plot: [2,4] [=============&gt;------------------------------------] 28% est: 2s 
 plot: [2,5] [==============&gt;-----------------------------------] 31% est: 2s 
 plot: [2,6] [================&gt;---------------------------------] 33% est: 2s</code></pre>
<pre><code>## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero</code></pre>
<pre><code>## 
 plot: [3,1] [=================&gt;--------------------------------] 36% est: 2s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,2] [==================&gt;-------------------------------] 39% est: 2s 
 plot: [3,3] [====================&gt;-----------------------------] 42% est: 2s 
 plot: [3,4] [=====================&gt;----------------------------] 44% est: 2s 
 plot: [3,5] [=======================&gt;--------------------------] 47% est: 2s 
 plot: [3,6] [========================&gt;-------------------------] 50% est: 2s</code></pre>
<pre><code>## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero</code></pre>
<pre><code>## 
 plot: [4,1] [=========================&gt;------------------------] 53% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [===========================&gt;----------------------] 56% est: 1s 
 plot: [4,3] [============================&gt;---------------------] 58% est: 1s 
 plot: [4,4] [==============================&gt;-------------------] 61% est: 1s 
 plot: [4,5] [===============================&gt;------------------] 64% est: 1s 
 plot: [4,6] [================================&gt;-----------------] 67% est: 1s</code></pre>
<pre><code>## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero

## Warning in cor(x, y, method = method, use = use): the standard deviation is zero</code></pre>
<pre><code>## 
 plot: [5,1] [==================================&gt;---------------] 69% est: 1s 
 plot: [5,2] [===================================&gt;--------------] 72% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,3] [=====================================&gt;------------] 75% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,4] [======================================&gt;-----------] 78% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [5,5] [=======================================&gt;----------] 81% est: 1s 
 plot: [5,6] [=========================================&gt;--------] 83% est: 1s 
 plot: [6,1] [==========================================&gt;-------] 86% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [6,2] [===========================================&gt;------] 89% est: 0s 
 plot: [6,3] [=============================================&gt;----] 92% est: 0s 
 plot: [6,4] [==============================================&gt;---] 94% est: 0s 
 plot: [6,5] [================================================&gt;-] 97% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [6,6] [==================================================]100% est: 0s 
                                                                              </code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="explore-variables" class="section level1">
<h1>Explore variables</h1>
<div id="years-with-current-manager" class="section level9">
<p>Years with current manager</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 36), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="years-since-promotion" class="section level9">
<p>Years Since promotion</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 35), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="years-in-current-role" class="section level9">
<p>Years in current role</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 34), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="years-at-company" class="section level9">
<p>Years at company</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 33), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="work-life-balance" class="section level9">
<p>Work Life Balance</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 32), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div id="training-times-last-year" class="section level11">
<p>Training times last year</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 31), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="total-working-years-blue-is-quit-job" class="section level11">
<p>Total Working Years BLUE IS QUIT JOB</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 30), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="stock-options" class="section level9">
<p>Stock Options</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 29), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="relationship-satisfaction" class="section level9">
<p>Relationship satisfaction</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 27), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="performance-rating" class="section level9">
<p>Performance Rating</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 26), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="percent-salary-hike" class="section level9">
<p>Percent salary hike</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 25), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="over-time" class="section level9">
<p>Over Time</p>
</div>
</div>
<div id="wont-knit-properly" class="section level1">
<h1>Won’t knit properly</h1>
<pre class="r"><code>#ggpairs(data, columns = c(3, 24), ggplot2::aes(color = data$Attrition))
#data %&gt;% ggplot(aes(x = data$Attrition, y = n, fill = OverTime)) + geom_bar(stat = &#39;identity&#39;)</code></pre>
<div id="num-companies-worked" class="section level9">
<p>Num Companies Worked</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 22), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="monthly-rate" class="section level9">
<p>Monthly Rate</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 21), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="monthly-income" class="section level9">
<p>Monthly Income</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 20), ggplot2::aes(color = data$Attrition), legend = 3)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="marital-status" class="section level9">
<p>Marital Status</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 19), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="job-satisfaction" class="section level9">
<p>Job Satisfaction</p>
<pre class="r"><code>data2 = data
data2$JobSatisfaction = as.numeric(data2$JobSatisfaction)
ggpairs(data2, columns = c(3, 18), ggplot2::aes(color = data$Attrition), legend = 3)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="job-role" class="section level9">
<p>Job Role</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 17), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="job-level" class="section level9">
<p>Job Level</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 16), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="job-involvement" class="section level9">
<p>Job Involvement</p>
<pre class="r"><code>data2 = data
data2$JobInvolvement = as.factor(data2$JobInvolvement)  
ggpairs(data2, columns = c(3, 15), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="hourly-rate" class="section level9">
<p>Hourly Rate</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 14), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="gender" class="section level9">
<p>Gender</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 13), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="environment-satisfaction" class="section level9">
<p>Environment Satisfaction</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 12), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="employee-number" class="section level9">
<p>Employee Number</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 11), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="education-field" class="section level9">
<p>Education Field</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 9), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="education" class="section level9">
<p>Education</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 8), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="distance-from-home" class="section level9">
<p>Distance From Home</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 7), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="deparment" class="section level9">
<p>Deparment</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 6), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="daily-rate" class="section level9">
<p>Daily Rate</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 5), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="business-travel" class="section level9">
<p>Business Travel</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 4), ggplot2::aes(color = data$Attrition))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="age" class="section level9">
<p>Age</p>
<pre class="r"><code>ggpairs(data, columns = c(3, 2), ggplot2::aes(color = data$Attrition))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div id="section" class="section level150">
<p></p>
</div>
<div id="section-2" class="section level150">
<p></p>
</div>
</div>
</div>
<div id="job-specific-analysis-environment-satisfaction" class="section level1">
<h1>Job Specific analysis Environment satisfaction</h1>
<pre class="r"><code>env_count = data %&gt;% group_by(JobRole) %&gt;% count(EnvironmentSatisfaction)
data %&gt;% ggplot() + geom_boxplot(aes(x = data$JobRole, y = data$EnvironmentSatisfaction, color = data$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<pre class="r"><code>env_count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = EnvironmentSatisfaction, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Environment Satisfaction By Job Role&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 3)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
</div>
<div id="job-involvement-vs-attrition" class="section level1">
<h1>Job Involvement vs attrition</h1>
<pre class="r"><code>job_inv = data2 %&gt;% group_by(JobInvolvement) %&gt;% count(Attrition)
job_inv %&gt;% ggplot() + geom_boxplot(aes(x = job_inv$JobInvolvement, y = job_inv$Attrition, color = job_inv$JobInvolvement)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<pre class="r"><code>job_inv %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = Attrition, y = n, x = JobInvolvement, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition by Job Involvement&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 5)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-37-2.png" width="672" /></p>
</div>
<div id="job-level-vs-attrition" class="section level1">
<h1>Job Level vs attrition</h1>
<pre class="r"><code>job_inv = data2 %&gt;% group_by(JobLevel) %&gt;% count(Attrition)
job_inv %&gt;% ggplot() + geom_boxplot(aes(x = job_inv$JobLevel, y = job_inv$Attrition, color = job_inv$JobLevel)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code>job_inv %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = Attrition, y = n, x = JobLevel, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition by Job Level&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 5)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
</div>
<div id="job-role-vs-attrition" class="section level1">
<h1>Job Role vs attrition</h1>
<pre class="r"><code>dept_att = data2 %&gt;% group_by(JobRole) %&gt;% count(Attrition)
dept_att %&gt;% ggplot() + geom_boxplot(aes(x = dept_att$JobRole, y = dept_att$Attrition, color = dept_att$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<pre class="r"><code>dept_att %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = Attrition, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition by Job Role&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
</div>
<div id="job-role-vs-overtime" class="section level1">
<h1>Job Role vs Overtime</h1>
<pre class="r"><code>dept_att = data2 %&gt;% group_by(JobRole) %&gt;% count(OverTime)
dept_att %&gt;% ggplot() + geom_boxplot(aes(x = dept_att$JobRole, y = dept_att$OverTime, color = dept_att$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<pre class="r"><code>dept_att %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = OverTime, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;OverTime by Job Role&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-40-2.png" width="672" /></p>
</div>
<div id="attrition-vs-overtime" class="section level1">
<h1>Attrition vs Overtime</h1>
<pre class="r"><code>OT_att = data2 %&gt;% group_by(Attrition) %&gt;% count(OverTime)
OT_att %&gt;% ggplot() + geom_boxplot(aes(x = OT_att$Attrition, y = OT_att$OverTime, color = OT_att$Attrition)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<pre class="r"><code>OT_att %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = OverTime, y = n, x = Attrition, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Attrition vs Overtime&#39;)  + geom_text(position = position_dodge(width = .9), vjust = -0.2, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
</div>
<div id="job-specific-analysis-travel" class="section level1">
<h1>Job Specific analysis Travel</h1>
<pre class="r"><code>count = data %&gt;% group_by(JobRole) %&gt;% count(BusinessTravel)
jobcount = data %&gt;% count(JobRole)

count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = BusinessTravel, y = pct, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = .5), vjust = -0.0, size = 3)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<pre class="r"><code>count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = BusinessTravel, y = pct, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = .7), vjust = 0.5, hjust = 0.0, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
</div>
<div id="most-involved-jobs" class="section level1">
<h1>Most involved jobs</h1>
<pre class="r"><code>involved_count = data %&gt;% group_by(JobRole) %&gt;% count(JobInvolvement)
involved_count$JobInvolvement = factor(involved_count$JobInvolvement)
involved_count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobInvolvement, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;, ) + coord_flip() + geom_text(position = position_dodge(width = .7), vjust = 0.5, hjust = 0.0, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="job-specific-analysis-marital-status" class="section level1">
<h1>Job Specific analysis Marital Status</h1>
<pre class="r"><code>marital_count = data %&gt;% group_by(JobRole) %&gt;% count(MaritalStatus)
marital_count %&gt;% ggplot(aes(fill = MaritalStatus, y = n, x = JobRole)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="overtime-by-job-role-where-we-need-to-hire-more-people" class="section level1">
<h1>Overtime by job role (Where we need to hire more people)</h1>
<pre class="r"><code>ot_count = data %&gt;% group_by(JobRole) %&gt;% count(OverTime)
ot_count %&gt;% ggplot(aes(fill = OverTime, y = n, x = JobRole)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Overtime By Department&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
<div id="overtime-by-job-level-where-we-need-to-hire-more-people" class="section level1">
<h1>Overtime by job level (Where we need to hire more people)</h1>
<pre class="r"><code>ot_count = data %&gt;% group_by(JobLevel) %&gt;% count(OverTime)
ot_count %&gt;% ggplot(aes(fill = OverTime, y = n, x = JobLevel)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Overtime By Job Level&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="environment-satisfaction-by-job-level-where-we-need-to-hire-more-people" class="section level1">
<h1>Environment satisfaction by job level (Where we need to hire more people)</h1>
<pre class="r"><code>sat_count = data %&gt;% group_by(JobLevel) %&gt;% count(EnvironmentSatisfaction)
sat_count %&gt;% ggplot(aes(fill = EnvironmentSatisfaction, y = n, x = JobLevel)) + geom_bar(position = &#39;fill&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Environment Satisfaction By Job Level&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="worklifebalance-by-department" class="section level1">
<h1>WorkLifeBalance by Department</h1>
<pre class="r"><code>wl_count = data %&gt;% group_by(JobRole) %&gt;% count(WorkLifeBalance)
wl_count$WorkLifeBalance = as.factor(wl_count$WorkLifeBalance)

wl_count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = wl_count$WorkLifeBalance, y = n, x = JobRole, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + ggtitle(&#39;Work-Life Balance By Department&#39;) + ylab(&#39;Percentage of Employees&#39;) + scale_y_continuous(labels = scales::percent) + geom_text(position = position_dodge(width = .7), vjust = 0.5, hjust = 0.0, size = 4)</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-job-role" class="section level1">
<h1>Monthly income by job role</h1>
<pre class="r"><code>data %&gt;% ggplot() + geom_boxplot(aes(x = data$JobRole, y = data$MonthlyIncome, color = data$JobRole)) + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div id="other-trends" class="section level48">
<p>Other Trends</p>
</div>
</div>
<div id="job-involvement-by-environment-satisfaction" class="section level1">
<h1>Job involvement by environment satisfaction</h1>
<pre class="r"><code>count = data %&gt;% group_by(EnvironmentSatisfaction) %&gt;% count(JobInvolvement)
count$EnvironmentSatisfaction = factor(count$EnvironmentSatisfaction)
count$JobInvolvement = factor(count$JobInvolvement)

count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = EnvironmentSatisfaction, y = pct, x = JobInvolvement, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<pre class="r"><code>count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobInvolvement, y = pct, x = EnvironmentSatisfaction, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-50-2.png" width="672" /></p>
</div>
<div id="job-involvement-by-job-satisfaction" class="section level1">
<h1>Job involvement by job satisfaction</h1>
<pre class="r"><code>count = data %&gt;% group_by(JobSatisfaction) %&gt;% count(JobInvolvement)
count$JobSatisfaction = factor(count$JobSatisfaction)
count$JobInvolvement = factor(count$JobInvolvement)

count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobSatisfaction, y = pct, x = JobInvolvement, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<pre class="r"><code>count %&gt;% mutate(pct = prop.table(n)) %&gt;% ggplot(aes(fill = JobInvolvement, y = pct, x = JobSatisfaction, label = scales::percent(pct))) + geom_bar(position = &#39;dodge&#39;, stat = &#39;identity&#39;) + coord_flip() + geom_text(position = position_dodge(width = 0.7))</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-51-2.png" width="672" /></p>
</div>
<div id="monthly-income-by-job-role-and-job-satisfaction" class="section level1">
<h1>Monthly Income by job role and job satisfaction</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$MonthlyIncome, fill = factor(data$JobSatisfaction))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-job-role-and-job-involvement" class="section level1">
<h1>Monthly Income by job role and job involvement</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$MonthlyIncome, fill = factor(data$JobInvolvement))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
<div id="percent-salary-hike-by-job-role-and-job-satisfaction" class="section level1">
<h1>percent salary hike by job role and job satisfaction</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$PercentSalaryHike, fill = factor(data$JobSatisfaction))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="percent-salary-hike-by-job-role-and-job-involvement" class="section level1">
<h1>Percent salary hike by job role and job involvement</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = data$JobRole, y = data$PercentSalaryHike, fill = factor(data$JobInvolvement))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-education-and-job-involvement" class="section level1">
<h1>Monthly Income by Education and job involvement</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = factor(data$Education), y = data$MonthlyIncome, fill = factor(data$JobInvolvement))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="monthly-income-by-education-and-jobrole" class="section level1">
<h1>Monthly Income by Education and jobrole</h1>
<pre class="r"><code>data %&gt;% ggplot(aes(x = factor(data$JobRole), y = data$MonthlyIncome, fill = factor(data$Education))) + geom_boxplot() + coord_flip()</code></pre>
<p><img src="CaseStudy2_Pengilly_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div id="end-eda" class="section level37">
<p>END EDA</p>
<div id="classification" class="section level43">
<p>CLASSIFICATION</p>
</div>
</div>
</div>
<div id="create-a-classification-algorithm-using-k-nn-or-naive-bayes" class="section level1">
<h1>Create a classification algorithm using K-NN or Naive-Bayes</h1>
</div>
<div id="import-libraries" class="section level1">
<h1>Import Libraries</h1>
<pre class="r"><code>library(e1071)
library(class)
library(caret)
library(mlbench)</code></pre>
<pre><code>## Warning: package &#39;mlbench&#39; was built under R version 3.6.3</code></pre>
</div>
<div id="reset-data-and-check-for-missing-values" class="section level1">
<h1>Reset data and check for missing values</h1>
<pre class="r"><code>data = read.csv(&#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2-data.csv&#39;, header = T)
sum(is.na.data.frame(data))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="factorize-some-of-the-numeric-data" class="section level1">
<h1>Factorize some of the numeric data</h1>
<pre class="r"><code>data$Education = as.factor(data$Education)
data$EnvironmentSatisfaction = as.factor(data$EnvironmentSatisfaction)
data$JobInvolvement = as.factor(data$JobInvolvement)
data$JobLevel = as.factor(data$JobLevel)
data$JobSatisfaction = as.factor(data$JobSatisfaction)</code></pre>
</div>
<div id="split-training-data-into-training-and-test-sets-to-compare-models-will-train-on-full-training-set-later" class="section level1">
<h1>Split training data into training and test sets (to compare models, will train on full training set later)</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(data$Attrition)), round(.8*length(data$Attrition)))
trainData = data[trainIndices,]
testData = data[-trainIndices,]</code></pre>
<div id="naive-bayes-classifier" class="section level45">
<p>NAIVE-BAYES CLASSIFIER</p>
</div>
</div>
<div id="train-naive-bayes-classifier-on-traindata-using-only-variables-thought-to-be-significant-or-potentially-significant" class="section level1">
<h1>Train Naive-Bayes Classifier on trainData using only variables thought to be significant or potentially significant</h1>
</div>
<div id="this-uses-numeric-variables-for-some-factored-numeric-data" class="section level1">
<h1>This uses Numeric variables for some factored numeric data</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24:27, 29:36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24:27, 29:36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  129   9
##   Yes  15  21
##                                           
##                Accuracy : 0.8621          
##                  95% CI : (0.8018, 0.9096)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.1335          
##                                           
##                   Kappa : 0.5521          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.3074          
##                                           
##             Sensitivity : 0.8958          
##             Specificity : 0.7000          
##          Pos Pred Value : 0.9348          
##          Neg Pred Value : 0.5833          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7414          
##    Detection Prevalence : 0.7931          
##       Balanced Accuracy : 0.7979          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="iteratively-remove-variables-using-backward-elimination" class="section level1">
<h1>Iteratively Remove variables using backward elimination</h1>
</div>
<div id="remove-percentsalhike-25" class="section level1">
<h1>Remove PercentSalHike (25)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 29:36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 29:36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  129   9
##   Yes  15  21
##                                           
##                Accuracy : 0.8621          
##                  95% CI : (0.8018, 0.9096)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.1335          
##                                           
##                   Kappa : 0.5521          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.3074          
##                                           
##             Sensitivity : 0.8958          
##             Specificity : 0.7000          
##          Pos Pred Value : 0.9348          
##          Neg Pred Value : 0.5833          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7414          
##    Detection Prevalence : 0.7931          
##       Balanced Accuracy : 0.7979          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-stockopts-29" class="section level1">
<h1>Remove StockOpts (29)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 30:36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 30:36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  129   9
##   Yes  15  21
##                                           
##                Accuracy : 0.8621          
##                  95% CI : (0.8018, 0.9096)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.1335          
##                                           
##                   Kappa : 0.5521          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.3074          
##                                           
##             Sensitivity : 0.8958          
##             Specificity : 0.7000          
##          Pos Pred Value : 0.9348          
##          Neg Pred Value : 0.5833          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7414          
##    Detection Prevalence : 0.7931          
##       Balanced Accuracy : 0.7979          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-yearssincepromotion-35" class="section level1">
<h1>Remove YearssincePromotion (35)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 30:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 30:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  129  10
##   Yes  15  20
##                                           
##                Accuracy : 0.8563          
##                  95% CI : (0.7952, 0.9048)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.1842          
##                                           
##                   Kappa : 0.5277          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.4237          
##                                           
##             Sensitivity : 0.8958          
##             Specificity : 0.6667          
##          Pos Pred Value : 0.9281          
##          Neg Pred Value : 0.5714          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7414          
##    Detection Prevalence : 0.7989          
##       Balanced Accuracy : 0.7812          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-trainingtimes-31" class="section level1">
<h1>Remove Trainingtimes (31)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 26:27, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 26:27, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  127  10
##   Yes  17  20
##                                           
##                Accuracy : 0.8448          
##                  95% CI : (0.7823, 0.8952)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.3139          
##                                           
##                   Kappa : 0.5022          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.2482          
##                                           
##             Sensitivity : 0.8819          
##             Specificity : 0.6667          
##          Pos Pred Value : 0.9270          
##          Neg Pred Value : 0.5405          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7299          
##    Detection Prevalence : 0.7874          
##       Balanced Accuracy : 0.7743          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-perfrating-26" class="section level1">
<h1>Remove PerfRating (26)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:22, 24, 27, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:22, 24, 27, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  126  10
##   Yes  18  20
##                                           
##                Accuracy : 0.8391          
##                  95% CI : (0.7759, 0.8903)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.3894          
##                                           
##                   Kappa : 0.4899          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.1859          
##                                           
##             Sensitivity : 0.8750          
##             Specificity : 0.6667          
##          Pos Pred Value : 0.9265          
##          Neg Pred Value : 0.5263          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7241          
##    Detection Prevalence : 0.7816          
##       Balanced Accuracy : 0.7708          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-joblevel-16" class="section level1">
<h1>Remove JobLevel (16)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:15, 17:22, 24, 27, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:15, 17:22, 24, 27, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  130  11
##   Yes  14  19
##                                           
##                Accuracy : 0.8563          
##                  95% CI : (0.7952, 0.9048)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.1842          
##                                           
##                   Kappa : 0.5157          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.6892          
##                                           
##             Sensitivity : 0.9028          
##             Specificity : 0.6333          
##          Pos Pred Value : 0.9220          
##          Neg Pred Value : 0.5758          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7471          
##    Detection Prevalence : 0.8103          
##       Balanced Accuracy : 0.7681          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-relsatis-27" class="section level1">
<h1>Remove RelSatis (27)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4:9, 12:15, 17:22, 24, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4:9, 12:15, 17:22, 24, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  131  11
##   Yes  13  19
##                                           
##                Accuracy : 0.8621          
##                  95% CI : (0.8018, 0.9096)
##     No Information Rate : 0.8276          
##     P-Value [Acc &gt; NIR] : 0.1335          
##                                           
##                   Kappa : 0.5291          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.8383          
##                                           
##             Sensitivity : 0.9097          
##             Specificity : 0.6333          
##          Pos Pred Value : 0.9225          
##          Neg Pred Value : 0.5938          
##              Prevalence : 0.8276          
##          Detection Rate : 0.7529          
##    Detection Prevalence : 0.8161          
##       Balanced Accuracy : 0.7715          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
</div>
<div id="remove-daily-rate-5" class="section level1">
<h1>Remove Daily Rate (5)</h1>
<pre class="r"><code>model = naiveBayes(x = trainData[c(2, 4, 6:9, 12:15, 17:22, 24, 30, 32:34, 36)], trainData$Attrition)
CM = confusionMatrix(table(predict(model, testData[,c(2, 4, 6:9, 12:15, 17:22, 24, 30, 32:34, 36)]), testData$Attrition))
CM</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      
##        No Yes
##   No  133  11
##   Yes  11  19
##                                          
##                Accuracy : 0.8736         
##                  95% CI : (0.8149, 0.919)
##     No Information Rate : 0.8276         
##     P-Value [Acc &gt; NIR] : 0.06204        
##                                          
##                   Kappa : 0.5569         
##                                          
##  Mcnemar&#39;s Test P-Value : 1.00000        
##                                          
##             Sensitivity : 0.9236         
##             Specificity : 0.6333         
##          Pos Pred Value : 0.9236         
##          Neg Pred Value : 0.6333         
##              Prevalence : 0.8276         
##          Detection Rate : 0.7644         
##    Detection Prevalence : 0.8276         
##       Balanced Accuracy : 0.7785         
##                                          
##        &#39;Positive&#39; Class : No             
## </code></pre>
</div>
<div id="experiment-with-derived-features" class="section level1">
<h1>Experiment with derived features</h1>
<pre class="r"><code>derived_data = data

derived_data$PerformanceRating = as.numeric(derived_data$PerformanceRating)
derived_data$Education = as.numeric(derived_data$Education)
derived_data$JobLevel = as.numeric(derived_data$JobLevel)

#37
derived_data$PerformancePromotion = derived_data$PerformanceRating * derived_data$YearsSinceLastPromotion
#38
derived_data$Potential = derived_data$Education * derived_data$JobLevel
#39
derived_data$YearsatCoinRole = derived_data$YearsAtCompany * derived_data$YearsInCurrentRole
#40 
derived_data$GoodManager = derived_data$RelationshipSatisfaction * derived_data$YearsWithCurrManager</code></pre>
</div>
<div id="create-train-test-split-with-new-derived-data-set" class="section level1">
<h1>Create Train / Test Split with new derived data set</h1>
<pre class="r"><code>derived_train = derived_data[trainIndices,]
derived_test = derived_data[-trainIndices,]</code></pre>
<div id="final-naive-bayes-model" class="section level3">
<h3>Final Naive-Bayes Model</h3>
</div>
<div id="included-derived-features" class="section level2">
<h2>Included derived features</h2>
</div>
</div>
<div id="create-a-loop-to-resample-data-with-new-seed-100-times-and-get-average-acc-sens-spec" class="section level1">
<h1>Create a loop to resample data with new seed 100 times and get average acc, sens, spec</h1>
<pre class="r"><code>accuracy = c(500)
sensitivity = c(500)
specificity = c(500)
seeds = sample(0:10000, 500, replace = FALSE)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
  trainSet = derived_data[trainIndices,]
  testSet = derived_data[-trainIndices,]
  
  final_class_model = naiveBayes(x = trainSet[c(2, 4, 6, 7, 9, 12:15, 17:22, 24, 30, 32:34, 36, 38, 39)], trainSet$Attrition)
  CM = confusionMatrix(table(predict(final_class_model, testSet[,c(2, 4, 6, 7, 9, 12:15, 17:22, 24, 30, 32:34, 36, 38, 39)]), testSet$Attrition))
  accuracy[i] = CM$overall[1]
  sensitivity[i] = CM$byClass[1]
  specificity[i] = CM$byClass[2]
  
  i = i + 1
}

avg_acc = mean(accuracy)
avg_sen = mean(sensitivity)
avg_spec = mean(specificity)

cat(&#39;The average accuracy is: &#39;, avg_acc, &#39;\n&#39;)</code></pre>
<pre><code>## The average accuracy is:  0.8001839</code></pre>
<pre class="r"><code>cat(&#39;The average sensitivity is: &#39;, avg_sen, &#39;\n&#39;)</code></pre>
<pre><code>## The average sensitivity is:  0.8345638</code></pre>
<pre class="r"><code>cat(&#39;The average specificity is: &#39;, avg_spec, &#39;\n&#39;)</code></pre>
<pre><code>## The average specificity is:  0.6230426</code></pre>
</div>
<div id="using-the-above-model-best-so-far-output-model-performance-and-parameter-estimates-to-determine-the-most-significant-factors" class="section level1">
<h1>Using the above model (best so far), output model performance and parameter estimates to determine the most significant factors</h1>
<pre class="r"><code>final_class_model.summary = summary(final_class_model)
final_class_model$tables</code></pre>
<pre><code>## $Age
##                   Age
## trainSet$Attrition     [,1]     [,2]
##                No  37.55973 8.738207
##                Yes 33.70000 9.275152
## 
## $BusinessTravel
##                   BusinessTravel
## trainSet$Attrition Non-Travel Travel_Frequently Travel_Rarely
##                No  0.11092150        0.15529010    0.73378840
##                Yes 0.06363636        0.23636364    0.70000000
## 
## $Department
##                   Department
## trainSet$Attrition Human Resources Research &amp; Development      Sales
##                No       0.04095563             0.67235495 0.28668942
##                Yes      0.03636364             0.52727273 0.43636364
## 
## $DistanceFromHome
##                   DistanceFromHome
## trainSet$Attrition      [,1]     [,2]
##                No   9.051195 8.015633
##                Yes 11.209091 8.822506
## 
## $EducationField
##                   EducationField
## trainSet$Attrition Human Resources Life Sciences  Marketing    Medical
##                No       0.01877133    0.41638225 0.10580205 0.32252560
##                Yes      0.03636364    0.34545455 0.15454545 0.28181818
##                   EducationField
## trainSet$Attrition      Other Technical Degree
##                No  0.05290102       0.08361775
##                Yes 0.06363636       0.11818182
## 
## $EnvironmentSatisfaction
##                   EnvironmentSatisfaction
## trainSet$Attrition         1         2         3         4
##                No  0.1843003 0.1996587 0.3105802 0.3054608
##                Yes 0.3000000 0.1818182 0.2545455 0.2636364
## 
## $Gender
##                   Gender
## trainSet$Attrition    Female      Male
##                No  0.4215017 0.5784983
##                Yes 0.3545455 0.6454545
## 
## $HourlyRate
##                   HourlyRate
## trainSet$Attrition     [,1]     [,2]
##                No  65.47611 20.25690
##                Yes 67.39091 19.42858
## 
## $JobInvolvement
##                   JobInvolvement
## trainSet$Attrition          1          2          3          4
##                No  0.02901024 0.25767918 0.61092150 0.10238908
##                Yes 0.15454545 0.29090909 0.50000000 0.05454545
## 
## $JobRole
##                   JobRole
## trainSet$Attrition Healthcare Representative Human Resources
##                No                0.092150171     0.027303754
##                Yes               0.054545455     0.036363636
##                   JobRole
## trainSet$Attrition Laboratory Technician     Manager Manufacturing Director
##                No            0.165529010 0.073378840            0.117747440
##                Yes           0.227272727 0.018181818            0.018181818
##                   JobRole
## trainSet$Attrition Research Director Research Scientist Sales Executive
##                No        0.078498294        0.187713311     0.215017065
##                Yes       0.009090909        0.218181818     0.236363636
##                   JobRole
## trainSet$Attrition Sales Representative
##                No           0.042662116
##                Yes          0.181818182
## 
## $JobSatisfaction
##                   JobSatisfaction
## trainSet$Attrition         1         2         3         4
##                No  0.2013652 0.1877133 0.2849829 0.3259386
##                Yes 0.3090909 0.2272727 0.3000000 0.1636364
## 
## $MaritalStatus
##                   MaritalStatus
## trainSet$Attrition   Divorced    Married     Single
##                No  0.24061433 0.48634812 0.27303754
##                Yes 0.08181818 0.40000000 0.51818182
## 
## $MonthlyIncome
##                   MonthlyIncome
## trainSet$Attrition     [,1]     [,2]
##                No  6904.720 4840.257
##                Yes 4649.073 3696.431
## 
## $MonthlyRate
##                   MonthlyRate
## trainSet$Attrition     [,1]     [,2]
##                No  14568.42 7028.286
##                Yes 13242.12 6952.154
## 
## $NumCompaniesWorked
##                   NumCompaniesWorked
## trainSet$Attrition     [,1]     [,2]
##                No  2.716724 2.496143
##                Yes 3.181818 2.776645
## 
## $OverTime
##                   OverTime
## trainSet$Attrition        No       Yes
##                No  0.7627986 0.2372014
##                Yes 0.4000000 0.6000000
## 
## $TotalWorkingYears
##                   TotalWorkingYears
## trainSet$Attrition      [,1]     [,2]
##                No  11.901024 7.725002
##                Yes  8.281818 7.407078
## 
## $WorkLifeBalance
##                   WorkLifeBalance
## trainSet$Attrition     [,1]      [,2]
##                No  2.813993 0.6827862
##                Yes 2.663636 0.8380545
## 
## $YearsAtCompany
##                   YearsAtCompany
## trainSet$Attrition     [,1]     [,2]
##                No  7.354949 6.052784
##                Yes 5.136364 6.554608
## 
## $YearsInCurrentRole
##                   YearsInCurrentRole
## trainSet$Attrition     [,1]     [,2]
##                No  4.465870 3.601476
##                Yes 3.018182 3.514013
## 
## $YearsWithCurrManager
##                   YearsWithCurrManager
## trainSet$Attrition     [,1]     [,2]
##                No  4.380546 3.553772
##                Yes 2.800000 3.233426
## 
## $Potential
##                   Potential
## trainSet$Attrition     [,1]     [,2]
##                No  6.447099 4.379997
##                Yes 4.454545 3.198728
## 
## $YearsatCoinRole
##                   YearsatCoinRole
## trainSet$Attrition     [,1]     [,2]
##                No  49.66894 69.25197
##                Yes 34.60000 74.82165</code></pre>
<div id="logistic-regression-classifier" class="section level43">
<p>LOGISTIC REGRESSION CLASSIFIER</p>
</div>
</div>
<div id="load-libraries-for-logistic-regression" class="section level1">
<h1>Load libraries for logistic regression</h1>
<pre class="r"><code>library(ISLR)
library(gridExtra)</code></pre>
</div>
<div id="experiment-with-additional-derived-features-for-logistic-regression-analysis" class="section level1">
<h1>Experiment with additional derived features for logistic regression analysis</h1>
<pre class="r"><code>derived_data = data
derived_data$PerformanceRating = as.numeric(derived_data$PerformanceRating)
derived_data$Education = as.numeric(derived_data$Education)
derived_data$JobLevel = as.numeric(derived_data$JobLevel)

#37
derived_data$PerformancePromotion = derived_data$PerformanceRating * derived_data$YearsSinceLastPromotion
#38
derived_data$Potential = derived_data$Education * derived_data$JobLevel
#39
derived_data$YearsatCoinRole = derived_data$YearsAtCompany * derived_data$YearsInCurrentRole
#40 
derived_data$GoodManager = as.numeric(derived_data$RelationshipSatisfaction) * derived_data$YearsWithCurrManager
#41 
derived_data$BinOver = as.numeric(ifelse(derived_data$OverTime == &#39;Yes&#39;, 1, 0))
#42
derived_data$EnvOver = derived_data$BinOver * as.numeric(derived_data$EnvironmentSatisfaction)</code></pre>
</div>
<div id="cast-factored-numeric-data-as-numeric" class="section level1">
<h1>Cast factored numeric data as numeric</h1>
<pre class="r"><code>derived_data$EnvironmentSatisfaction = as.numeric(derived_data$EnvironmentSatisfaction)
derived_data$JobSatisfaction = as.numeric(derived_data$JobSatisfaction)
derived_data$JobInvolvement = as.numeric(derived_data$JobInvolvement)
derived_data$PerformanceRating = as.numeric(derived_data$PerformanceRating)
derived_data$RelationshipSatisfaction = as.numeric(derived_data$RelationshipSatisfaction)
derived_data$Education = as.numeric(derived_data$Education)</code></pre>
</div>
<div id="standardize-data-for-logistic-regression" class="section level1">
<h1>Standardize data for logistic regression</h1>
<pre class="r"><code>standard_data = standardize(formula = Attrition ~ Age + BusinessTravel + DistanceFromHome + 
                                   EnvironmentSatisfaction + HourlyRate + JobInvolvement + JobSatisfaction +
                                   MaritalStatus + NumCompaniesWorked + OverTime + 
                                   RelationshipSatisfaction + TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany +
                                   WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager + 
                                   YearsatCoinRole + JobRole + JobLevel + Potential + Education + Gender + MonthlyRate + DailyRate +
                                   PerformanceRating + MonthlyIncome + PerformancePromotion + EducationField + Department + PercentSalaryHike +
                                   StockOptionLevel + GoodManager + EnvOver -1, data = derived_data, family = binomial(link = &#39;logit&#39;))</code></pre>
</div>
<div id="add-categorical-data-back-into-standardized-data-frame" class="section level1">
<h1>Add categorical data back into standardized data frame</h1>
<pre class="r"><code>standardized = data.frame(&#39;Attrition&#39; = standard_data$data$Attrition, &#39;Age&#39; = standard_data$data$Age, 
                          &#39;BusinessTravel&#39; = derived_data$BusinessTravel, &#39;DistanceFromHome&#39; = standard_data$data$DistanceFromHome,
                          &#39;EnvironmentSatisfaction&#39;= standard_data$data$EnvironmentSatisfaction, &#39;HourlyRate&#39;= standard_data$data$HourlyRate, 
                          &#39;JobInvolvement&#39; = standard_data$data$JobInvolvement, &#39;JobSatisfaction&#39;= standard_data$data$JobSatisfaction,
                          &#39;MaritalStatus&#39; = derived_data$MaritalStatus, &#39;NumCompaniesWorked&#39;= standard_data$data$NumCompaniesWorked,
                          &#39;OverTime&#39; = derived_data$OverTime, &#39;RelationshipSatisfaction&#39;= standard_data$data$RelationshipSatisfaction,
                          &#39;TotalWorkingYears&#39;= standard_data$data$TotalWorkingYears, 
                          &#39;TrainingTimesLastYear&#39;= standard_data$data$TrainingTimesLastYear, &#39;WorkLifeBalance&#39; = standard_data$data$WorkLifeBalance,
                          &#39;YearsAtCompany&#39; = standard_data$data$YearsAtCompany,
                          &#39;YearsInCurrentRole&#39;= standard_data$data$YearsInCurrentRole, 
                          &#39;YearsSinceLastPromotion&#39;= standard_data$data$YearsSinceLastPromotion, 
                          &#39;YearsWithCurrManager&#39;= standard_data$data$YearsWithCurrManager, &#39;YearsatCoinRole&#39;= standard_data$data$YearsatCoinRole,
                          &#39;JobRole&#39;= derived_data$JobRole, &#39;JobLevel&#39; = standard_data$data$JobLevel, &#39;Potential&#39; = standard_data$data$Potential,
                          &#39;Education&#39; = standard_data$data$Education, &#39;Gender&#39; = derived_data$Gender, 
                          &#39;MonthlyRate&#39; = standard_data$data$MonthlyRate, &#39;DailyRate&#39; = standard_data$data$DailyRate,
                          &#39;PerformanceRating&#39;= standard_data$data$PerformanceRating, &#39;MonthlyIncome&#39;= standard_data$data$MonthlyIncome, 
                          &#39;PerformancePromotion&#39;= standard_data$data$PerformancePromotion, &#39;EducationField&#39;= derived_data$EducationField, 
                          &#39;Department&#39;= derived_data$Department, &#39;PercentSalaryHike&#39;= standard_data$data$PercentSalaryHike,
                          &#39;StockOptionLevel&#39;= standard_data$data$StockOptionLevel, &#39;GoodManager&#39; = standard_data$data$GoodManager, 
                          &#39;EnvOver&#39; = standard_data$data$EnvOver)</code></pre>
</div>
<div id="determine-which-variables-are-correlated.-remove-if-correlation-0.5" class="section level1">
<h1>Determine which variables are correlated. Remove if correlation &gt; 0.5</h1>
<pre class="r"><code>correlationMatrix &lt;- cor(standardized[,c(2, 4:8, 10, 12:20, 22:24, 26, 27, 29, 30, 33:36)])

highlyCorrelated &lt;- findCorrelation(correlationMatrix, cutoff = 0.5)
print(highlyCorrelated)</code></pre>
<pre><code>## [1] 12  9 16 17 13 22 18 15 14</code></pre>
<pre class="r"><code>print(correlationMatrix)</code></pre>
<pre><code>##                                   Age DistanceFromHome EnvironmentSatisfaction
## Age                       1.000000000      0.006647112           -7.449882e-03
## DistanceFromHome          0.006647112      1.000000000           -3.870075e-02
## EnvironmentSatisfaction  -0.007449882     -0.038700752            1.000000e+00
## HourlyRate                0.052328259      0.067040911           -3.418928e-02
## JobInvolvement            0.016073296     -0.004277505           -3.419785e-05
## JobSatisfaction          -0.022363414     -0.021218476           -1.841649e-02
## NumCompaniesWorked        0.293521877     -0.048909244            1.294575e-02
## RelationshipSatisfaction -0.005340777      0.036234469            4.550669e-03
## TotalWorkingYears         0.652613137      0.004186191           -1.995653e-02
## TrainingTimesLastYear    -0.045281792     -0.038949194           -1.450192e-02
## WorkLifeBalance          -0.012229885     -0.013820292            8.412080e-02
## YearsAtCompany            0.289538716     -0.020830094           -1.510054e-02
## YearsInCurrentRole        0.208349696     -0.008407782            2.249029e-02
## YearsSinceLastPromotion   0.217191680     -0.016595666            9.176822e-03
## YearsWithCurrManager      0.185383795     -0.017700612           -2.329230e-02
## YearsatCoinRole           0.273684204     -0.014858807            1.260086e-03
## JobLevel                  0.479423564      0.021727054            1.545152e-04
## Potential                 0.457160510      0.048761805           -3.059007e-02
## Education                 0.217290207      0.049512940           -3.652790e-02
## MonthlyRate               0.071740854     -0.007839039            5.927864e-02
## DailyRate                 0.012736692      0.014944536           -1.338386e-02
## MonthlyIncome             0.484288301     -0.006667155           -1.687744e-02
## PerformancePromotion      0.208467601     -0.015993994            4.844743e-03
## PercentSalaryHike        -0.030804192      0.054293690            1.139159e-03
## StockOptionLevel          0.044759576      0.071680428            3.028302e-02
## GoodManager               0.155829400      0.018035307           -1.853702e-02
## EnvOver                   0.015979904      0.054326588            2.707745e-01
##                             HourlyRate JobInvolvement JobSatisfaction
## Age                       5.232826e-02   1.607330e-02    -0.022363414
## DistanceFromHome          6.704091e-02  -4.277505e-03    -0.021218476
## EnvironmentSatisfaction  -3.418928e-02  -3.419785e-05    -0.018416488
## HourlyRate                1.000000e+00   7.036098e-02    -0.089040641
## JobInvolvement            7.036098e-02   1.000000e+00    -0.052949460
## JobSatisfaction          -8.904064e-02  -5.294946e-02     1.000000000
## NumCompaniesWorked        1.412012e-02  -5.613845e-03    -0.075753415
## RelationshipSatisfaction  1.537703e-02   1.685454e-02    -0.033860142
## TotalWorkingYears         2.947671e-02  -1.398641e-02    -0.049281026
## TrainingTimesLastYear     5.822839e-03  -2.241602e-02    -0.029577808
## WorkLifeBalance          -2.548651e-02   7.736011e-03    -0.026470304
## YearsAtCompany            4.990148e-05  -4.159642e-02     0.028363964
## YearsInCurrentRole        2.159320e-04   1.317048e-02    -0.003471690
## YearsSinceLastPromotion   8.053699e-03  -3.043052e-02    -0.021795589
## YearsWithCurrManager     -2.493375e-03   1.088728e-02     0.007359588
## YearsatCoinRole           1.418603e-02  -3.311681e-02     0.016605818
## JobLevel                 -8.070074e-03  -1.587505e-02    -0.050306065
## Potential                 2.285554e-03   1.190657e-02    -0.039344026
## Education                 6.750312e-03   3.225524e-02     0.013111079
## MonthlyRate              -1.603517e-02  -1.827518e-02     0.025139100
## DailyRate                 4.849597e-02   6.011801e-02    -0.002716745
## MonthlyIncome             2.391151e-03   4.473792e-04    -0.053148530
## PerformancePromotion      5.939831e-03  -2.223147e-02    -0.022921028
## PercentSalaryHike        -2.270814e-02   1.432785e-02     0.011967235
## StockOptionLevel          6.461446e-02   7.230297e-02    -0.008030339
## GoodManager               1.140587e-02   2.259161e-02    -0.002291812
## EnvOver                  -3.143698e-02  -2.208532e-02     0.029465654
##                          NumCompaniesWorked RelationshipSatisfaction
## Age                             0.293521877             -0.005340777
## DistanceFromHome               -0.048909244              0.036234469
## EnvironmentSatisfaction         0.012945750              0.004550669
## HourlyRate                      0.014120123              0.015377027
## JobInvolvement                 -0.005613845              0.016854535
## JobSatisfaction                -0.075753415             -0.033860142
## NumCompaniesWorked              1.000000000              0.042047644
## RelationshipSatisfaction        0.042047644              1.000000000
## TotalWorkingYears               0.258099959             -0.017575299
## TrainingTimesLastYear          -0.070591665              0.015752447
## WorkLifeBalance                 0.021316529              0.037105402
## YearsAtCompany                 -0.142025883              0.008377778
## YearsInCurrentRole             -0.103814233             -0.001097767
## YearsSinceLastPromotion        -0.071218393              0.032135460
## YearsWithCurrManager           -0.122974681             -0.016131001
## YearsatCoinRole                -0.102237354              0.017738692
## JobLevel                        0.140834828             -0.004820462
## Potential                       0.181187075             -0.009031528
## Education                       0.160918010             -0.025717762
## MonthlyRate                     0.016753747             -0.024004655
## DailyRate                       0.051559831              0.013643236
## MonthlyIncome                   0.155894318             -0.003884678
## PerformancePromotion           -0.076781988              0.031843058
## PercentSalaryHike              -0.022434259             -0.045721608
## StockOptionLevel                0.032887211             -0.032980838
## GoodManager                    -0.068311398              0.397221066
## EnvOver                        -0.004615721              0.023535064
##                          TotalWorkingYears TrainingTimesLastYear
## Age                            0.652613137          -0.045281792
## DistanceFromHome               0.004186191          -0.038949194
## EnvironmentSatisfaction       -0.019956530          -0.014501924
## HourlyRate                     0.029476711           0.005822839
## JobInvolvement                -0.013986410          -0.022416021
## JobSatisfaction               -0.049281026          -0.029577808
## NumCompaniesWorked             0.258099959          -0.070591665
## RelationshipSatisfaction      -0.017575299           0.015752447
## TotalWorkingYears              1.000000000          -0.041912467
## TrainingTimesLastYear         -0.041912467           1.000000000
## WorkLifeBalance                0.018724536           0.021735800
## YearsAtCompany                 0.636083586           0.020192712
## YearsInCurrentRole             0.486590295          -0.016429957
## YearsSinceLastPromotion        0.445838540          -0.042382617
## YearsWithCurrManager           0.461485375           0.003914247
## YearsatCoinRole                0.592099292           0.004733390
## JobLevel                       0.780752353          -0.045864316
## Potential                      0.663928921          -0.071040607
## Education                      0.146044538          -0.063134803
## MonthlyRate                    0.057889875          -0.013358464
## DailyRate                     -0.007402129          -0.010589800
## MonthlyIncome                  0.778511205          -0.039014567
## PerformancePromotion           0.436158482          -0.049678258
## PercentSalaryHike             -0.064304461           0.001525276
## StockOptionLevel               0.036235025           0.017341207
## GoodManager                    0.395269311           0.005006081
## EnvOver                       -0.026015625          -0.049930740
##                          WorkLifeBalance YearsAtCompany YearsInCurrentRole
## Age                         -0.012229885   2.895387e-01       0.2083496959
## DistanceFromHome            -0.013820292  -2.083009e-02      -0.0084077816
## EnvironmentSatisfaction      0.084120802  -1.510054e-02       0.0224902874
## HourlyRate                  -0.025486510   4.990148e-05       0.0002159320
## JobInvolvement               0.007736011  -4.159642e-02       0.0131704795
## JobSatisfaction             -0.026470304   2.836396e-02      -0.0034716898
## NumCompaniesWorked           0.021316529  -1.420259e-01      -0.1038142325
## RelationshipSatisfaction     0.037105402   8.377778e-03      -0.0010977668
## TotalWorkingYears            0.018724536   6.360836e-01       0.4865902950
## TrainingTimesLastYear        0.021735800   2.019271e-02      -0.0164299570
## WorkLifeBalance              1.000000000   2.947258e-02       0.0821049336
## YearsAtCompany               0.029472580   1.000000e+00       0.7761164180
## YearsInCurrentRole           0.082104934   7.761164e-01       1.0000000000
## YearsSinceLastPromotion      0.041653100   6.440298e-01       0.5537100485
## YearsWithCurrManager         0.018378039   7.652262e-01       0.7094612168
## YearsatCoinRole              0.076997849   8.868509e-01       0.8730029478
## JobLevel                     0.030283868   5.205835e-01       0.3913048192
## Potential                    0.028600905   4.086092e-01       0.3020069611
## Education                    0.009824289   6.197449e-02       0.0613816197
## MonthlyRate                  0.006510198  -1.803946e-02       0.0252185990
## DailyRate                   -0.029869221  -3.714277e-02      -0.0006759731
## MonthlyIncome                0.020804889   4.913790e-01       0.3618405206
## PerformancePromotion         0.045669102   6.342111e-01       0.5518384949
## PercentSalaryHike            0.007475735  -5.748031e-02      -0.0229356539
## StockOptionLevel             0.046998821   2.849091e-02       0.0809014903
## GoodManager                  0.046618250   6.577632e-01       0.5997600265
## EnvOver                      0.006499293  -1.820520e-02      -0.0216839356
##                          YearsSinceLastPromotion YearsWithCurrManager
## Age                                  0.217191680          0.185383795
## DistanceFromHome                    -0.016595666         -0.017700612
## EnvironmentSatisfaction              0.009176822         -0.023292298
## HourlyRate                           0.008053699         -0.002493375
## JobInvolvement                      -0.030430518          0.010887282
## JobSatisfaction                     -0.021795589          0.007359588
## NumCompaniesWorked                  -0.071218393         -0.122974681
## RelationshipSatisfaction             0.032135460         -0.016131001
## TotalWorkingYears                    0.445838540          0.461485375
## TrainingTimesLastYear               -0.042382617          0.003914247
## WorkLifeBalance                      0.041653100          0.018378039
## YearsAtCompany                       0.644029778          0.765226243
## YearsInCurrentRole                   0.553710048          0.709461217
## YearsSinceLastPromotion              1.000000000          0.508935431
## YearsWithCurrManager                 0.508935431          1.000000000
## YearsatCoinRole                      0.612666442          0.637439812
## JobLevel                             0.330435705          0.366567472
## Potential                            0.271272365          0.306603084
## Education                            0.068329974          0.088446276
## MonthlyRate                          0.007491151         -0.021310286
## DailyRate                           -0.058558731         -0.024346829
## MonthlyIncome                        0.315911576          0.328487453
## PerformancePromotion                 0.991687559          0.506022609
## PercentSalaryHike                   -0.074040285         -0.045232326
## StockOptionLevel                     0.012955322          0.036542574
## GoodManager                          0.453173111          0.845923908
## EnvOver                             -0.009981863         -0.057875794
##                          YearsatCoinRole      JobLevel    Potential
## Age                          0.273684204  0.4794235642  0.457160510
## DistanceFromHome            -0.014858807  0.0217270544  0.048761805
## EnvironmentSatisfaction      0.001260086  0.0001545152 -0.030590068
## HourlyRate                   0.014186033 -0.0080700744  0.002285554
## JobInvolvement              -0.033116809 -0.0158750522  0.011906568
## JobSatisfaction              0.016605818 -0.0503060650 -0.039344026
## NumCompaniesWorked          -0.102237354  0.1408348284  0.181187075
## RelationshipSatisfaction     0.017738692 -0.0048204622 -0.009031528
## TotalWorkingYears            0.592099292  0.7807523526  0.663928921
## TrainingTimesLastYear        0.004733390 -0.0458643163 -0.071040607
## WorkLifeBalance              0.076997849  0.0302838677  0.028600905
## YearsAtCompany               0.886850897  0.5205835070  0.408609205
## YearsInCurrentRole           0.873002948  0.3913048192  0.302006961
## YearsSinceLastPromotion      0.612666442  0.3304357051  0.271272365
## YearsWithCurrManager         0.637439812  0.3665674724  0.306603084
## YearsatCoinRole              1.000000000  0.4738319265  0.367063131
## JobLevel                     0.473831927  1.0000000000  0.831845133
## Potential                    0.367063131  0.8318451334  1.000000000
## Education                    0.050108011  0.1303859075  0.593402075
## MonthlyRate                  0.008372327  0.0744538290  0.047014918
## DailyRate                   -0.030298899  0.0018376264  0.012324827
## MonthlyIncome                0.456378847  0.9516400488  0.800150585
## PerformancePromotion         0.605473074  0.3212745642  0.260832053
## PercentSalaryHike           -0.038207773 -0.0622671489 -0.054946701
## StockOptionLevel             0.050889267  0.0188872312  0.021472702
## GoodManager                  0.554986362  0.3119767397  0.263907836
## EnvOver                     -0.001788085 -0.0156095369 -0.036360939
##                             Education  MonthlyRate     DailyRate MonthlyIncome
## Age                       0.217290207  0.071740854  1.273669e-02  4.842883e-01
## DistanceFromHome          0.049512940 -0.007839039  1.494454e-02 -6.667155e-03
## EnvironmentSatisfaction  -0.036527898  0.059278643 -1.338386e-02 -1.687744e-02
## HourlyRate                0.006750312 -0.016035168  4.849597e-02  2.391151e-03
## JobInvolvement            0.032255238 -0.018275178  6.011801e-02  4.473792e-04
## JobSatisfaction           0.013111079  0.025139100 -2.716745e-03 -5.314853e-02
## NumCompaniesWorked        0.160918010  0.016753747  5.155983e-02  1.558943e-01
## RelationshipSatisfaction -0.025717762 -0.024004655  1.364324e-02 -3.884678e-03
## TotalWorkingYears         0.146044538  0.057889875 -7.402129e-03  7.785112e-01
## TrainingTimesLastYear    -0.063134803 -0.013358464 -1.058980e-02 -3.901457e-02
## WorkLifeBalance           0.009824289  0.006510198 -2.986922e-02  2.080489e-02
## YearsAtCompany            0.061974487 -0.018039461 -3.714277e-02  4.913790e-01
## YearsInCurrentRole        0.061381620  0.025218599 -6.759731e-04  3.618405e-01
## YearsSinceLastPromotion   0.068329974  0.007491151 -5.855873e-02  3.159116e-01
## YearsWithCurrManager      0.088446276 -0.021310286 -2.434683e-02  3.284875e-01
## YearsatCoinRole           0.050108011  0.008372327 -3.029890e-02  4.563788e-01
## JobLevel                  0.130385908  0.074453829  1.837626e-03  9.516400e-01
## Potential                 0.593402075  0.047014918  1.232483e-02  8.001506e-01
## Education                 1.000000000 -0.020183862 -1.453569e-02  1.271314e-01
## MonthlyRate              -0.020183862  1.000000000 -2.764077e-02  6.459407e-02
## DailyRate                -0.014535694 -0.027640771  1.000000e+00  8.790339e-05
## MonthlyIncome             0.127131394  0.064594067  8.790339e-05  1.000000e+00
## PerformancePromotion      0.060710483  0.002683928 -6.241501e-02  3.061470e-01
## PercentSalaryHike        -0.002387120  0.001642760  2.787530e-02 -5.386594e-02
## StockOptionLevel          0.030706874 -0.036521825  2.358864e-02  1.888872e-02
## GoodManager               0.073332636 -0.044140150 -1.018722e-02  2.850042e-01
## EnvOver                  -0.039442966  0.020088262  8.316250e-03 -2.318921e-02
##                          PerformancePromotion PercentSalaryHike
## Age                               0.208467601      -0.030804192
## DistanceFromHome                 -0.015993994       0.054293690
## EnvironmentSatisfaction           0.004844743       0.001139159
## HourlyRate                        0.005939831      -0.022708145
## JobInvolvement                   -0.022231473       0.014327853
## JobSatisfaction                  -0.022921028       0.011967235
## NumCompaniesWorked               -0.076781988      -0.022434259
## RelationshipSatisfaction          0.031843058      -0.045721608
## TotalWorkingYears                 0.436158482      -0.064304461
## TrainingTimesLastYear            -0.049678258       0.001525276
## WorkLifeBalance                   0.045669102       0.007475735
## YearsAtCompany                    0.634211093      -0.057480309
## YearsInCurrentRole                0.551838495      -0.022935654
## YearsSinceLastPromotion           0.991687559      -0.074040285
## YearsWithCurrManager              0.506022609      -0.045232326
## YearsatCoinRole                   0.605473074      -0.038207773
## JobLevel                          0.321274564      -0.062267149
## Potential                         0.260832053      -0.054946701
## Education                         0.060710483      -0.002387120
## MonthlyRate                       0.002683928       0.001642760
## DailyRate                        -0.062415014       0.027875304
## MonthlyIncome                     0.306146984      -0.053865939
## PerformancePromotion              1.000000000      -0.014713883
## PercentSalaryHike                -0.014713883       1.000000000
## StockOptionLevel                  0.014729747      -0.004891114
## GoodManager                       0.452197558      -0.047658956
## EnvOver                          -0.009695530      -0.001030365
##                          StockOptionLevel  GoodManager       EnvOver
## Age                          4.475958e-02  0.155829400  1.597990e-02
## DistanceFromHome             7.168043e-02  0.018035307  5.432659e-02
## EnvironmentSatisfaction      3.028302e-02 -0.018537016  2.707745e-01
## HourlyRate                   6.461446e-02  0.011405869 -3.143698e-02
## JobInvolvement               7.230297e-02  0.022591613 -2.208532e-02
## JobSatisfaction             -8.030339e-03 -0.002291812  2.946565e-02
## NumCompaniesWorked           3.288721e-02 -0.068311398 -4.615721e-03
## RelationshipSatisfaction    -3.298084e-02  0.397221066  2.353506e-02
## TotalWorkingYears            3.623502e-02  0.395269311 -2.601562e-02
## TrainingTimesLastYear        1.734121e-02  0.005006081 -4.993074e-02
## WorkLifeBalance              4.699882e-02  0.046618250  6.499293e-03
## YearsAtCompany               2.849091e-02  0.657763224 -1.820520e-02
## YearsInCurrentRole           8.090149e-02  0.599760026 -2.168394e-02
## YearsSinceLastPromotion      1.295532e-02  0.453173111 -9.981863e-03
## YearsWithCurrManager         3.654257e-02  0.845923908 -5.787579e-02
## YearsatCoinRole              5.088927e-02  0.554986362 -1.788085e-03
## JobLevel                     1.888723e-02  0.311976740 -1.560954e-02
## Potential                    2.147270e-02  0.263907836 -3.636094e-02
## Education                    3.070687e-02  0.073332636 -3.944297e-02
## MonthlyRate                 -3.652183e-02 -0.044140150  2.008826e-02
## DailyRate                    2.358864e-02 -0.010187222  8.316250e-03
## MonthlyIncome                1.888872e-02  0.285004211 -2.318921e-02
## PerformancePromotion         1.472975e-02  0.452197558 -9.695530e-03
## PercentSalaryHike           -4.891114e-03 -0.047658956 -1.030365e-03
## StockOptionLevel             1.000000e+00  0.030883080 -6.619217e-06
## GoodManager                  3.088308e-02  1.000000000 -3.752610e-02
## EnvOver                     -6.619217e-06 -0.037526104  1.000000e+00</code></pre>
</div>
<div id="remove-correlated-variables" class="section level1">
<h1>Remove Correlated variables</h1>
<pre class="r"><code>reducedStandardized = standardized[, c(1, 3:15, 17, 21, 22, 24:29, 31:34, 36)]</code></pre>
<div id="section-3" class="section level7">
<p></p>
</div>
</div>
<div id="create-training-and-test-sets-dont-use" class="section level1">
<h1>Create training and test sets # Don’t use</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
trainSet = reducedStandardized[trainIndices,]
testSet = reducedStandardized[-trainIndices,]</code></pre>
<div id="section-4" class="section level6">
<h6></h6>
</div>
</div>
<div id="create-training-and-test-sets" class="section level1">
<h1>Create training and test sets</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
trainSet = standardized[trainIndices,]
testSet = standardized[-trainIndices,]</code></pre>
</div>
<div id="train-and-test-logistic-regression-model-and-output-its-performance-metrics.-this-model-is-capable-of-ascertaining-the-statistical-significance-of-the-relationships." class="section level1">
<h1>Train and test logistic regression model and output its performance metrics. This model is capable of ascertaining the statistical significance of the relationships.</h1>
</div>
<div id="full-model" class="section level1">
<h1>FULL MODEL</h1>
<pre class="r"><code>logistic_regression_model = glm(Attrition ~ Age + BusinessTravel + DailyRate + Department + DistanceFromHome + Education + 
                                EducationField + Gender + EnvironmentSatisfaction + HourlyRate + JobInvolvement + JobLevel + JobRole +
                                JobSatisfaction + MaritalStatus + MonthlyIncome + MonthlyRate + NumCompaniesWorked + OverTime + 
                                PercentSalaryHike + PerformanceRating + RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + 
                                TrainingTimesLastYear + YearsAtCompany + WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion +
                                YearsWithCurrManager + Potential + YearsatCoinRole + PerformancePromotion + GoodManager + EnvOver -1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)</code></pre>
<pre><code>## Warning: contrasts dropped from factor PerformanceRating</code></pre>
<pre class="r"><code>summary(logistic_regression_model)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Attrition ~ Age + BusinessTravel + DailyRate + 
##     Department + DistanceFromHome + Education + EducationField + 
##     Gender + EnvironmentSatisfaction + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + JobSatisfaction + MaritalStatus + MonthlyIncome + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     PerformanceRating + RelationshipSatisfaction + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager + Potential + YearsatCoinRole + PerformancePromotion + 
##     GoodManager + EnvOver - 1, family = binomial(link = &quot;logit&quot;), 
##     data = standardized)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5766  -0.4361  -0.1769  -0.0444   3.4535  
## 
## Coefficients:
##                                   Estimate Std. Error z value Pr(&gt;|z|)    
## Age                               -0.24610    0.17144  -1.436 0.151134    
## BusinessTravelNon-Travel         -16.88124  721.54625  -0.023 0.981334    
## BusinessTravelTravel_Frequently  -15.12126  721.54604  -0.021 0.983280    
## BusinessTravelTravel_Rarely      -15.99073  721.54608  -0.022 0.982319    
## DailyRate                         -0.13024    0.13018  -1.000 0.317098    
## DepartmentResearch &amp; Development  11.73262  721.54476   0.016 0.987027    
## DepartmentSales                   12.08711  721.54458   0.017 0.986635    
## DistanceFromHome                   0.43297    0.12616   3.432 0.000599 ***
## Education                          0.35157    0.26059   1.349 0.177290    
## EducationFieldLife Sciences       -1.01360    1.26380  -0.802 0.422538    
## EducationFieldMarketing           -1.09025    1.32201  -0.825 0.409546    
## EducationFieldMedical             -0.81567    1.25887  -0.648 0.517025    
## EducationFieldOther               -0.73904    1.32169  -0.559 0.576049    
## EducationFieldTechnical Degree    -0.20041    1.29968  -0.154 0.877450    
## GenderMale                         0.27319    0.26008   1.050 0.293533    
## EnvironmentSatisfaction           -0.35279    0.17435  -2.023 0.043030 *  
## HourlyRate                         0.23283    0.13262   1.756 0.079165 .  
## JobInvolvement                    -0.60464    0.12494  -4.840 1.30e-06 ***
## JobLevel                           0.56554    0.63890   0.885 0.376064    
## JobRoleHuman Resources            13.06540  721.54535   0.018 0.985553    
## JobRoleLaboratory Technician       1.02502    0.62954   1.628 0.103484    
## JobRoleManager                    -1.33640    1.32386  -1.009 0.312748    
## JobRoleManufacturing Director     -2.09870    0.93835  -2.237 0.025313 *  
## JobRoleResearch Director          -2.40307    1.40176  -1.714 0.086470 .  
## JobRoleResearch Scientist          0.43876    0.63365   0.692 0.488668    
## JobRoleSales Executive             0.53229    1.40672   0.378 0.705140    
## JobRoleSales Representative        1.88142    1.47494   1.276 0.202098    
## JobSatisfaction                   -0.59999    0.13246  -4.530 5.91e-06 ***
## MaritalStatusMarried               0.95937    0.43307   2.215 0.026741 *  
## MaritalStatusSingle                1.92360    0.53361   3.605 0.000312 ***
## MonthlyIncome                      0.54641    0.57156   0.956 0.339072    
## MonthlyRate                       -0.11614    0.12930  -0.898 0.369059    
## NumCompaniesWorked                 0.64159    0.14797   4.336 1.45e-05 ***
## OverTimeYes                        2.51288    0.67086   3.746 0.000180 ***
## PercentSalaryHike                 -0.16083    0.20850  -0.771 0.440503    
## PerformanceRating3                -0.38022    0.30655  -1.240 0.214855    
## RelationshipSatisfaction          -0.42864    0.18057  -2.374 0.017605 *  
## StockOptionLevel                  -0.04602    0.18274  -0.252 0.801181    
## TotalWorkingYears                 -1.00960    0.33255  -3.036 0.002398 ** 
## TrainingTimesLastYear             -0.40064    0.13945  -2.873 0.004067 ** 
## YearsAtCompany                    -0.60485    0.40480  -1.494 0.135127    
## WorkLifeBalance                   -0.49903    0.12944  -3.855 0.000116 ***
## YearsInCurrentRole                -1.40000    0.31328  -4.469 7.87e-06 ***
## YearsSinceLastPromotion            1.54226    1.16438   1.325 0.185325    
## YearsWithCurrManager              -0.46760    0.42600  -1.098 0.272362    
## Potential                         -0.83083    0.50989  -1.629 0.103221    
## YearsatCoinRole                    1.87677    0.39696   4.728 2.27e-06 ***
## PerformancePromotion              -0.76189    1.15314  -0.661 0.508799    
## GoodManager                        0.40442    0.38715   1.045 0.296206    
## EnvOver                           -0.19052    0.32544  -0.585 0.558274    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1206.08  on 870  degrees of freedom
## Residual deviance:  443.59  on 820  degrees of freedom
## AIC: 543.59
## 
## Number of Fisher Scoring iterations: 15</code></pre>
<pre class="r"><code>fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)</code></pre>
<pre><code>## Warning: contrasts dropped from factor PerformanceRating</code></pre>
<pre class="r"><code>log.probs = as.data.frame(fitted.results)$fitted.results
testSet$Prob_Attrition = log.probs
fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)

misclass_error = mean(fitted.results != testSet$Attrition)
fitted.df = as.data.frame(fitted.results)

TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)

TruePos = testSet[TruePosIndices,]
TrueNeg = testSet[TrueNegIndices,]
fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])

sensitivity = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
specificity = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)


print(paste(&#39;Accuracy is &#39;, 1 - misclass_error))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.885057471264368&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, sensitivity))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.464285714285714&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, specificity))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.965753424657534&quot;</code></pre>
</div>
<div id="cross-validation-for-full-model" class="section level1">
<h1>Cross validation for FULL model</h1>
<pre class="r"><code>accuracy = c(500)
sensitivity = c(500)
specificity = c(500)
seeds = sample(0:10000, 500, replace = FALSE)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
  trainSet = standardized[trainIndices,]
  testSet = standardized[-trainIndices,]
  
logistic_regression_model = glm(Attrition ~ Age + BusinessTravel + DailyRate + Department + DistanceFromHome + Education + 
                                EducationField + Gender + EnvironmentSatisfaction + HourlyRate + JobInvolvement + JobLevel + JobRole +
                                JobSatisfaction + MaritalStatus + MonthlyIncome + MonthlyRate + NumCompaniesWorked + OverTime + 
                                PercentSalaryHike + PerformanceRating + RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + 
                                TrainingTimesLastYear + YearsAtCompany + WorkLifeBalance + YearsInCurrentRole + YearsSinceLastPromotion +
                                YearsWithCurrManager + Potential + YearsatCoinRole + PerformancePromotion + GoodManager + EnvOver -1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)
log.probs = as.data.frame(fitted.results)$fitted.results
testSet$Prob_Attrition = log.probs
fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)

misclass_error = mean(fitted.results != testSet$Attrition)
fitted.df = as.data.frame(fitted.results)

TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)

TruePos = testSet[TruePosIndices,]
TrueNeg = testSet[TrueNegIndices,]
fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])

accuracy[i] = 1 - misclass_error
sensitivity[i] = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
specificity[i] = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)
  
  i = i + 1
}</code></pre>
<pre><code>## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating

## Warning: contrasts dropped from factor PerformanceRating</code></pre>
<pre class="r"><code>avg_acc = mean(accuracy)
avg_sen = mean(sensitivity)
avg_spec = mean(specificity)

print(paste(&#39;Accuracy is &#39;, avg_acc))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.899264367816092&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, avg_sen))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.531145486486486&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, avg_spec))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.970308110994876&quot;</code></pre>
<div id="be" class="section level28">
<p>BE</p>
<div id="use-this-for-top-3" class="section level80">
<p>USE THIS FOR TOP 3</p>
</div>
</div>
</div>
<div id="create-training-and-test-sets-1" class="section level1">
<h1>Create training and test sets</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.8*length(derived_data$Attrition)))
trainSet = standardized[trainIndices,]
testSet = standardized[-trainIndices,]</code></pre>
</div>
<div id="correlated-variables-removed" class="section level1">
<h1>Correlated variables removed</h1>
</div>
<div id="removed-businesstravel-education-joblevel-percentsalaryhike-performancerating-monthlyrate-stockoptionlevel-gender-yearsincurrentrole-monthlyincome" class="section level1">
<h1>Removed: BusinessTravel Education JobLevel PercentSalaryHike PerformanceRating MonthlyRate StockOptionLevel Gender YearsInCurrentRole MonthlyIncome</h1>
</div>
<div id="hourlyrate-dailyrate-educationfield-relationshipsatisfaction" class="section level1">
<h1>HourlyRate DailyRate EducationField RelationshipSatisfaction</h1>
</div>
<div id="yes-true-pos-0-no-department" class="section level1">
<h1>1 = YES (TRUE POS) 0 = NO Department +</h1>
<pre class="r"><code>logistic_regression_model = glm(Attrition ~ DistanceFromHome + 
                                EnvironmentSatisfaction + JobInvolvement + JobRole +
                                JobSatisfaction + MaritalStatus + + NumCompaniesWorked + OverTime + 
                                TotalWorkingYears + 
                                TrainingTimesLastYear + WorkLifeBalance - 1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)
summary(logistic_regression_model)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Attrition ~ DistanceFromHome + EnvironmentSatisfaction + 
##     JobInvolvement + JobRole + JobSatisfaction + MaritalStatus + 
##     +NumCompaniesWorked + OverTime + TotalWorkingYears + TrainingTimesLastYear + 
##     WorkLifeBalance - 1, family = binomial(link = &quot;logit&quot;), data = standardized)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7762  -0.4891  -0.2780  -0.1246   3.3041  
## 
## Coefficients:
##                                  Estimate Std. Error z value Pr(&gt;|z|)    
## DistanceFromHome                   0.3111     0.1095   2.841 0.004495 ** 
## EnvironmentSatisfaction           -0.2505     0.1122  -2.233 0.025577 *  
## JobInvolvement                    -0.5343     0.1095  -4.881 1.05e-06 ***
## JobRoleHealthcare Representative  -4.1361     0.5666  -7.300 2.89e-13 ***
## JobRoleHuman Resources            -3.1261     0.6209  -5.035 4.79e-07 ***
## JobRoleLaboratory Technician      -3.5409     0.4288  -8.258  &lt; 2e-16 ***
## JobRoleManager                    -4.0087     0.7460  -5.373 7.73e-08 ***
## JobRoleManufacturing Director     -5.9640     0.8391  -7.107 1.18e-12 ***
## JobRoleResearch Director          -5.5875     1.1152  -5.010 5.43e-07 ***
## JobRoleResearch Scientist         -3.9408     0.4270  -9.229  &lt; 2e-16 ***
## JobRoleSales Executive            -3.7667     0.4099  -9.189  &lt; 2e-16 ***
## JobRoleSales Representative       -2.3005     0.4979  -4.620 3.83e-06 ***
## JobSatisfaction                   -0.4556     0.1117  -4.079 4.52e-05 ***
## MaritalStatusMarried               0.9844     0.3714   2.651 0.008033 ** 
## MaritalStatusSingle                1.7042     0.3739   4.558 5.16e-06 ***
## NumCompaniesWorked                 0.4233     0.1121   3.777 0.000159 ***
## OverTimeYes                        1.7725     0.2345   7.560 4.02e-14 ***
## TotalWorkingYears                 -0.4761     0.1729  -2.754 0.005889 ** 
## TrainingTimesLastYear             -0.2746     0.1218  -2.255 0.024154 *  
## WorkLifeBalance                   -0.3367     0.1102  -3.056 0.002245 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1206.08  on 870  degrees of freedom
## Residual deviance:  530.39  on 850  degrees of freedom
## AIC: 570.39
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<pre class="r"><code>fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:36)), type = &#39;response&#39;)
log.probs = as.data.frame(fitted.results)$fitted.results
testSet$Prob_Attrition = log.probs
fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)

misclass_error = mean(fitted.results != testSet$Attrition)
fitted.df = as.data.frame(fitted.results)

TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)

TruePos = testSet[TruePosIndices,]
TrueNeg = testSet[TrueNegIndices,]
fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])

sensitivity = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
specificity = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)


print(paste(&#39;Accuracy is &#39;, 1 - misclass_error))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.885057471264368&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, sensitivity))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.5&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, specificity))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.965277777777778&quot;</code></pre>
<div id="use-this-for-top-3-1" class="section level80">
<p>USE THIS FOR TOP 3</p>
</div>
</div>
<div id="cross-validation-for-reduced-model" class="section level1">
<h1>Cross validation for Reduced model</h1>
<pre class="r"><code>accuracy = c(500)
sensitivity = c(500)
specificity = c(500)
seeds = sample(0:10000, 500, replace = FALSE)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(seq(1:length(derived_data$Attrition)), round(.7*length(derived_data$Attrition)))
  trainSet = reducedStandardized[trainIndices,]
  testSet = reducedStandardized[-trainIndices,]
  
logistic_regression_model = glm(Attrition ~ Department + DistanceFromHome + 
                                EnvironmentSatisfaction + JobInvolvement + JobRole +
                                JobSatisfaction + MaritalStatus + + NumCompaniesWorked + OverTime + 
                                TotalWorkingYears + 
                                TrainingTimesLastYear + WorkLifeBalance - 1,
                                family = binomial(link = &#39;logit&#39;), data = standardized)

  fitted.results = predict(logistic_regression_model, newdata = subset(testSet, select = c(1:28)), type = &#39;response&#39;)
  log.probs = as.data.frame(fitted.results)$fitted.results
  testSet$Prob_Attrition = log.probs
  fitted.results = ifelse(fitted.results &gt; 0.5, &#39;Yes&#39;, &#39;No&#39;)
  
  misclass_error = mean(fitted.results != testSet$Attrition)
  fitted.df = as.data.frame(fitted.results)
  
  TruePosIndices = which(testSet$Attrition == &#39;Yes&#39;)
  TrueNegIndices = which(testSet$Attrition == &#39;No&#39;)
  
  TruePos = testSet[TruePosIndices,]
  TrueNeg = testSet[TrueNegIndices,]
  fitted.pos = as.data.frame(fitted.df[TruePosIndices,])
  fitted.neg = as.data.frame(fitted.df[TrueNegIndices,])
  
  accuracy[i] = 1 - misclass_error
  sensitivity[i] = mean(fitted.pos$`fitted.df[TruePosIndices, ]` == TruePos$Attrition)
  specificity[i] = mean(fitted.neg$`fitted.df[TrueNegIndices, ]` == TrueNeg$Attrition)
  
  i = i + 1
}

avg_acc = mean(accuracy)
avg_sen = mean(sensitivity)
avg_spec = mean(specificity)

print(paste(&#39;Accuracy is &#39;, avg_acc))</code></pre>
<pre><code>## [1] &quot;Accuracy is  0.888812260536399&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity is &#39;, avg_sen))</code></pre>
<pre><code>## [1] &quot;Sensitivity is  0.445279423624608&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity is &#39;, avg_spec))</code></pre>
<pre><code>## [1] &quot;Specificity is  0.974058118222407&quot;</code></pre>
<div id="create-classification-output-predictions" class="section level3">
<h3>Create classification output predictions</h3>
<div id="read-in-test-data" class="section level4">
<h4>Read in test data</h4>
<pre class="r"><code>class_test_data = read.csv(file = &#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2CompSet No Attrition.csv&#39;, header = T)

class_test_data</code></pre>
<pre><code>##      ID Age    BusinessTravel DailyRate             Department DistanceFromHome
## 1  1171  35     Travel_Rarely       750 Research &amp; Development               28
## 2  1172  33     Travel_Rarely       147        Human Resources                2
## 3  1173  26     Travel_Rarely      1330 Research &amp; Development               21
## 4  1174  55     Travel_Rarely      1311 Research &amp; Development                2
## 5  1175  29     Travel_Rarely      1246                  Sales               19
## 6  1176  51 Travel_Frequently      1456 Research &amp; Development                1
## 7  1177  52        Non-Travel       585                  Sales               29
## 8  1178  39     Travel_Rarely      1387 Research &amp; Development               10
## 9  1179  31     Travel_Rarely      1062 Research &amp; Development               24
## 10 1180  31 Travel_Frequently       534 Research &amp; Development               20
## 11 1181  40 Travel_Frequently      1469 Research &amp; Development                9
## 12 1182  31     Travel_Rarely      1082 Research &amp; Development                1
## 13 1183  33        Non-Travel       775 Research &amp; Development                4
## 14 1184  50     Travel_Rarely       691 Research &amp; Development                2
## 15 1185  33     Travel_Rarely       516 Research &amp; Development                8
## 16 1186  42        Non-Travel       335 Research &amp; Development               23
## 17 1187  33     Travel_Rarely       575 Research &amp; Development               25
## 18 1188  29     Travel_Rarely       694 Research &amp; Development                1
## 19 1189  55     Travel_Rarely       436                  Sales                2
## 20 1190  49     Travel_Rarely      1184                  Sales               11
## 21 1191  32     Travel_Rarely       267 Research &amp; Development               29
## 22 1192  50     Travel_Rarely      1126 Research &amp; Development                1
## 23 1193  54     Travel_Rarely       157 Research &amp; Development               10
## 24 1194  24 Travel_Frequently       897        Human Resources               10
## 25 1195  45     Travel_Rarely      1038 Research &amp; Development               20
## 26 1196  36        Non-Travel       635                  Sales               10
## 27 1197  41        Non-Travel       552        Human Resources                4
## 28 1198  21     Travel_Rarely      1343                  Sales               22
##    Education   EducationField EmployeeCount EmployeeNumber
## 1          3    Life Sciences             1           1596
## 2          3  Human Resources             1           1207
## 3          3          Medical             1           1107
## 4          3    Life Sciences             1            505
## 5          3    Life Sciences             1           1497
## 6          4          Medical             1            145
## 7          4    Life Sciences             1           2019
## 8          5          Medical             1           1618
## 9          3          Medical             1           1252
## 10         3    Life Sciences             1            587
## 11         4          Medical             1            964
## 12         4          Medical             1             95
## 13         3 Technical Degree             1           1771
## 14         3          Medical             1            815
## 15         5    Life Sciences             1           1515
## 16         2    Life Sciences             1           1976
## 17         3    Life Sciences             1           1545
## 18         3    Life Sciences             1           1264
## 19         1          Medical             1            842
## 20         3        Marketing             1            840
## 21         4    Life Sciences             1           2010
## 22         2          Medical             1            997
## 23         3          Medical             1           1980
## 24         3          Medical             1           1746
## 25         3          Medical             1           1460
## 26         4          Medical             1            592
## 27         3  Human Resources             1           1722
## 28         1 Technical Degree             1            669
##    EnvironmentSatisfaction Gender HourlyRate JobInvolvement JobLevel
## 1                        2   Male         46              4        2
## 2                        2   Male         99              3        1
## 3                        1   Male         37              3        1
## 4                        3 Female         97              3        4
## 5                        3   Male         77              2        2
## 6                        1 Female         30              2        3
## 7                        1   Male         40              3        1
## 8                        2   Male         76              3        2
## 9                        3 Female         96              2        2
## 10                       1   Male         66              3        3
## 11                       4   Male         35              3        1
## 12                       3   Male         87              3        1
## 13                       4   Male         90              3        2
## 14                       3   Male         64              3        4
## 15                       4   Male         69              3        2
## 16                       4   Male         37              2        2
## 17                       4   Male         44              2        2
## 18                       4 Female         87              2        4
## 19                       3   Male         37              3        2
## 20                       3 Female         43              3        3
## 21                       3 Female         49              2        1
## 22                       4   Male         66              3        4
## 23                       3 Female         77              3        2
## 24                       1   Male         59              3        1
## 25                       2   Male         95              1        3
## 26                       2   Male         32              3        3
## 27                       3   Male         60              1        2
## 28                       3   Male         49              3        1
##                      JobRole JobSatisfaction MaritalStatus MonthlyIncome
## 1      Laboratory Technician               3       Married          3407
## 2            Human Resources               3       Married          3600
## 3      Laboratory Technician               3      Divorced          2377
## 4                    Manager               4        Single         16659
## 5            Sales Executive               3      Divorced          8620
## 6  Healthcare Representative               1        Single          7484
## 7       Sales Representative               4      Divorced          3482
## 8     Manufacturing Director               1       Married          5377
## 9  Healthcare Representative               1        Single          6812
## 10 Healthcare Representative               3       Married          9824
## 11        Research Scientist               2      Divorced          3617
## 12        Research Scientist               2        Single          2501
## 13        Research Scientist               2      Divorced          3055
## 14         Research Director               3       Married         17639
## 15 Healthcare Representative               3        Single          6388
## 16        Research Scientist               3        Single          4332
## 17    Manufacturing Director               2        Single          4320
## 18         Research Director               4      Divorced         16124
## 19           Sales Executive               4        Single          5160
## 20           Sales Executive               4       Married          7654
## 21     Laboratory Technician               2        Single          2837
## 22         Research Director               4      Divorced         17399
## 23    Manufacturing Director               1        Single          4440
## 24           Human Resources               4       Married          2145
## 25 Healthcare Representative               1      Divorced         10851
## 26           Sales Executive               4        Single          9980
## 27           Human Resources               2       Married          6430
## 28      Sales Representative               3        Single          3447
##    MonthlyRate NumCompaniesWorked Over18 OverTime PercentSalaryHike
## 1        25348                  1      Y       No                17
## 2         8429                  1      Y       No                13
## 3        19373                  1      Y       No                20
## 4        23258                  2      Y      Yes                13
## 5        23757                  1      Y       No                14
## 6        25796                  3      Y       No                20
## 7        19788                  2      Y       No                15
## 8         3835                  2      Y       No                13
## 9        17198                  1      Y       No                19
## 10       22908                  3      Y       No                12
## 11       25063                  8      Y      Yes                14
## 12       18775                  1      Y       No                17
## 13        6194                  5      Y       No                15
## 14        6881                  5      Y       No                16
## 15       22049                  2      Y      Yes                17
## 16       14811                  1      Y       No                12
## 17       24152                  1      Y       No                13
## 18        3423                  3      Y       No                14
## 19       21519                  4      Y       No                16
## 20        5860                  1      Y       No                18
## 21       15919                  1      Y       No                13
## 22        6615                  9      Y       No                22
## 23       25198                  6      Y      Yes                19
## 24        2097                  0      Y       No                14
## 25       19863                  2      Y      Yes                18
## 26       15318                  1      Y       No                14
## 27       20794                  6      Y       No                19
## 28       24444                  1      Y       No                11
##    PerformanceRating RelationshipSatisfaction StandardHours StockOptionLevel
## 1                  3                        4            80                2
## 2                  3                        4            80                1
## 3                  4                        3            80                1
## 4                  3                        3            80                0
## 5                  3                        3            80                2
## 6                  4                        3            80                0
## 7                  3                        2            80                2
## 8                  3                        4            80                3
## 9                  3                        2            80                0
## 10                 3                        1            80                0
## 11                 3                        4            80                1
## 12                 3                        2            80                0
## 13                 3                        4            80                2
## 14                 3                        4            80                0
## 15                 3                        1            80                0
## 16                 3                        4            80                0
## 17                 3                        4            80                0
## 18                 3                        2            80                2
## 19                 3                        3            80                0
## 20                 3                        1            80                2
## 21                 3                        3            80                0
## 22                 4                        3            80                1
## 23                 3                        4            80                0
## 24                 3                        4            80                1
## 25                 3                        2            80                1
## 26                 3                        4            80                0
## 27                 3                        2            80                1
## 28                 3                        3            80                0
##    TotalWorkingYears TrainingTimesLastYear WorkLifeBalance YearsAtCompany
## 1                 10                     3               2             10
## 2                  5                     2               3              5
## 3                  1                     0               2              1
## 4                 30                     2               3              5
## 5                 10                     3               3             10
## 6                 23                     1               2             13
## 7                 16                     3               2              9
## 8                 10                     3               3              7
## 9                 10                     2               3             10
## 10                12                     2               3              1
## 11                 3                     2               3              1
## 12                 1                     4               3              1
## 13                11                     2               2              9
## 14                30                     3               3              4
## 15                14                     6               3              0
## 16                20                     2               3             20
## 17                 5                     2               3              5
## 18                 9                     2               2              7
## 19                12                     3               2              9
## 20                 9                     3               4              9
## 21                 6                     3               3              6
## 22                32                     1               2              5
## 23                 9                     3               3              5
## 24                 3                     2               3              2
## 25                24                     2               3              7
## 26                10                     3               2             10
## 27                10                     4               3              3
## 28                 3                     2               3              3
##    YearsInCurrentRole YearsSinceLastPromotion YearsWithCurrManager
## 1                   9                       6                    8
## 2                   4                       1                    4
## 3                   1                       0                    0
## 4                   4                       1                    2
## 5                   7                       0                    4
## 6                  12                      12                    8
## 7                   8                       0                    0
## 8                   7                       7                    7
## 9                   9                       1                    8
## 10                  0                       0                    0
## 11                  1                       0                    0
## 12                  1                       1                    0
## 13                  8                       1                    7
## 14                  3                       0                    3
## 15                  0                       0                    0
## 16                  9                       3                    7
## 17                  3                       0                    2
## 18                  7                       1                    7
## 19                  7                       7                    3
## 20                  8                       7                    7
## 21                  2                       4                    1
## 22                  4                       1                    3
## 23                  2                       1                    4
## 24                  2                       2                    1
## 25                  7                       0                    7
## 26                  3                       9                    7
## 27                  2                       1                    2
## 28                  2                       1                    2
##  [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 272 rows ]</code></pre>
</div>
</div>
</div>
<div id="experiment-with-derived-features-1" class="section level1">
<h1>Experiment with derived features</h1>
<pre class="r"><code>class_test_data$Education = as.factor(class_test_data$Education)
class_test_data$EnvironmentSatisfaction = as.factor(class_test_data$EnvironmentSatisfaction)
class_test_data$JobInvolvement = as.factor(class_test_data$JobInvolvement)
class_test_data$JobLevel = as.factor(class_test_data$JobLevel)
class_test_data$JobSatisfaction = as.factor(class_test_data$JobSatisfaction)

derived_test_data = class_test_data

derived_test_data$PerformanceRating = as.numeric(derived_test_data$PerformanceRating)
derived_test_data$Education = as.numeric(derived_test_data$Education)
derived_test_data$JobLevel = as.numeric(derived_test_data$JobLevel)

#37
derived_test_data$PerformancePromotion = derived_test_data$PerformanceRating * derived_test_data$YearsSinceLastPromotion
#38
derived_test_data$Potential = derived_test_data$Education * derived_test_data$JobLevel
#39
derived_test_data$YearsatCoinRole = derived_test_data$YearsAtCompany * derived_test_data$YearsInCurrentRole
#40 
derived_test_data$GoodManager = derived_test_data$RelationshipSatisfaction * derived_test_data$YearsWithCurrManager</code></pre>
</div>
<div id="create-predictions-and-write-to-csv-file" class="section level1">
<h1>Create predictions and write to CSV file</h1>
<pre class="r"><code>test_predictions = predict(final_class_model, class_test_data)</code></pre>
<pre><code>## Warning in predict.naiveBayes(final_class_model, class_test_data): Type mismatch
## between training and new data for variable &#39;Potential&#39;. Did you use factors with
## numeric labels for training, and numeric values for new data?</code></pre>
<pre><code>## Warning in predict.naiveBayes(final_class_model, class_test_data): Type mismatch
## between training and new data for variable &#39;YearsatCoinRole&#39;. Did you use
## factors with numeric labels for training, and numeric values for new data?</code></pre>
<pre class="r"><code>test_class_predictions = data.frame(&#39;ID&#39; = class_test_data$ID, &#39;Attrition&#39; = test_predictions)
test_class_predictions</code></pre>
<pre><code>##       ID Attrition
## 1   1171        No
## 2   1172        No
## 3   1173        No
## 4   1174        No
## 5   1175        No
## 6   1176        No
## 7   1177        No
## 8   1178        No
## 9   1179        No
## 10  1180        No
## 11  1181        No
## 12  1182        No
## 13  1183        No
## 14  1184        No
## 15  1185        No
## 16  1186        No
## 17  1187        No
## 18  1188        No
## 19  1189        No
## 20  1190        No
## 21  1191        No
## 22  1192        No
## 23  1193        No
## 24  1194        No
## 25  1195        No
## 26  1196        No
## 27  1197        No
## 28  1198       Yes
## 29  1199       Yes
## 30  1200        No
## 31  1201       Yes
## 32  1202        No
## 33  1203        No
## 34  1204       Yes
## 35  1205       Yes
## 36  1206       Yes
## 37  1207        No
## 38  1208        No
## 39  1209        No
## 40  1210        No
## 41  1211        No
## 42  1212        No
## 43  1213        No
## 44  1214        No
## 45  1215       Yes
## 46  1216        No
## 47  1217        No
## 48  1218        No
## 49  1219        No
## 50  1220        No
## 51  1221        No
## 52  1222        No
## 53  1223        No
## 54  1224        No
## 55  1225        No
## 56  1226        No
## 57  1227        No
## 58  1228        No
## 59  1229        No
## 60  1230        No
## 61  1231        No
## 62  1232        No
## 63  1233       Yes
## 64  1234        No
## 65  1235        No
## 66  1236       Yes
## 67  1237        No
## 68  1238        No
## 69  1239       Yes
## 70  1240        No
## 71  1241        No
## 72  1242        No
## 73  1243        No
## 74  1244        No
## 75  1245        No
## 76  1246       Yes
## 77  1247        No
## 78  1248        No
## 79  1249        No
## 80  1250        No
## 81  1251        No
## 82  1252        No
## 83  1253        No
## 84  1254        No
## 85  1255        No
## 86  1256        No
## 87  1257        No
## 88  1258        No
## 89  1259        No
## 90  1260       Yes
## 91  1261        No
## 92  1262        No
## 93  1263        No
## 94  1264        No
## 95  1265        No
## 96  1266        No
## 97  1267        No
## 98  1268        No
## 99  1269        No
## 100 1270       Yes
## 101 1271        No
## 102 1272        No
## 103 1273        No
## 104 1274        No
## 105 1275       Yes
## 106 1276        No
## 107 1277       Yes
## 108 1278        No
## 109 1279        No
## 110 1280        No
## 111 1281       Yes
## 112 1282        No
## 113 1283        No
## 114 1284        No
## 115 1285        No
## 116 1286        No
## 117 1287        No
## 118 1288        No
## 119 1289        No
## 120 1290        No
## 121 1291        No
## 122 1292        No
## 123 1293        No
## 124 1294        No
## 125 1295        No
## 126 1296        No
## 127 1297       Yes
## 128 1298        No
## 129 1299        No
## 130 1300        No
## 131 1301        No
## 132 1302        No
## 133 1303        No
## 134 1304       Yes
## 135 1305        No
## 136 1306        No
## 137 1307        No
## 138 1308        No
## 139 1309       Yes
## 140 1310        No
## 141 1311        No
## 142 1312        No
## 143 1313        No
## 144 1314        No
## 145 1315        No
## 146 1316        No
## 147 1317       Yes
## 148 1318       Yes
## 149 1319        No
## 150 1320        No
## 151 1321        No
## 152 1322        No
## 153 1323        No
## 154 1324        No
## 155 1325        No
## 156 1326        No
## 157 1327        No
## 158 1328       Yes
## 159 1329        No
## 160 1330        No
## 161 1331        No
## 162 1332        No
## 163 1333        No
## 164 1334        No
## 165 1335        No
## 166 1336        No
## 167 1337        No
## 168 1338        No
## 169 1339        No
## 170 1340        No
## 171 1341       Yes
## 172 1342        No
## 173 1343        No
## 174 1344        No
## 175 1345        No
## 176 1346        No
## 177 1347        No
## 178 1348        No
## 179 1349        No
## 180 1350        No
## 181 1351        No
## 182 1352        No
## 183 1353        No
## 184 1354        No
## 185 1355        No
## 186 1356        No
## 187 1357        No
## 188 1358       Yes
## 189 1359        No
## 190 1360        No
## 191 1361        No
## 192 1362        No
## 193 1363        No
## 194 1364        No
## 195 1365        No
## 196 1366        No
## 197 1367       Yes
## 198 1368        No
## 199 1369        No
## 200 1370        No
## 201 1371        No
## 202 1372        No
## 203 1373        No
## 204 1374        No
## 205 1375        No
## 206 1376        No
## 207 1377        No
## 208 1378        No
## 209 1379        No
## 210 1380        No
## 211 1381        No
## 212 1382        No
## 213 1383        No
## 214 1384        No
## 215 1385        No
## 216 1386        No
## 217 1387        No
## 218 1388        No
## 219 1389        No
## 220 1390        No
## 221 1391        No
## 222 1392       Yes
## 223 1393        No
## 224 1394        No
## 225 1395        No
## 226 1396        No
## 227 1397        No
## 228 1398        No
## 229 1399       Yes
## 230 1400        No
## 231 1401        No
## 232 1402       Yes
## 233 1403        No
## 234 1404       Yes
## 235 1405        No
## 236 1406        No
## 237 1407        No
## 238 1408        No
## 239 1409        No
## 240 1410        No
## 241 1411        No
## 242 1412        No
## 243 1413        No
## 244 1414        No
## 245 1415        No
## 246 1416        No
## 247 1417       Yes
## 248 1418        No
## 249 1419        No
## 250 1420        No
## 251 1421       Yes
## 252 1422        No
## 253 1423        No
## 254 1424        No
## 255 1425        No
## 256 1426        No
## 257 1427        No
## 258 1428        No
## 259 1429        No
## 260 1430        No
## 261 1431        No
## 262 1432        No
## 263 1433        No
## 264 1434        No
## 265 1435        No
## 266 1436        No
## 267 1437        No
## 268 1438        No
## 269 1439       Yes
## 270 1440        No
## 271 1441       Yes
## 272 1442       Yes
## 273 1443        No
## 274 1444       Yes
## 275 1445       Yes
## 276 1446        No
## 277 1447        No
## 278 1448        No
## 279 1449       Yes
## 280 1450        No
## 281 1451        No
## 282 1452        No
## 283 1453        No
## 284 1454        No
## 285 1455       Yes
## 286 1456       Yes
## 287 1457        No
## 288 1458       Yes
## 289 1459       Yes
## 290 1460        No
## 291 1461        No
## 292 1462        No
## 293 1463        No
## 294 1464        No
## 295 1465        No
## 296 1466        No
## 297 1467        No
## 298 1468       Yes
## 299 1469        No
## 300 1470        No</code></pre>
<pre class="r"><code>write.csv(test_class_predictions, &#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/Case2PredictionsPengilly Attrition.csv&#39;)</code></pre>
<div id="regression-model" class="section level58">
<p>REGRESSION MODEL</p>
</div>
</div>
<div id="predict-salary-monthly-income-using-mlr-then-possibly-lasso-random-forest-ensemble-models-etc." class="section level1">
<h1>Predict Salary (Monthly Income) Using MLR (then possibly LASSO, random forest, ensemble models, etc.</h1>
</div>
<div id="backwards-elimination" class="section level1">
<h1>Backwards elimination</h1>
</div>
<div id="import-libraries-1" class="section level1">
<h1>Import Libraries</h1>
<pre class="r"><code>library(MASS)</code></pre>
<pre><code>## Warning: package &#39;MASS&#39; was built under R version 3.6.3</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
</div>
<div id="create-training-and-test-sets-dont-use-1" class="section level1">
<h1>Create training and test sets # Don’t use</h1>
<pre class="r"><code>trainIndices = sample(seq(1:length(data$Attrition)), round(.8*length(data$Attrition)))
trainData = data[trainIndices,]
testData = data[-trainIndices,]</code></pre>
</div>
<div id="fit-the-model-with-all-variables-excluding-distancefromhome-employeecount-employeenumber-environmentsatisfaction-performancerating" class="section level1">
<h1>Fit the model with ALL variables, excluding distancefromhome, employeecount, employeenumber, environmentsatisfaction, performanceRating,</h1>
</div>
<div id="worklifebalance-yearssincelastpromotion-yearswithcurrentmanager" class="section level1">
<h1>worklifebalance, yearssincelastpromotion, yearswithcurrentmanager</h1>
<pre class="r"><code>regModel = lm(data = trainData, MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + Education + EducationField + Gender + HourlyRate +
              JobInvolvement + JobLevel + JobRole + JobSatisfaction + MaritalStatus + MonthlyRate + NumCompaniesWorked + OverTime + 
              PercentSalaryHike + RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany +
              YearsInCurrentRole)
step = stepAIC(regModel, direction = &#39;backward&#39;)</code></pre>
<pre><code>## Start:  AIC=9709.34
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + EducationField + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + JobSatisfaction + MaritalStatus + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - EducationField            5    1032094  694779831  9700.4
## - JobSatisfaction           3     928636  694676372  9704.3
## - JobInvolvement            3    3039131  696786868  9706.4
## - Department                2    1457069  695204806  9706.8
## - MaritalStatus             2    1488476  695236213  9706.8
## - OverTime                  1       7067  693754804  9707.3
## - Age                       1      17831  693765567  9707.4
## - HourlyRate                1      34574  693782311  9707.4
## - RelationshipSatisfaction  1     140343  693888080  9707.5
## - PercentSalaryHike         1     141903  693889640  9707.5
## - YearsAtCompany            1     146557  693894293  9707.5
## - StockOptionLevel          1     438819  694186555  9707.8
## - Gender                    1     513873  694261609  9707.9
## - YearsInCurrentRole        1     564223  694311959  9707.9
## - NumCompaniesWorked        1     828296  694576032  9708.2
## - MonthlyRate               1     965036  694712772  9708.3
## - TrainingTimesLastYear     1    1133886  694881623  9708.5
## &lt;none&gt;                                    693747737  9709.3
## - DailyRate                 1    2422829  696170565  9709.8
## - Education                 4   10289416  704037152  9711.6
## - BusinessTravel            2    8226165  701973902  9713.5
## - TotalWorkingYears         1   11997240  705744977  9719.3
## - JobRole                   8  400529214 1094276951 10010.5
## - JobLevel                  4 1048451106 1742198842 10342.2
## 
## Step:  AIC=9700.37
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + Gender + HourlyRate + JobInvolvement + JobLevel + 
##     JobRole + JobSatisfaction + MaritalStatus + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - JobSatisfaction           3    1027593  695807424  9695.4
## - JobInvolvement            3    2867169  697647000  9697.2
## - Department                2    1411761  696191592  9697.8
## - MaritalStatus             2    1468872  696248703  9697.8
## - OverTime                  1       5525  694785356  9698.4
## - Age                       1      10811  694790642  9698.4
## - HourlyRate                1      22022  694801853  9698.4
## - PercentSalaryHike         1     109078  694888909  9698.5
## - RelationshipSatisfaction  1     162647  694942478  9698.5
## - YearsAtCompany            1     185132  694964963  9698.6
## - StockOptionLevel          1     426684  695206514  9698.8
## - Gender                    1     558845  695338676  9698.9
## - YearsInCurrentRole        1     599544  695379375  9699.0
## - NumCompaniesWorked        1     761364  695541195  9699.1
## - TrainingTimesLastYear     1     891126  695670957  9699.3
## - MonthlyRate               1    1028523  695808354  9699.4
## &lt;none&gt;                                    694779831  9700.4
## - DailyRate                 1    2362512  697142343  9700.7
## - Education                 4   10393819  705173650  9702.7
## - BusinessTravel            2    8444283  703224114  9704.8
## - TotalWorkingYears         1   11942065  706721896  9710.2
## - JobRole                   8  400460724 1095240555 10001.1
## - JobLevel                  4 1056822297 1751602128 10336.0
## 
## Step:  AIC=9695.4
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + Gender + HourlyRate + JobInvolvement + JobLevel + 
##     JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - JobInvolvement            3    2911562  698718986  9692.3
## - MaritalStatus             2    1259417  697066841  9692.7
## - Department                2    1483693  697291117  9692.9
## - OverTime                  1       3832  695811256  9693.4
## - Age                       1      11466  695818890  9693.4
## - HourlyRate                1      53087  695860510  9693.5
## - PercentSalaryHike         1      98063  695905487  9693.5
## - YearsAtCompany            1     157532  695964956  9693.6
## - RelationshipSatisfaction  1     163692  695971116  9693.6
## - StockOptionLevel          1     339968  696147391  9693.7
## - YearsInCurrentRole        1     569340  696376764  9694.0
## - Gender                    1     644225  696451648  9694.0
## - NumCompaniesWorked        1     674012  696481436  9694.1
## - TrainingTimesLastYear     1     793527  696600951  9694.2
## - MonthlyRate               1     930478  696737902  9694.3
## &lt;none&gt;                                    695807424  9695.4
## - DailyRate                 1    2415188  698222612  9695.8
## - Education                 4   10818417  706625840  9698.1
## - BusinessTravel            2    8582265  704389689  9699.9
## - TotalWorkingYears         1   11925609  707733033  9705.2
## - JobRole                   8  402703286 1098510710  9997.2
## - JobLevel                  4 1057178539 1752985963 10330.5
## 
## Step:  AIC=9692.31
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MaritalStatus + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     RelationshipSatisfaction + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - MaritalStatus             2    1044292  699763278  9689.3
## - Department                2    1197202  699916188  9689.5
## - OverTime                  1        851  698719837  9690.3
## - Age                       1      30913  698749899  9690.3
## - HourlyRate                1      91520  698810506  9690.4
## - PercentSalaryHike         1     102093  698821079  9690.4
## - YearsAtCompany            1     111884  698830870  9690.4
## - RelationshipSatisfaction  1     139143  698858129  9690.4
## - StockOptionLevel          1     305885  699024871  9690.6
## - YearsInCurrentRole        1     515404  699234390  9690.8
## - MonthlyRate               1     688233  699407219  9691.0
## - NumCompaniesWorked        1     690663  699409649  9691.0
## - Gender                    1     714048  699433033  9691.0
## - TrainingTimesLastYear     1     903749  699622734  9691.2
## &lt;none&gt;                                    698718986  9692.3
## - DailyRate                 1    2321327  701040313  9692.6
## - Education                 4   10334554  709053540  9694.5
## - BusinessTravel            2    8203366  706922352  9696.4
## - TotalWorkingYears         1   12638885  711357871  9702.8
## - JobRole                   8  408255489 1106974475  9996.6
## - JobLevel                  4 1056765320 1755484306 10325.5
## 
## Step:  AIC=9689.35
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Department + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - Department                2    1209013  700972291  9686.5
## - OverTime                  1         68  699763346  9687.3
## - StockOptionLevel          1        511  699763788  9687.3
## - Age                       1      15110  699778388  9687.4
## - HourlyRate                1      94938  699858216  9687.4
## - PercentSalaryHike         1     116481  699879758  9687.5
## - YearsAtCompany            1     121624  699884902  9687.5
## - RelationshipSatisfaction  1     196587  699959865  9687.5
## - YearsInCurrentRole        1     568849  700332126  9687.9
## - MonthlyRate               1     653668  700416946  9688.0
## - NumCompaniesWorked        1     668204  700431482  9688.0
## - Gender                    1     699905  700463183  9688.0
## - TrainingTimesLastYear     1     814977  700578255  9688.2
## &lt;none&gt;                                    699763278  9689.3
## - DailyRate                 1    2533724  702297002  9689.9
## - Education                 4   10304064  710067342  9691.5
## - BusinessTravel            2    8294830  708058108  9693.6
## - TotalWorkingYears         1   12781534  712544812  9699.9
## - JobRole                   8  410983526 1110746804  9994.9
## - JobLevel                  4 1056737413 1756500691 10321.9
## 
## Step:  AIC=9686.55
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Education + 
##     Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - OverTime                  1       1637  700973928  9684.6
## - StockOptionLevel          1       4155  700976445  9684.6
## - Age                       1       6916  700979207  9684.6
## - HourlyRate                1      97903  701070193  9684.6
## - YearsAtCompany            1     106669  701078960  9684.7
## - PercentSalaryHike         1     106773  701079064  9684.7
## - RelationshipSatisfaction  1     237312  701209603  9684.8
## - YearsInCurrentRole        1     598579  701570870  9685.1
## - NumCompaniesWorked        1     637266  701609557  9685.2
## - MonthlyRate               1     667631  701639922  9685.2
## - Gender                    1     779107  701751398  9685.3
## - TrainingTimesLastYear     1     838574  701810865  9685.4
## &lt;none&gt;                                    700972291  9686.5
## - DailyRate                 1    2698675  703670966  9687.2
## - Education                 4   10482574  711454865  9688.9
## - BusinessTravel            2    8027609  708999900  9690.5
## - TotalWorkingYears         1   12383562  713355852  9696.7
## - JobRole                   8  413317017 1114289308  9993.1
## - JobLevel                  4 1061904213 1762876504 10320.4
## 
## Step:  AIC=9684.55
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Education + 
##     Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + RelationshipSatisfaction + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - StockOptionLevel          1       4085  700978013  9682.6
## - Age                       1       6733  700980661  9682.6
## - HourlyRate                1      99080  701073008  9682.6
## - YearsAtCompany            1     105801  701079729  9682.7
## - PercentSalaryHike         1     106407  701080335  9682.7
## - RelationshipSatisfaction  1     235865  701209792  9682.8
## - YearsInCurrentRole        1     597340  701571268  9683.1
## - NumCompaniesWorked        1     638018  701611946  9683.2
## - MonthlyRate               1     668948  701642876  9683.2
## - Gender                    1     779800  701753728  9683.3
## - TrainingTimesLastYear     1     837655  701811583  9683.4
## &lt;none&gt;                                    700973928  9684.6
## - DailyRate                 1    2700810  703674738  9685.2
## - Education                 4   10484747  711458675  9686.9
## - BusinessTravel            2    8056398  709030326  9688.5
## - TotalWorkingYears         1   12387076  713361004  9694.7
## - JobRole                   8  413316780 1114290708  9991.1
## - JobLevel                  4 1061903308 1762877236 10318.4
## 
## Step:  AIC=9682.56
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + Education + 
##     Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + RelationshipSatisfaction + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - Age                       1       6965  700984978  9680.6
## - HourlyRate                1      99695  701077708  9680.7
## - YearsAtCompany            1     104488  701082501  9680.7
## - PercentSalaryHike         1     105773  701083786  9680.7
## - RelationshipSatisfaction  1     233457  701211470  9680.8
## - YearsInCurrentRole        1     593255  701571268  9681.1
## - NumCompaniesWorked        1     636304  701614317  9681.2
## - MonthlyRate               1     665463  701643475  9681.2
## - Gender                    1     776149  701754162  9681.3
## - TrainingTimesLastYear     1     837481  701815494  9681.4
## &lt;none&gt;                                    700978013  9682.6
## - DailyRate                 1    2697902  703675915  9683.2
## - Education                 4   10481318  711459330  9684.9
## - BusinessTravel            2    8059308  709037321  9686.5
## - TotalWorkingYears         1   12403781  713381794  9692.8
## - JobRole                   8  413875167 1114853180  9989.5
## - JobLevel                  4 1062019802 1762997815 10316.5
## 
## Step:  AIC=9680.56
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     HourlyRate + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     PercentSalaryHike + RelationshipSatisfaction + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - YearsAtCompany            1     100294  701085272  9678.7
## - HourlyRate                1     101596  701086574  9678.7
## - PercentSalaryHike         1     105569  701090547  9678.7
## - RelationshipSatisfaction  1     232320  701217298  9678.8
## - YearsInCurrentRole        1     599923  701584901  9679.2
## - NumCompaniesWorked        1     630345  701615323  9679.2
## - MonthlyRate               1     672193  701657171  9679.2
## - Gender                    1     774209  701759187  9679.3
## - TrainingTimesLastYear     1     837581  701822559  9679.4
## &lt;none&gt;                                    700984978  9680.6
## - DailyRate                 1    2695168  703680146  9681.2
## - Education                 4   10483441  711468419  9682.9
## - BusinessTravel            2    8097158  709082136  9684.6
## - TotalWorkingYears         1   15703901  716688879  9694.0
## - JobRole                   8  413886836 1114871814  9987.5
## - JobLevel                  4 1066081737 1767066715 10316.1
## 
## Step:  AIC=9678.66
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     HourlyRate + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     PercentSalaryHike + RelationshipSatisfaction + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - HourlyRate                1      95517  701180789  9676.8
## - PercentSalaryHike         1      98284  701183556  9676.8
## - RelationshipSatisfaction  1     246060  701331332  9676.9
## - YearsInCurrentRole        1     566729  701652001  9677.2
## - MonthlyRate               1     648541  701733813  9677.3
## - Gender                    1     770304  701855576  9677.4
## - TrainingTimesLastYear     1     805869  701891141  9677.5
## - NumCompaniesWorked        1     893561  701978832  9677.5
## &lt;none&gt;                                    701085272  9678.7
## - DailyRate                 1    2740881  703826153  9679.4
## - Education                 4   10419764  711505036  9680.9
## - BusinessTravel            2    8291501  709376772  9682.8
## - TotalWorkingYears         1   16648719  717733991  9693.0
## - JobRole                   8  421990738 1123076009  9990.6
## - JobLevel                  4 1083553868 1784639140 10321.0
## 
## Step:  AIC=9676.76
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + PercentSalaryHike + 
##     RelationshipSatisfaction + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - PercentSalaryHike         1      95948  701276737  9674.9
## - RelationshipSatisfaction  1     258517  701439306  9675.0
## - YearsInCurrentRole        1     563719  701744508  9675.3
## - MonthlyRate               1     626618  701807407  9675.4
## - Gender                    1     752165  701932954  9675.5
## - TrainingTimesLastYear     1     801096  701981885  9675.6
## - NumCompaniesWorked        1     892161  702072950  9675.6
## &lt;none&gt;                                    701180789  9676.8
## - DailyRate                 1    2693755  703874544  9677.4
## - Education                 4   10585053  711765842  9679.2
## - BusinessTravel            2    8245692  709426481  9680.9
## - TotalWorkingYears         1   16583224  717764013  9691.0
## - JobRole                   8  422641053 1123821842  9989.1
## - JobLevel                  4 1091854808 1793035597 10322.2
## 
## Step:  AIC=9674.85
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + RelationshipSatisfaction + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsInCurrentRole
## 
##                            Df  Sum of Sq        RSS     AIC
## - RelationshipSatisfaction  1     241281  701518018  9673.1
## - YearsInCurrentRole        1     561357  701838094  9673.4
## - MonthlyRate               1     627915  701904652  9673.5
## - Gender                    1     754943  702031680  9673.6
## - TrainingTimesLastYear     1     800932  702077668  9673.6
## - NumCompaniesWorked        1     879489  702156226  9673.7
## &lt;none&gt;                                    701276737  9674.9
## - DailyRate                 1    2684602  703961338  9675.5
## - Education                 4   10548077  711824814  9677.2
## - BusinessTravel            2    8307849  709584586  9679.0
## - TotalWorkingYears         1   16660774  717937511  9689.2
## - JobRole                   8  423150955 1124427692  9987.5
## - JobLevel                  4 1095564641 1796841378 10321.7
## 
## Step:  AIC=9673.09
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsInCurrentRole
## 
##                         Df  Sum of Sq        RSS     AIC
## - YearsInCurrentRole     1     536500  702054517  9671.6
## - MonthlyRate            1     611644  702129662  9671.7
## - Gender                 1     749714  702267732  9671.8
## - TrainingTimesLastYear  1     789470  702307488  9671.9
## - NumCompaniesWorked     1     824771  702342789  9671.9
## &lt;none&gt;                                 701518018  9673.1
## - DailyRate              1    2701957  704219975  9673.8
## - Education              4   10522721  712040739  9675.5
## - BusinessTravel         2    8396293  709914311  9677.4
## - TotalWorkingYears      1   16889625  718407643  9687.6
## - JobRole                8  423782982 1125301000  9986.0
## - JobLevel               4 1095355299 1796873316 10319.7
## 
## Step:  AIC=9671.62
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + TotalWorkingYears + 
##     TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - NumCompaniesWorked     1     536331  702590848  9670.2
## - MonthlyRate            1     619025  702673542  9670.2
## - Gender                 1     675984  702730502  9670.3
## - TrainingTimesLastYear  1     793918  702848436  9670.4
## &lt;none&gt;                                 702054517  9671.6
## - DailyRate              1    2678766  704733283  9672.3
## - Education              4   10328787  712383305  9673.8
## - BusinessTravel         2    8363375  710417892  9675.9
## - TotalWorkingYears      1   22821794  724876311  9691.9
## - JobRole                8  423567059 1125621577  9984.2
## - JobLevel               4 1094819472 1796873990 10317.7
## 
## Step:  AIC=9670.16
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - MonthlyRate            1     601972  703192820  9668.8
## - Gender                 1     695235  703286083  9668.8
## - TrainingTimesLastYear  1     725593  703316441  9668.9
## &lt;none&gt;                                 702590848  9670.2
## - DailyRate              1    2846048  705436896  9671.0
## - Education              4   10388109  712978957  9672.4
## - BusinessTravel         2    8215357  710806205  9674.2
## - TotalWorkingYears      1   25992884  728583732  9693.4
## - JobRole                8  423923628 1126514476  9982.7
## - JobLevel               4 1097095594 1799686442 10316.8
## 
## Step:  AIC=9668.75
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - Gender                 1     704144  703896964  9667.4
## - TrainingTimesLastYear  1     746132  703938952  9667.5
## &lt;none&gt;                                 703192820  9668.8
## - DailyRate              1    2903753  706096573  9669.6
## - Education              4   10700172  713892992  9671.3
## - BusinessTravel         2    8142698  711335517  9672.8
## - TotalWorkingYears      1   25738174  728930994  9691.8
## - JobRole                8  423591559 1126784379  9980.9
## - JobLevel               4 1101515468 1804708288 10316.7
## 
## Step:  AIC=9667.45
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - TrainingTimesLastYear  1     751419  704648383  9666.2
## &lt;none&gt;                                 703896964  9667.4
## - DailyRate              1    2791231  706688195  9668.2
## - Education              4   10816261  714713226  9670.1
## - BusinessTravel         2    7886698  711783662  9671.2
## - TotalWorkingYears      1   25527777  729424741  9690.2
## - JobRole                8  422890516 1126787480  9978.9
## - JobLevel               4 1107921271 1811818235 10317.5
## 
## Step:  AIC=9666.19
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears
## 
##                     Df  Sum of Sq        RSS     AIC
## &lt;none&gt;                             704648383  9666.2
## - DailyRate          1    2800140  707448522  9667.0
## - Education          4   10532837  715181219  9668.5
## - BusinessTravel     2    8047277  712695659  9670.1
## - TotalWorkingYears  1   25695127  730343510  9689.1
## - JobRole            8  423289902 1127938285  9977.6
## - JobLevel           4 1107411418 1812059801 10315.6</code></pre>
</div>
<div id="predict-on-test-set" class="section level1">
<h1>Predict on test set</h1>
<pre class="r"><code>predictions = as.data.frame(predict(step, data = testData))
residuals = testData$MonthlyIncome - predictions
n = length(testData$MonthlyIncome)
RMSE = sqrt(sum((residuals^2)/n))
RMSE</code></pre>
<pre><code>## [1] 12550.02</code></pre>
<pre class="r"><code>mean(abs(residuals$`predict(step, data = testData)`))</code></pre>
<pre><code>## [1] 4525.056</code></pre>
<div id="stepwise" class="section level27">
<p>Stepwise</p>
</div>
</div>
<div id="fit-the-model-with-all-variables-excluding-employeecount-employeenumber-environmentsatisfaction-performancerating" class="section level1">
<h1>Fit the model with ALL variables, excluding employeecount, employeenumber, environmentsatisfaction, performanceRating,</h1>
</div>
<div id="worklifebalance-yearssincelastpromotion-yearswithcurrentmanager-1" class="section level1">
<h1>worklifebalance, yearssincelastpromotion, yearswithcurrentmanager</h1>
</div>
<div id="removed-maritalstatus-relationshipsatisfaction-yearsincurrentrole" class="section level1">
<h1>Removed MaritalStatus, RelationshipSatisfaction, YearsInCurrentRole</h1>
<pre class="r"><code>regModel = lm(data = trainData, MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + Department + Education + EducationField + 
              Gender + HourlyRate + JobInvolvement + JobLevel + JobRole + JobSatisfaction + MonthlyRate + 
              NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears +
              TrainingTimesLastYear + YearsAtCompany)
step = stepAIC(regModel, direction = &#39;both&#39;)</code></pre>
<pre><code>## Start:  AIC=9705.59
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + JobSatisfaction + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - EducationField         5    1062469  697061005  9696.7
## - JobSatisfaction        3     664354  696662889  9700.3
## - JobInvolvement         3    2711362  698709897  9702.3
## - Department             2    1518983  697517519  9703.1
## - StockOptionLevel       1       2314  696000850  9703.6
## - Age                    1      11581  696010116  9703.6
## - YearsAtCompany         1      13780  696012315  9703.6
## - OverTime               1      14728  696013264  9703.6
## - HourlyRate             1      37621  696036156  9703.6
## - DistanceFromHome       1      68702  696067238  9703.7
## - PercentSalaryHike      1     106368  696104904  9703.7
## - Gender                 1     423616  696422152  9704.0
## - NumCompaniesWorked     1     696466  696695001  9704.3
## - MonthlyRate            1     843331  696841866  9704.4
## - TrainingTimesLastYear  1     898107  696896643  9704.5
## &lt;none&gt;                                 695998536  9705.6
## - DailyRate              1    2709213  698707749  9706.3
## - Education              4    9899932  705898467  9707.4
## - BusinessTravel         2    8623292  704621828  9710.2
## - TotalWorkingYears      1   13112177  709110713  9716.6
## - JobRole                8  401193876 1097192412 10006.4
## - JobLevel               4 1052294389 1748292925 10338.6
## 
## Step:  AIC=9696.66
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + JobSatisfaction + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - JobSatisfaction        3     753506  697814511  9691.4
## - JobInvolvement         3    2565278  699626283  9693.2
## - Department             2    1481727  698542732  9694.1
## - StockOptionLevel       1       3622  697064627  9694.7
## - YearsAtCompany         1       5160  697066165  9694.7
## - Age                    1       6395  697067400  9694.7
## - OverTime               1      14338  697075343  9694.7
## - HourlyRate             1      22610  697083615  9694.7
## - PercentSalaryHike      1      77756  697138761  9694.7
## - DistanceFromHome       1      96204  697157209  9694.8
## - Gender                 1     464500  697525505  9695.1
## - NumCompaniesWorked     1     641712  697702717  9695.3
## - TrainingTimesLastYear  1     687713  697748718  9695.3
## - MonthlyRate            1     906424  697967429  9695.6
## &lt;none&gt;                                 697061005  9696.7
## - DailyRate              1    2681020  699742025  9697.3
## - Education              4   10020423  707081428  9698.6
## - BusinessTravel         2    8810555  705871560  9701.4
## + EducationField         5    1062469  695998536  9705.6
## - TotalWorkingYears      1   12967104  710028109  9707.5
## - JobRole                8  400961586 1098022591  9996.9
## - JobLevel               4 1060145034 1757206039 10332.2
## 
## Step:  AIC=9691.41
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + OverTime + 
##     PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - JobInvolvement         3    2610762  700425273  9688.0
## - Department             2    1550748  699365259  9689.0
## - Age                    1       7092  697821603  9689.4
## - YearsAtCompany         1       8216  697822726  9689.4
## - StockOptionLevel       1       8624  697823135  9689.4
## - OverTime               1      10542  697825053  9689.4
## - HourlyRate             1      49407  697863918  9689.5
## - PercentSalaryHike      1      69840  697884351  9689.5
## - DistanceFromHome       1     117139  697931650  9689.5
## - Gender                 1     541808  698356319  9689.9
## - NumCompaniesWorked     1     569654  698384165  9690.0
## - TrainingTimesLastYear  1     618583  698433094  9690.0
## - MonthlyRate            1     823613  698638124  9690.2
## &lt;none&gt;                                 697814511  9691.4
## - DailyRate              1    2733286  700547797  9692.1
## - Education              4   10408716  708223227  9693.7
## - BusinessTravel         2    8870844  706685355  9696.2
## + JobSatisfaction        3     753506  697061005  9696.7
## + EducationField         5    1151622  696662889  9700.3
## - TotalWorkingYears      1   12913224  710727735  9702.2
## - JobRole                8  402717035 1100531546  9992.5
## - JobLevel               4 1060865657 1758680168 10326.8
## 
## Step:  AIC=9688.01
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - Department             2    1266370  701691643  9685.3
## - OverTime               1        124  700425397  9686.0
## - StockOptionLevel       1       8444  700433717  9686.0
## - YearsAtCompany         1      19295  700444568  9686.0
## - Age                    1      23152  700448425  9686.0
## - PercentSalaryHike      1      75351  700500624  9686.1
## - HourlyRate             1      85168  700510441  9686.1
## - DistanceFromHome       1     100240  700525513  9686.1
## - NumCompaniesWorked     1     588807  701014080  9686.6
## - MonthlyRate            1     610881  701036154  9686.6
## - Gender                 1     621958  701047231  9686.6
## - TrainingTimesLastYear  1     729031  701154304  9686.7
## &lt;none&gt;                                 700425273  9688.0
## - DailyRate              1    2629489  703054762  9688.6
## - Education              4    9979219  710404492  9689.9
## + JobInvolvement         3    2610762  697814511  9691.4
## - BusinessTravel         2    8486274  708911547  9692.4
## + JobSatisfaction        3     798990  699626283  9693.2
## + EducationField         5    1010216  699415057  9697.0
## - TotalWorkingYears      1   13565555  713990828  9699.4
## - JobRole                8  408069117 1108494389  9991.5
## - JobLevel               4 1060919468 1761344741 10321.8
## 
## Step:  AIC=9685.26
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - OverTime               1        401  701692044  9683.3
## - StockOptionLevel       1       2975  701694619  9683.3
## - Age                    1      12261  701703904  9683.3
## - YearsAtCompany         1      32427  701724071  9683.3
## - PercentSalaryHike      1      65388  701757032  9683.3
## - HourlyRate             1      87649  701779293  9683.4
## - DistanceFromHome       1     114482  701806125  9683.4
## - NumCompaniesWorked     1     556842  702248485  9683.8
## - MonthlyRate            1     621462  702313105  9683.9
## - Gender                 1     698097  702389740  9684.0
## - TrainingTimesLastYear  1     746748  702438392  9684.0
## &lt;none&gt;                                 701691643  9685.3
## - DailyRate              1    2795584  704487227  9686.0
## - Education              4   10146990  711838634  9687.3
## + Department             2    1266370  700425273  9688.0
## + JobInvolvement         3    2326385  699365259  9689.0
## - BusinessTravel         2    8228219  709919862  9689.4
## + JobSatisfaction        3     863081  700828562  9690.4
## + EducationField         5    1046236  700645407  9694.2
## - TotalWorkingYears      1   13137321  714828964  9696.2
## - JobRole                8  410482705 1112174348  9989.8
## - JobLevel               4 1067043943 1768735586 10320.7
## 
## Step:  AIC=9683.26
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - StockOptionLevel       1       2979  701695023  9681.3
## - Age                    1      12143  701704188  9681.3
## - YearsAtCompany         1      32753  701724797  9681.3
## - PercentSalaryHike      1      65329  701757373  9681.3
## - HourlyRate             1      88318  701780362  9681.4
## - DistanceFromHome       1     114125  701806169  9681.4
## - NumCompaniesWorked     1     557672  702249717  9681.8
## - MonthlyRate            1     622211  702314256  9681.9
## - Gender                 1     698570  702390614  9682.0
## - TrainingTimesLastYear  1     747865  702439909  9682.0
## &lt;none&gt;                                 701692044  9683.3
## - DailyRate              1    2796433  704488477  9684.0
## - Education              4   10151448  711843492  9685.3
## + OverTime               1        401  701691643  9685.3
## + Department             2    1266647  700425397  9686.0
## + JobInvolvement         3    2322759  699369285  9687.0
## - BusinessTravel         2    8251474  709943519  9687.4
## + JobSatisfaction        3     863476  700828568  9688.4
## + EducationField         5    1046482  700645562  9692.2
## - TotalWorkingYears      1   13151480  714843525  9694.2
## - JobRole                8  410499232 1112191276  9987.8
## - JobLevel               4 1067044493 1768736537 10318.7
## 
## Step:  AIC=9681.27
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - Age                    1      11925  701706948  9679.3
## - YearsAtCompany         1      33407  701728430  9679.3
## - PercentSalaryHike      1      65803  701760826  9679.3
## - HourlyRate             1      88001  701783024  9679.4
## - DistanceFromHome       1     111701  701806723  9679.4
## - NumCompaniesWorked     1     559860  702254883  9679.8
## - MonthlyRate            1     627079  702322102  9679.9
## - Gender                 1     704091  702399114  9680.0
## - TrainingTimesLastYear  1     748080  702443103  9680.0
## &lt;none&gt;                                 701695023  9681.3
## - DailyRate              1    2800314  704495336  9682.0
## + StockOptionLevel       1       2979  701692044  9683.3
## + OverTime               1        404  701694619  9683.3
## - Education              4   10155271  711850294  9683.3
## + Department             2    1261187  700433836  9684.0
## + JobInvolvement         3    2322840  699372182  9685.0
## - BusinessTravel         2    8252487  709947510  9685.4
## + JobSatisfaction        3     866067  700828956  9686.4
## + EducationField         5    1047155  700647868  9690.2
## - TotalWorkingYears      1   13148525  714843548  9692.2
## - JobRole                8  411712005 1113407028  9986.6
## - JobLevel               4 1067549859 1769244882 10316.9
## 
## Step:  AIC=9679.28
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsAtCompany
## 
##                         Df  Sum of Sq        RSS     AIC
## - YearsAtCompany         1      41408  701748356  9677.3
## - PercentSalaryHike      1      65566  701772513  9677.3
## - HourlyRate             1      90174  701797122  9677.4
## - DistanceFromHome       1     111802  701818749  9677.4
## - NumCompaniesWorked     1     551762  702258710  9677.8
## - MonthlyRate            1     635047  702341995  9677.9
## - Gender                 1     701272  702408219  9678.0
## - TrainingTimesLastYear  1     747913  702454861  9678.0
## &lt;none&gt;                                 701706948  9679.3
## - DailyRate              1    2796789  704503737  9680.0
## + Age                    1      11925  701695023  9681.3
## - Education              4   10149581  711856529  9681.3
## + StockOptionLevel       1       2760  701704188  9681.3
## + OverTime               1        287  701706660  9681.3
## + Department             2    1250390  700456558  9682.0
## + JobInvolvement         3    2332806  699374141  9683.0
## - BusinessTravel         2    8300159  710007106  9683.5
## + JobSatisfaction        3     866943  700840005  9684.4
## + EducationField         5    1046243  700660705  9688.2
## - TotalWorkingYears      1   16536632  718243580  9693.5
## - JobRole                8  411739413 1113446361  9984.6
## - JobLevel               4 1071199004 1772905952 10316.4
## 
## Step:  AIC=9677.32
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + TotalWorkingYears + 
##     TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - PercentSalaryHike      1      67928  701816284  9675.4
## - HourlyRate             1      91682  701840038  9675.4
## - DistanceFromHome       1     124511  701872867  9675.4
## - NumCompaniesWorked     1     524214  702272570  9675.8
## - MonthlyRate            1     650276  702398631  9676.0
## - Gender                 1     689992  702438347  9676.0
## - TrainingTimesLastYear  1     764843  702513199  9676.1
## &lt;none&gt;                                 701748356  9677.3
## - DailyRate              1    2777017  704525373  9678.1
## + YearsAtCompany         1      41408  701706948  9679.3
## + Age                    1      19926  701728430  9679.3
## - Education              4   10147523  711895878  9679.3
## + StockOptionLevel       1       3404  701744952  9679.3
## + OverTime               1        571  701747785  9679.3
## + Department             2    1263260  700485096  9680.1
## + JobInvolvement         3    2352642  699395714  9681.0
## - BusinessTravel         2    8258753  710007109  9681.5
## + JobSatisfaction        3     876254  700872101  9682.5
## + EducationField         5    1033946  700714410  9686.3
## - TotalWorkingYears      1   22772266  724520622  9697.5
## - JobRole                8  419005844 1120754200  9987.2
## - JobLevel               4 1081928397 1783676753 10318.6
## 
## Step:  AIC=9675.39
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - HourlyRate             1      88919  701905203  9673.5
## - DistanceFromHome       1     136645  701952929  9673.5
## - NumCompaniesWorked     1     516532  702332816  9673.9
## - MonthlyRate            1     652069  702468353  9674.0
## - Gender                 1     692185  702508469  9674.1
## - TrainingTimesLastYear  1     763556  702579840  9674.1
## &lt;none&gt;                                 701816284  9675.4
## - DailyRate              1    2770083  704586368  9676.1
## + PercentSalaryHike      1      67928  701748356  9677.3
## + YearsAtCompany         1      43771  701772513  9677.3
## - Education              4   10117888  711934172  9677.3
## + Age                    1      19884  701796400  9677.4
## + StockOptionLevel       1       3941  701812343  9677.4
## + OverTime               1        508  701815776  9677.4
## + Department             2    1253227  700563057  9678.1
## + JobInvolvement         3    2358277  699458007  9679.0
## - BusinessTravel         2    8303241  710119525  9679.6
## + JobSatisfaction        3     866760  700949524  9680.5
## + EducationField         5     992812  700823472  9684.4
## - TotalWorkingYears      1   22840151  724656435  9695.7
## - JobRole                8  419824534 1121640818  9985.7
## - JobLevel               4 1086040629 1787856913 10318.2
## 
## Step:  AIC=9673.48
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - DistanceFromHome       1     149314  702054517  9671.6
## - NumCompaniesWorked     1     514561  702419764  9672.0
## - MonthlyRate            1     630957  702536160  9672.1
## - Gender                 1     675607  702580810  9672.1
## - TrainingTimesLastYear  1     757414  702662617  9672.2
## &lt;none&gt;                                 701905203  9673.5
## - DailyRate              1    2726680  704631883  9674.2
## + HourlyRate             1      88919  701816284  9675.4
## + PercentSalaryHike      1      65165  701840038  9675.4
## + YearsAtCompany         1      45247  701859956  9675.4
## + Age                    1      22778  701882424  9675.5
## + StockOptionLevel       1       3555  701901648  9675.5
## + OverTime               1       1235  701903968  9675.5
## - Education              4   10273910  712179113  9675.6
## + Department             2    1256359  700648844  9676.2
## + JobInvolvement         3    2396585  699508618  9677.1
## - BusinessTravel         2    8259097  710164299  9677.6
## + JobSatisfaction        3     908423  700996780  9678.6
## + EducationField         5     975077  700930126  9682.5
## - TotalWorkingYears      1   22764102  724669305  9693.7
## - JobRole                8  420555423 1122460626  9984.2
## - JobLevel               4 1094437242 1796342445 10319.5
## 
## Step:  AIC=9671.62
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + TotalWorkingYears + 
##     TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - NumCompaniesWorked     1     536331  702590848  9670.2
## - MonthlyRate            1     619025  702673542  9670.2
## - Gender                 1     675984  702730502  9670.3
## - TrainingTimesLastYear  1     793918  702848436  9670.4
## &lt;none&gt;                                 702054517  9671.6
## - DailyRate              1    2678766  704733283  9672.3
## + DistanceFromHome       1     149314  701905203  9673.5
## + HourlyRate             1     101589  701952929  9673.5
## + PercentSalaryHike      1      77458  701977059  9673.5
## + YearsAtCompany         1      60265  701994252  9673.6
## + Age                    1      24817  702029701  9673.6
## + StockOptionLevel       1        608  702053910  9673.6
## + OverTime               1         38  702054480  9673.6
## - Education              4   10328787  712383305  9673.8
## + Department             2    1274997  700779521  9674.4
## + JobInvolvement         3    2376723  699677795  9675.3
## - BusinessTravel         2    8363375  710417892  9675.9
## + JobSatisfaction        3     932963  701121554  9676.7
## + EducationField         5    1004738  701049779  9680.6
## - TotalWorkingYears      1   22821794  724876311  9691.9
## - JobRole                8  423567059 1125621577  9984.2
## - JobLevel               4 1094819472 1796873990 10317.7
## 
## Step:  AIC=9670.16
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - MonthlyRate            1     601972  703192820  9668.8
## - Gender                 1     695235  703286083  9668.8
## - TrainingTimesLastYear  1     725593  703316441  9668.9
## &lt;none&gt;                                 702590848  9670.2
## - DailyRate              1    2846048  705436896  9671.0
## + NumCompaniesWorked     1     536331  702054517  9671.6
## + DistanceFromHome       1     171084  702419764  9672.0
## + HourlyRate             1     100384  702490463  9672.1
## + PercentSalaryHike      1      70018  702520830  9672.1
## + YearsAtCompany         1       6461  702584387  9672.1
## + Age                    1       2646  702588202  9672.2
## + StockOptionLevel       1       1018  702589830  9672.2
## + OverTime               1        106  702590742  9672.2
## - Education              4   10388109  712978957  9672.4
## + Department             2    1222563  701368285  9672.9
## + JobInvolvement         3    2357917  700232931  9673.8
## - BusinessTravel         2    8215357  710806205  9674.2
## + JobSatisfaction        3     843692  701747156  9675.3
## + EducationField         5     995958  701594890  9679.2
## - TotalWorkingYears      1   25992884  728583732  9693.4
## - JobRole                8  423923628 1126514476  9982.7
## - JobLevel               4 1097095594 1799686442 10316.8
## 
## Step:  AIC=9668.75
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - Gender                 1     704144  703896964  9667.4
## - TrainingTimesLastYear  1     746132  703938952  9667.5
## &lt;none&gt;                                 703192820  9668.8
## - DailyRate              1    2903753  706096573  9669.6
## + MonthlyRate            1     601972  702590848  9670.2
## + NumCompaniesWorked     1     519278  702673542  9670.2
## + DistanceFromHome       1     158118  703034702  9670.6
## + HourlyRate             1      77903  703114917  9670.7
## + PercentSalaryHike      1      71727  703121093  9670.7
## + Age                    1       7637  703185183  9670.7
## + StockOptionLevel       1       4526  703188294  9670.7
## + YearsAtCompany         1       2185  703190635  9670.7
## + OverTime               1        565  703192255  9670.8
## - Education              4   10700172  713892992  9671.3
## + Department             2    1229624  701963196  9671.5
## + JobInvolvement         3    2164035  701028785  9672.6
## - BusinessTravel         2    8142698  711335517  9672.8
## + JobSatisfaction        3     775153  702417667  9674.0
## + EducationField         5    1024248  702168572  9677.7
## - TotalWorkingYears      1   25738174  728930994  9691.8
## - JobRole                8  423591559 1126784379  9980.9
## - JobLevel               4 1101515468 1804708288 10316.7
## 
## Step:  AIC=9667.45
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears + TrainingTimesLastYear
## 
##                         Df  Sum of Sq        RSS     AIC
## - TrainingTimesLastYear  1     751419  704648383  9666.2
## &lt;none&gt;                                 703896964  9667.4
## - DailyRate              1    2791231  706688195  9668.2
## + Gender                 1     704144  703192820  9668.8
## + MonthlyRate            1     610881  703286083  9668.8
## + NumCompaniesWorked     1     538221  703358743  9668.9
## + DistanceFromHome       1     158815  703738149  9669.3
## + PercentSalaryHike      1      74179  703822785  9669.4
## + HourlyRate             1      62037  703834927  9669.4
## + StockOptionLevel       1      10992  703885972  9669.4
## + YearsAtCompany         1       6301  703890663  9669.4
## + Age                    1       4412  703892552  9669.4
## + OverTime               1       1000  703895964  9669.4
## - Education              4   10816261  714713226  9670.1
## + Department             2    1301408  702595556  9670.2
## - BusinessTravel         2    7886698  711783662  9671.2
## + JobInvolvement         3    2222428  701674536  9671.2
## + JobSatisfaction        3     861421  703035543  9672.6
## + EducationField         5    1087992  702808972  9676.4
## - TotalWorkingYears      1   25527777  729424741  9690.2
## - JobRole                8  422890516 1126787480  9978.9
## - JobLevel               4 1107921271 1811818235 10317.5
## 
## Step:  AIC=9666.19
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears
## 
##                         Df  Sum of Sq        RSS     AIC
## &lt;none&gt;                                 704648383  9666.2
## - DailyRate              1    2800140  707448522  9667.0
## + TrainingTimesLastYear  1     751419  703896964  9667.4
## + Gender                 1     709430  703938952  9667.5
## + MonthlyRate            1     631677  704016706  9667.6
## + NumCompaniesWorked     1     468424  704179959  9667.7
## + DistanceFromHome       1     193553  704454830  9668.0
## + PercentSalaryHike      1      74928  704573454  9668.1
## + HourlyRate             1      57794  704590589  9668.1
## + StockOptionLevel       1      10871  704637512  9668.2
## + Age                    1       6339  704642044  9668.2
## + OverTime               1        893  704647490  9668.2
## + YearsAtCompany         1        452  704647931  9668.2
## - Education              4   10532837  715181219  9668.5
## + Department             2    1323560  703324822  9668.9
## + JobInvolvement         3    2313294  702335089  9669.9
## - BusinessTravel         2    8047277  712695659  9670.1
## + JobSatisfaction        3     789456  703858927  9671.4
## + EducationField         5     950430  703697953  9675.3
## - TotalWorkingYears      1   25695127  730343510  9689.1
## - JobRole                8  423289902 1127938285  9977.6
## - JobLevel               4 1107411418 1812059801 10315.6</code></pre>
<pre class="r"><code>step$anova</code></pre>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + JobSatisfaction + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + TrainingTimesLastYear + YearsAtCompany
## 
## Final Model:
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears
## 
## 
##                       Step Df    Deviance Resid. Df Resid. Dev      AIC
## 1                                               651  695998536 9705.594
## 2         - EducationField  5 1062469.345       656  697061005 9696.656
## 3        - JobSatisfaction  3  753505.946       659  697814511 9691.407
## 4         - JobInvolvement  3 2610761.884       662  700425273 9688.007
## 5             - Department  2 1266370.493       664  701691643 9685.264
## 6               - OverTime  1     400.987       665  701692044 9683.264
## 7       - StockOptionLevel  1    2978.621       666  701695023 9681.267
## 8                    - Age  1   11924.680       667  701706948 9679.279
## 9         - YearsAtCompany  1   41408.231       668  701748356 9677.320
## 10     - PercentSalaryHike  1   67928.262       669  701816284 9675.387
## 11            - HourlyRate  1   88918.917       670  701905203 9673.476
## 12      - DistanceFromHome  1  149314.413       671  702054517 9671.624
## 13    - NumCompaniesWorked  1  536330.593       672  702590848 9670.155
## 14           - MonthlyRate  1  601971.907       673  703192820 9668.751
## 15                - Gender  1  704144.164       674  703896964 9667.448
## 16 - TrainingTimesLastYear  1  751418.756       675  704648383 9666.190</code></pre>
</div>
<div id="predict-on-test-set-1" class="section level1">
<h1>Predict on test set</h1>
<pre class="r"><code>predictions = as.data.frame(predict(step, data = testData))
residuals = testData$MonthlyIncome - predictions
n = length(testData$MonthlyIncome)
RMSE = sqrt(sum((residuals^2)/n))
RMSE</code></pre>
<pre><code>## [1] 12550.02</code></pre>
<div id="derived-variables-included" class="section level3">
<h3>Derived Variables included</h3>
</div>
</div>
<div id="custom-model" class="section level1">
<h1>Custom Model</h1>
<pre class="r"><code>regModel = lm(data = trainData, MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + Department + Education + EducationField + 
              Gender + HourlyRate + JobInvolvement + JobLevel + JobRole + MaritalStatus + JobSatisfaction + MonthlyRate + 
              NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + WorkLifeBalance +
              TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager)
step = stepAIC(regModel, direction = &#39;both&#39;)</code></pre>
<pre><code>## Start:  AIC=9712.04
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + MaritalStatus + JobSatisfaction + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + WorkLifeBalance + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - EducationField           5    1033877  691499035  9703.1
## - JobSatisfaction          3    1090912  691556070  9707.1
## - JobInvolvement           3    2666930  693132088  9708.7
## - MaritalStatus            2    1215209  691680368  9709.3
## - Department               2    1299810  691764969  9709.3
## - OverTime                 1      18573  690483731  9710.1
## - Age                      1      20547  690485705  9710.1
## - HourlyRate               1      39805  690504964  9710.1
## - PercentSalaryHike        1      72256  690537414  9710.1
## - YearsAtCompany           1     132438  690597596  9710.2
## - DistanceFromHome         1     141476  690606635  9710.2
## - WorkLifeBalance          1     218200  690683358  9710.3
## - StockOptionLevel         1     222536  690687695  9710.3
## - Gender                   1     321633  690786792  9710.4
## - NumCompaniesWorked       1     663708  691128866  9710.7
## - YearsInCurrentRole       1     814461  691279619  9710.9
## - YearsWithCurrManager     1    1052167  691517325  9711.1
## - MonthlyRate              1    1149371  691614529  9711.2
## - TrainingTimesLastYear    1    1243587  691708745  9711.3
## &lt;none&gt;                                   690465158  9712.0
## - YearsSinceLastPromotion  1    2211192  692676351  9712.3
## - DailyRate                1    2606167  693071325  9712.7
## - Education                4   10904290  701369449  9714.9
## - BusinessTravel           2    8233135  698698294  9716.3
## - TotalWorkingYears        1   11749078  702214237  9721.8
## - JobRole                  8  398799252 1089264410 10013.3
## - JobLevel                 4 1030007500 1720472658 10339.5
## 
## Step:  AIC=9703.08
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + MaritalStatus + JobSatisfaction + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + WorkLifeBalance + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - JobSatisfaction          3    1194444  692693480  9698.3
## - JobInvolvement           3    2517750  694016786  9699.6
## - MaritalStatus            2    1211575  692710611  9700.3
## - Department               2    1265188  692764223  9700.4
## - Age                      1      13553  691512589  9701.1
## - OverTime                 1      16452  691515487  9701.1
## - HourlyRate               1      25454  691524489  9701.1
## - PercentSalaryHike        1      49844  691548880  9701.1
## - YearsAtCompany           1     158184  691657220  9701.2
## - DistanceFromHome         1     174251  691673287  9701.3
## - StockOptionLevel         1     211201  691710237  9701.3
## - WorkLifeBalance          1     257017  691756053  9701.3
## - Gender                   1     358072  691857108  9701.4
## - NumCompaniesWorked       1     599030  692098065  9701.7
## - YearsInCurrentRole       1     882065  692381100  9702.0
## - TrainingTimesLastYear    1     986355  692485391  9702.1
## - YearsWithCurrManager     1    1084775  692583810  9702.2
## - MonthlyRate              1    1220797  692719832  9702.3
## &lt;none&gt;                                   691499035  9703.1
## - YearsSinceLastPromotion  1    2145664  693644700  9703.2
## - DailyRate                1    2546770  694045805  9703.6
## - Education                4   11060604  702559640  9706.1
## - BusinessTravel           2    8425887  699924923  9707.5
## + EducationField           5    1033877  690465158  9712.0
## - TotalWorkingYears        1   11696856  703195891  9712.8
## - JobRole                  8  398743125 1090242161 10004.0
## - JobLevel                 4 1038618368 1730117403 10333.4
## 
## Step:  AIC=9698.28
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobInvolvement + 
##     JobLevel + JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - JobInvolvement           3    2563880  695257360  9694.9
## - MaritalStatus            2    1021806  693715286  9695.3
## - Department               2    1369252  694062731  9695.7
## - OverTime                 1      12333  692705813  9696.3
## - Age                      1      15092  692708572  9696.3
## - PercentSalaryHike        1      45340  692738820  9696.3
## - HourlyRate               1      60829  692754309  9696.3
## - YearsAtCompany           1     109682  692803162  9696.4
## - StockOptionLevel         1     153847  692847327  9696.4
## - DistanceFromHome         1     201981  692895461  9696.5
## - WorkLifeBalance          1     270822  692964302  9696.6
## - Gender                   1     441168  693134648  9696.7
## - NumCompaniesWorked       1     517225  693210705  9696.8
## - TrainingTimesLastYear    1     859697  693553177  9697.1
## - YearsInCurrentRole       1     864527  693558007  9697.1
## - MonthlyRate              1    1094123  693787603  9697.4
## - YearsWithCurrManager     1    1131107  693824587  9697.4
## - YearsSinceLastPromotion  1    1900674  694594154  9698.2
## &lt;none&gt;                                   692693480  9698.3
## - DailyRate                1    2597425  695290904  9698.9
## - Education                4   11487796  704181276  9701.7
## - BusinessTravel           2    8514808  701208288  9702.8
## + JobSatisfaction          3    1194444  691499035  9703.1
## + EducationField           5    1137410  691556070  9707.1
## - TotalWorkingYears        1   11729735  704423215  9708.0
## - JobRole                  8  400793311 1093486791 10000.0
## - JobLevel                 4 1038752151 1731445631 10327.9
## 
## Step:  AIC=9694.85
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobLevel + 
##     JobRole + MaritalStatus + MonthlyRate + NumCompaniesWorked + 
##     OverTime + PercentSalaryHike + StockOptionLevel + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - MaritalStatus            2     813393  696070753  9691.7
## - Department               2    1097259  696354620  9691.9
## - OverTime                 1        854  695258215  9692.9
## - Age                      1      37845  695295206  9692.9
## - PercentSalaryHike        1      47923  695305283  9692.9
## - HourlyRate               1      91499  695348860  9692.9
## - YearsAtCompany           1      94450  695351810  9692.9
## - StockOptionLevel         1     126411  695383772  9693.0
## - DistanceFromHome         1     179507  695436867  9693.0
## - WorkLifeBalance          1     346174  695603535  9693.2
## - Gender                   1     499256  695756616  9693.4
## - NumCompaniesWorked       1     534797  695792157  9693.4
## - YearsInCurrentRole       1     816769  696074129  9693.7
## - MonthlyRate              1     844915  696102275  9693.7
## - TrainingTimesLastYear    1     992738  696250099  9693.8
## - YearsWithCurrManager     1    1152083  696409444  9694.0
## &lt;none&gt;                                   695257360  9694.9
## - YearsSinceLastPromotion  1    2163587  697420948  9695.0
## - DailyRate                1    2499003  697756363  9695.3
## - Education                4   11073524  706330885  9697.9
## + JobInvolvement           3    2563880  692693480  9698.3
## - BusinessTravel           2    8240890  703498251  9699.1
## + JobSatisfaction          3    1240575  694016786  9699.6
## + EducationField           5     996406  694260954  9703.9
## - TotalWorkingYears        1   12371288  707628648  9705.1
## - JobRole                  8  406580832 1101838193  9999.3
## - JobLevel                 4 1038654349 1733911709 10322.9
## 
## Step:  AIC=9691.67
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + Gender + HourlyRate + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + WorkLifeBalance + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - Department               2    1122605  697193358  9688.8
## - OverTime                 1       3991  696074744  9689.7
## - StockOptionLevel         1      12591  696083345  9689.7
## - Age                      1      22932  696093686  9689.7
## - PercentSalaryHike        1      56828  696127581  9689.7
## - YearsAtCompany           1      88997  696159750  9689.8
## - HourlyRate               1      94575  696165328  9689.8
## - DistanceFromHome         1     141600  696212354  9689.8
## - WorkLifeBalance          1     423325  696494079  9690.1
## - Gender                   1     466795  696537549  9690.1
## - NumCompaniesWorked       1     520527  696591281  9690.2
## - MonthlyRate              1     818252  696889005  9690.5
## - TrainingTimesLastYear    1     908484  696979238  9690.6
## - YearsInCurrentRole       1     915345  696986099  9690.6
## - YearsWithCurrManager     1    1310220  697380973  9691.0
## &lt;none&gt;                                   696070753  9691.7
## - YearsSinceLastPromotion  1    2264837  698335590  9691.9
## - DailyRate                1    2672504  698743257  9692.3
## - Education                4   11099546  707170299  9694.7
## + MaritalStatus            2     813393  695257360  9694.9
## + JobInvolvement           3    2355467  693715286  9695.3
## - BusinessTravel           2    8386078  704456831  9696.0
## + JobSatisfaction          3    1051744  695019009  9696.6
## + EducationField           5    1014018  695056735  9700.7
## - TotalWorkingYears        1   12522859  708593613  9702.1
## - JobRole                  8  410028282 1106099035  9998.0
## - JobLevel                 4 1038753305 1734824059 10319.3
## 
## Step:  AIC=9688.79
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + OverTime + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + WorkLifeBalance + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - OverTime                 1       1107  697194465  9686.8
## - StockOptionLevel         1       6002  697199361  9686.8
## - Age                      1      12267  697205626  9686.8
## - PercentSalaryHike        1      46851  697240210  9686.8
## - YearsAtCompany           1      90956  697284315  9686.9
## - HourlyRate               1      98872  697292230  9686.9
## - DistanceFromHome         1     155460  697348818  9686.9
## - WorkLifeBalance          1     389176  697582535  9687.2
## - NumCompaniesWorked       1     482979  697676337  9687.3
## - Gender                   1     525124  697718482  9687.3
## - MonthlyRate              1     836907  698030265  9687.6
## - YearsInCurrentRole       1     928814  698122172  9687.7
## - TrainingTimesLastYear    1     936837  698130195  9687.7
## - YearsWithCurrManager     1    1288481  698481839  9688.1
## &lt;none&gt;                                   697193358  9688.8
## - YearsSinceLastPromotion  1    2439473  699632832  9689.2
## - DailyRate                1    2860854  700054213  9689.6
## + Department               2    1122605  696070753  9691.7
## + MaritalStatus            2     838739  696354620  9691.9
## - Education                4   11285225  708478583  9692.0
## + JobInvolvement           3    2086641  695106718  9692.7
## - BusinessTravel           2    8151570  705344929  9692.9
## + JobSatisfaction          3    1142912  696050447  9693.6
## + EducationField           5    1076828  696116531  9697.7
## - TotalWorkingYears        1   12140036  709333394  9698.8
## - JobRole                  8  412545956 1109739314  9996.3
## - JobLevel                 4 1044205418 1741398776 10317.9
## 
## Step:  AIC=9686.79
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + StockOptionLevel + 
##     TotalWorkingYears + WorkLifeBalance + TrainingTimesLastYear + 
##     YearsAtCompany + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - StockOptionLevel         1       5981  697200447  9684.8
## - Age                      1      12461  697206927  9684.8
## - PercentSalaryHike        1      46940  697241406  9684.8
## - YearsAtCompany           1      92437  697286902  9684.9
## - HourlyRate               1      98171  697292637  9684.9
## - DistanceFromHome         1     158506  697352971  9684.9
## - WorkLifeBalance          1     389343  697583808  9685.2
## - NumCompaniesWorked       1     482288  697676753  9685.3
## - Gender                   1     524803  697719268  9685.3
## - MonthlyRate              1     836027  698030492  9685.6
## - YearsInCurrentRole       1     930042  698124508  9685.7
## - TrainingTimesLastYear    1     945816  698140282  9685.7
## - YearsWithCurrManager     1    1288012  698482477  9686.1
## &lt;none&gt;                                   697194465  9686.8
## - YearsSinceLastPromotion  1    2438472  699632938  9687.2
## - DailyRate                1    2860079  700054545  9687.6
## + OverTime                 1       1107  697193358  9688.8
## + Department               2    1119721  696074744  9689.7
## + MaritalStatus            2     839837  696354629  9689.9
## - Education                4   11301128  708495593  9690.0
## + JobInvolvement           3    2075589  695118876  9690.7
## - BusinessTravel           2    8161093  705355558  9690.9
## + JobSatisfaction          3    1140527  696053939  9691.6
## + EducationField           5    1076500  696117965  9695.7
## - TotalWorkingYears        1   12161331  709355797  9696.8
## - JobRole                  8  412572057 1109766522  9994.3
## - JobLevel                 4 1044300191 1741494656 10315.9
## 
## Step:  AIC=9684.79
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - Age                      1      12091  697212538  9682.8
## - PercentSalaryHike        1      47671  697248118  9682.8
## - YearsAtCompany           1      93006  697293453  9682.9
## - HourlyRate               1      97795  697298242  9682.9
## - DistanceFromHome         1     154178  697354625  9682.9
## - WorkLifeBalance          1     386220  697586667  9683.2
## - NumCompaniesWorked       1     484795  697685242  9683.3
## - Gender                   1     532191  697732638  9683.3
## - MonthlyRate              1     844035  698044482  9683.6
## - TrainingTimesLastYear    1     946167  698146614  9683.7
## - YearsInCurrentRole       1     947752  698148198  9683.7
## - YearsWithCurrManager     1    1287927  698488374  9684.1
## &lt;none&gt;                                   697200447  9684.8
## - YearsSinceLastPromotion  1    2432588  699633035  9685.2
## - DailyRate                1    2864273  700064720  9685.6
## + StockOptionLevel         1       5981  697194465  9686.8
## + OverTime                 1       1086  697199361  9686.8
## + Department               2    1113182  696087265  9687.7
## - Education                4   11304721  708505168  9688.0
## + MaritalStatus            2     709050  696491397  9688.1
## + JobInvolvement           3    2076821  695123626  9688.7
## - BusinessTravel           2    8160232  705360679  9688.9
## + JobSatisfaction          3    1144486  696055961  9689.7
## + EducationField           5    1077814  696122632  9693.7
## - TotalWorkingYears        1   12155455  709355902  9694.8
## - JobRole                  8  413566236 1110766683  9992.9
## - JobLevel                 4 1044407677 1741608124 10314.0
## 
## Step:  AIC=9682.81
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + PercentSalaryHike + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsAtCompany + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - PercentSalaryHike        1      47355  697259892  9680.9
## - YearsAtCompany           1      89826  697302364  9680.9
## - HourlyRate               1     100268  697312806  9680.9
## - DistanceFromHome         1     154267  697366805  9681.0
## - WorkLifeBalance          1     383197  697595735  9681.2
## - NumCompaniesWorked       1     477042  697689579  9681.3
## - Gender                   1     530317  697742855  9681.3
## - MonthlyRate              1     853425  698065963  9681.7
## - TrainingTimesLastYear    1     946809  698159347  9681.8
## - YearsInCurrentRole       1     953850  698166388  9681.8
## - YearsWithCurrManager     1    1278250  698490788  9682.1
## &lt;none&gt;                                   697212538  9682.8
## - YearsSinceLastPromotion  1    2441925  699654462  9683.2
## - DailyRate                1    2861732  700074270  9683.7
## + Age                      1      12091  697200447  9684.8
## + StockOptionLevel         1       5611  697206927  9684.8
## + OverTime                 1       1276  697211262  9684.8
## + Department               2    1102643  696109894  9685.7
## - Education                4   11299878  708512416  9686.0
## + MaritalStatus            2     698264  696514274  9686.1
## + JobInvolvement           3    2087472  695125065  9686.7
## - BusinessTravel           2    8210686  705423224  9687.0
## + JobSatisfaction          3    1146140  696066398  9687.7
## + EducationField           5    1077622  696134916  9691.7
## - TotalWorkingYears        1   15336580  712549118  9696.0
## - JobRole                  8  413577359 1110789897  9991.0
## - JobLevel                 4 1049178053 1746390591 10313.9
## 
## Step:  AIC=9680.85
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + TotalWorkingYears + WorkLifeBalance + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsAtCompany           1      90421  697350313  9678.9
## - HourlyRate               1      97877  697357770  9679.0
## - DistanceFromHome         1     165047  697424940  9679.0
## - WorkLifeBalance          1     380983  697640875  9679.2
## - NumCompaniesWorked       1     474143  697734036  9679.3
## - Gender                   1     531256  697791149  9679.4
## - MonthlyRate              1     854754  698114647  9679.7
## - YearsInCurrentRole       1     939003  698198895  9679.8
## - TrainingTimesLastYear    1     946703  698206596  9679.8
## - YearsWithCurrManager     1    1264014  698523907  9680.1
## &lt;none&gt;                                   697259892  9680.9
## - YearsSinceLastPromotion  1    2495885  699755778  9681.3
## - DailyRate                1    2860571  700120464  9681.7
## + PercentSalaryHike        1      47355  697212538  9682.8
## + Age                      1      11774  697248118  9682.8
## + StockOptionLevel         1       6322  697253571  9682.8
## + OverTime                 1       1368  697258524  9682.9
## + Department               2    1092416  696167477  9683.8
## - Education                4   11277053  708536946  9684.0
## + MaritalStatus            2     707946  696551946  9684.1
## + JobInvolvement           3    2089019  695170873  9684.8
## - BusinessTravel           2    8262664  705522557  9685.1
## + JobSatisfaction          3    1140933  696118960  9685.7
## + EducationField           5    1043902  696215991  9689.8
## - TotalWorkingYears        1   15340503  712600396  9694.0
## - JobRole                  8  414180676 1111440568  9989.4
## - JobLevel                 4 1052742520 1750002412 10313.3
## 
## Step:  AIC=9678.94
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + HourlyRate + JobLevel + JobRole + MonthlyRate + 
##     NumCompaniesWorked + TotalWorkingYears + WorkLifeBalance + 
##     TrainingTimesLastYear + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - HourlyRate               1      92759  697443072  9677.0
## - DistanceFromHome         1     150857  697501170  9677.1
## - WorkLifeBalance          1     379814  697730128  9677.3
## - Gender                   1     527136  697877450  9677.5
## - NumCompaniesWorked       1     632960  697983273  9677.6
## - MonthlyRate              1     838323  698188636  9677.8
## - YearsInCurrentRole       1     862398  698212711  9677.8
## - TrainingTimesLastYear    1     908640  698258954  9677.9
## - YearsWithCurrManager     1    1928344  699278657  9678.9
## &lt;none&gt;                                   697350313  9678.9
## - YearsSinceLastPromotion  1    2434560  699784873  9679.4
## - DailyRate                1    2859196  700209510  9679.8
## + YearsAtCompany           1      90421  697259892  9680.9
## + PercentSalaryHike        1      47949  697302364  9680.9
## + Age                      1       8629  697341685  9680.9
## + StockOptionLevel         1       6960  697343353  9680.9
## + OverTime                 1       2918  697347395  9680.9
## + Department               2    1094169  696256145  9681.9
## - Education                4   11204025  708554338  9682.0
## + MaritalStatus            2     710408  696639905  9682.2
## + JobInvolvement           3    2070719  695279594  9682.9
## - BusinessTravel           2    8342552  705692865  9683.2
## + JobSatisfaction          3    1091631  696258682  9683.9
## + EducationField           5    1050854  696299460  9687.9
## - TotalWorkingYears        1   15559150  712909463  9692.3
## - JobRole                  8  420345274 1117695587  9991.3
## - JobLevel                 4 1075493990 1772844304 10320.3
## 
## Step:  AIC=9677.04
## MonthlyIncome ~ BusinessTravel + DailyRate + DistanceFromHome + 
##     Education + Gender + JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + 
##     TotalWorkingYears + WorkLifeBalance + TrainingTimesLastYear + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - DistanceFromHome         1     164616  697607688  9675.2
## - WorkLifeBalance          1     384912  697827984  9675.4
## - Gender                   1     511964  697955035  9675.5
## - NumCompaniesWorked       1     629988  698073060  9675.7
## - MonthlyRate              1     813909  698256981  9675.8
## - YearsInCurrentRole       1     857891  698300963  9675.9
## - TrainingTimesLastYear    1     901799  698344871  9675.9
## - YearsWithCurrManager     1    1925786  699368858  9677.0
## &lt;none&gt;                                   697443072  9677.0
## - YearsSinceLastPromotion  1    2432489  699875561  9677.5
## - DailyRate                1    2813892  700256964  9677.8
## + HourlyRate               1      92759  697350313  9678.9
## + YearsAtCompany           1      85302  697357770  9679.0
## + PercentSalaryHike        1      45588  697397483  9679.0
## + Age                      1      10748  697432324  9679.0
## + StockOptionLevel         1       6491  697436581  9679.0
## + OverTime                 1       1682  697441390  9679.0
## + Department               2    1098411  696344661  9679.9
## - Education                4   11371784  708814856  9680.3
## + MaritalStatus            2     702703  696740369  9680.3
## + JobInvolvement           3    2101376  695341695  9680.9
## - BusinessTravel           2    8296153  705739225  9681.3
## + JobSatisfaction          3    1139383  696303689  9681.9
## + EducationField           5    1031976  696411096  9686.0
## - TotalWorkingYears        1   15500241  712943313  9690.3
## - JobRole                  8  421067606 1118510678  9989.8
## - JobLevel                 4 1083782969 1781226041 10321.6
## 
## Step:  AIC=9675.2
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + TotalWorkingYears + 
##     WorkLifeBalance + TrainingTimesLastYear + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - WorkLifeBalance          1     369185  697976873  9673.6
## - Gender                   1     515030  698122717  9673.7
## - NumCompaniesWorked       1     667999  698275687  9673.9
## - MonthlyRate              1     797834  698405522  9674.0
## - YearsInCurrentRole       1     858113  698465801  9674.1
## - TrainingTimesLastYear    1     943360  698551048  9674.1
## - YearsWithCurrManager     1    1878788  699486476  9675.1
## &lt;none&gt;                                   697607688  9675.2
## - YearsSinceLastPromotion  1    2450072  700057759  9675.6
## - DailyRate                1    2768067  700375755  9676.0
## + DistanceFromHome         1     164616  697443072  9677.0
## + HourlyRate               1     106518  697501170  9677.1
## + YearsAtCompany           1      70613  697537075  9677.1
## + PercentSalaryHike        1      55967  697551721  9677.1
## + Age                      1      11240  697596448  9677.2
## + OverTime                 1       5030  697602657  9677.2
## + StockOptionLevel         1       1802  697605886  9677.2
## + Department               2    1112653  696495034  9678.1
## - Education                4   11428758  709036446  9678.5
## + MaritalStatus            2     630704  696976983  9678.6
## + JobInvolvement           3    2086120  695521568  9679.1
## - BusinessTravel           2    8423007  706030695  9679.6
## + JobSatisfaction          3    1169131  696438556  9680.0
## + EducationField           5    1068622  696539065  9684.1
## - TotalWorkingYears        1   15453780  713061468  9688.5
## - JobRole                  8  424488988 1122096675  9990.0
## - JobLevel                 4 1084064288 1781671976 10319.8
## 
## Step:  AIC=9673.57
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + Gender + 
##     JobLevel + JobRole + MonthlyRate + NumCompaniesWorked + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - Gender                   1     551723  698528596  9672.1
## - NumCompaniesWorked       1     629029  698605902  9672.2
## - YearsInCurrentRole       1     760084  698736956  9672.3
## - MonthlyRate              1     813486  698790358  9672.4
## - TrainingTimesLastYear    1     932066  698908938  9672.5
## - YearsWithCurrManager     1    1814393  699791265  9673.4
## &lt;none&gt;                                   697976873  9673.6
## - YearsSinceLastPromotion  1    2403859  700380732  9674.0
## - DailyRate                1    2834955  700811827  9674.4
## + WorkLifeBalance          1     369185  697607688  9675.2
## + DistanceFromHome         1     148888  697827984  9675.4
## + HourlyRate               1     111139  697865734  9675.5
## + YearsAtCompany           1      70138  697906735  9675.5
## + PercentSalaryHike        1      53000  697923873  9675.5
## + Age                      1       8443  697968429  9675.6
## + OverTime                 1       5050  697971823  9675.6
## + StockOptionLevel         1        448  697976425  9675.6
## + Department               2    1082942  696893931  9676.5
## - Education                4   11200263  709177135  9676.6
## + MaritalStatus            2     666278  697310595  9676.9
## + JobInvolvement           3    2153064  695823809  9677.4
## - BusinessTravel           2    8599736  706576608  9678.1
## + JobSatisfaction          3    1167190  696809682  9678.4
## + EducationField           5    1115834  696861039  9682.5
## - TotalWorkingYears        1   15409653  713386525  9686.8
## - JobRole                  8  424338534 1122315407  9988.1
## - JobLevel                 4 1085703197 1783680070 10318.6
## 
## Step:  AIC=9672.12
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + MonthlyRate + NumCompaniesWorked + TotalWorkingYears + 
##     TrainingTimesLastYear + YearsInCurrentRole + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - NumCompaniesWorked       1     623409  699152005  9670.7
## - YearsInCurrentRole       1     707852  699236448  9670.8
## - MonthlyRate              1     829001  699357597  9670.9
## - TrainingTimesLastYear    1     942607  699471202  9671.1
## - YearsWithCurrManager     1    1905909  700434504  9672.0
## &lt;none&gt;                                   698528596  9672.1
## - YearsSinceLastPromotion  1    2540682  701069278  9672.6
## - DailyRate                1    2738092  701266687  9672.8
## + Gender                   1     551723  697976873  9673.6
## + WorkLifeBalance          1     405878  698122717  9673.7
## + DistanceFromHome         1     151155  698377440  9674.0
## + HourlyRate               1      94213  698434383  9674.0
## + YearsAtCompany           1      66673  698461922  9674.1
## + PercentSalaryHike        1      54178  698474418  9674.1
## + Age                      1       6651  698521944  9674.1
## + OverTime                 1       4405  698524191  9674.1
## + StockOptionLevel         1       3489  698525106  9674.1
## + Department               2    1139983  697388613  9675.0
## - Education                4   11312826  709841422  9675.3
## + MaritalStatus            2     644165  697884430  9675.5
## + JobInvolvement           3    2216935  696311661  9675.9
## - BusinessTravel           2    8380348  706908943  9676.4
## + JobSatisfaction          3    1267678  697260918  9676.9
## + EducationField           5    1180279  697348317  9680.9
## - TotalWorkingYears        1   15380712  713909307  9685.3
## - JobRole                  8  423796670 1122325265  9986.1
## - JobLevel                 4 1090810731 1789339327 10318.8
## 
## Step:  AIC=9670.74
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + MonthlyRate + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsInCurrentRole + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsInCurrentRole       1     582255  699734260  9669.3
## - MonthlyRate              1     826818  699978823  9669.6
## - TrainingTimesLastYear    1     867654  700019659  9669.6
## &lt;none&gt;                                   699152005  9670.7
## - YearsWithCurrManager     1    2357263  701509268  9671.1
## - YearsSinceLastPromotion  1    2391713  701543717  9671.1
## - DailyRate                1    2860615  702012620  9671.6
## + NumCompaniesWorked       1     623409  698528596  9672.1
## + Gender                   1     546103  698605902  9672.2
## + WorkLifeBalance          1     364953  698787052  9672.4
## + YearsAtCompany           1     206624  698945381  9672.5
## + DistanceFromHome         1     187235  698964769  9672.6
## + HourlyRate               1      92540  699059465  9672.6
## + PercentSalaryHike        1      52272  699099732  9672.7
## + StockOptionLevel         1       5947  699146057  9672.7
## + OverTime                 1       4282  699147723  9672.7
## + Age                      1        370  699151634  9672.7
## + Department               2    1111687  698040318  9673.6
## - Education                4   11308169  710460174  9673.9
## + MaritalStatus            2     646901  698505104  9674.1
## + JobInvolvement           3    2216326  696935678  9674.5
## - BusinessTravel           2    8158629  707310633  9674.8
## + JobSatisfaction          3    1148859  698003146  9675.6
## + EducationField           5    1150923  698001082  9679.6
## - TotalWorkingYears        1   20135738  719287742  9688.5
## - JobRole                  8  423337524 1122489528  9984.3
## - JobLevel                 4 1092755159 1791907163 10317.8
## 
## Step:  AIC=9669.32
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + MonthlyRate + TotalWorkingYears + TrainingTimesLastYear + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - MonthlyRate              1     788775  700523034  9668.1
## - TrainingTimesLastYear    1     880903  700615163  9668.2
## - YearsWithCurrManager     1    1781526  701515785  9669.1
## &lt;none&gt;                                   699734260  9669.3
## - DailyRate                1    2943107  702677367  9670.2
## - YearsSinceLastPromotion  1    3042894  702777154  9670.3
## + YearsInCurrentRole       1     582255  699152005  9670.7
## + Gender                   1     499093  699235167  9670.8
## + NumCompaniesWorked       1     497812  699236448  9670.8
## + WorkLifeBalance          1     280346  699453914  9671.0
## + DistanceFromHome         1     185492  699548768  9671.1
## + HourlyRate               1      89132  699645128  9671.2
## + PercentSalaryHike        1      38210  699696050  9671.3
## + StockOptionLevel         1      18756  699715504  9671.3
## + YearsAtCompany           1       6586  699727674  9671.3
## + Age                      1       4559  699729701  9671.3
## + OverTime                 1       3494  699730766  9671.3
## + Department               2    1126552  698607707  9672.2
## - Education                4   11120739  710854999  9672.3
## + MaritalStatus            2     759989  698974271  9672.6
## + JobInvolvement           3    2176505  697557754  9673.2
## - BusinessTravel           2    8422556  708156816  9673.6
## + JobSatisfaction          3    1186220  698548040  9674.1
## + EducationField           5    1173443  698560816  9678.2
## - TotalWorkingYears        1   21283704  721017964  9688.2
## - JobRole                  8  423045014 1122779273  9982.4
## - JobLevel                 4 1092224993 1791959253 10315.8
## 
## Step:  AIC=9668.1
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears + TrainingTimesLastYear + YearsSinceLastPromotion + 
##     YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - TrainingTimesLastYear    1     901384  701424419  9667.0
## - YearsWithCurrManager     1    1624514  702147548  9667.7
## &lt;none&gt;                                   700523034  9668.1
## - YearsSinceLastPromotion  1    2933604  703456639  9669.0
## - DailyRate                1    3013493  703536527  9669.1
## + MonthlyRate              1     788775  699734260  9669.3
## + YearsInCurrentRole       1     544212  699978823  9669.6
## + Gender                   1     514981  700008054  9669.6
## + NumCompaniesWorked       1     499608  700023426  9669.6
## + WorkLifeBalance          1     296766  700226268  9669.8
## + DistanceFromHome         1     168206  700354829  9669.9
## + HourlyRate               1      65028  700458006  9670.0
## + PercentSalaryHike        1      39538  700483497  9670.1
## + StockOptionLevel         1      30787  700492247  9670.1
## + Age                      1      10091  700512944  9670.1
## + YearsAtCompany           1       4838  700518197  9670.1
## + OverTime                 1       1688  700521347  9670.1
## + Department               2    1134401  699388633  9671.0
## + MaritalStatus            2     773611  699749424  9671.3
## - Education                4   11481916  712004951  9671.4
## + JobInvolvement           3    1965971  698557063  9672.1
## - BusinessTravel           2    8333733  708856767  9672.3
## + JobSatisfaction          3    1083379  699439655  9673.0
## + EducationField           5    1211466  699311568  9676.9
## - TotalWorkingYears        1   20942470  721465504  9686.6
## - JobRole                  8  422439224 1122962258  9980.5
## - JobLevel                 4 1097306066 1797829100 10316.1
## 
## Step:  AIC=9667
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears + YearsSinceLastPromotion + YearsWithCurrManager
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsWithCurrManager     1    1527946  702952365  9666.5
## &lt;none&gt;                                   701424419  9667.0
## - YearsSinceLastPromotion  1    2817296  704241715  9667.8
## - DailyRate                1    3021381  704445800  9668.0
## + TrainingTimesLastYear    1     901384  700523034  9668.1
## + MonthlyRate              1     809256  700615163  9668.2
## + YearsInCurrentRole       1     556688  700867731  9668.4
## + Gender                   1     524965  700899454  9668.5
## + NumCompaniesWorked       1     430826  700993592  9668.6
## + WorkLifeBalance          1     288646  701135772  9668.7
## + DistanceFromHome         1     206720  701217699  9668.8
## + HourlyRate               1      60219  701364200  9668.9
## + PercentSalaryHike        1      40516  701383903  9669.0
## + StockOptionLevel         1      29953  701394466  9669.0
## + Age                      1      12476  701411943  9669.0
## + OverTime                 1      11317  701413102  9669.0
## + YearsAtCompany           1        101  701424317  9669.0
## + Department               2    1159541  700264877  9669.8
## - Education                4   11149823  712574241  9670.0
## + MaritalStatus            2     693847  700730572  9670.3
## + JobInvolvement           3    2075459  699348959  9670.9
## - BusinessTravel           2    8498834  709923253  9671.4
## + JobSatisfaction          3     988537  700435882  9672.0
## + EducationField           5    1046794  700377624  9676.0
## - TotalWorkingYears        1   21069162  722493581  9685.6
## - JobRole                  8  422728949 1124153368  9979.3
## - JobLevel                 4 1096500099 1797924518 10314.1
## 
## Step:  AIC=9666.51
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears + YearsSinceLastPromotion
## 
##                           Df  Sum of Sq        RSS     AIC
## - YearsSinceLastPromotion  1    1696018  704648383  9666.2
## &lt;none&gt;                                   702952365  9666.5
## + YearsWithCurrManager     1    1527946  701424419  9667.0
## + NumCompaniesWorked       1     916973  702035392  9667.6
## - DailyRate                1    3155684  706108049  9667.6
## + TrainingTimesLastYear    1     804816  702147548  9667.7
## + Gender                   1     668659  702283706  9667.9
## + MonthlyRate              1     653322  702299043  9667.9
## + YearsAtCompany           1     613892  702338472  9667.9
## + WorkLifeBalance          1     294682  702657683  9668.2
## + DistanceFromHome         1     163565  702788800  9668.4
## + HourlyRate               1      59515  702892850  9668.5
## + PercentSalaryHike        1      33051  702919313  9668.5
## + StockOptionLevel         1      17766  702934599  9668.5
## + Age                      1       7432  702944933  9668.5
## + OverTime                 1       3388  702948977  9668.5
## + YearsInCurrentRole       1       1753  702950611  9668.5
## - Education                4   11036714  713989079  9669.4
## + Department               2    1129106  701823259  9669.4
## + MaritalStatus            2     750010  702202355  9669.8
## + JobInvolvement           3    2084972  700867393  9670.4
## - BusinessTravel           2    8572816  711525181  9670.9
## + JobSatisfaction          3     919717  702032648  9671.6
## + EducationField           5    1049575  701902790  9675.5
## - TotalWorkingYears        1   19574414  722526778  9683.6
## - JobRole                  8  422974807 1125927171  9978.4
## - JobLevel                 4 1099299606 1802251971 10313.8
## 
## Step:  AIC=9666.19
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears
## 
##                           Df  Sum of Sq        RSS     AIC
## &lt;none&gt;                                   704648383  9666.2
## + YearsSinceLastPromotion  1    1696018  702952365  9666.5
## - DailyRate                1    2800140  707448522  9667.0
## + TrainingTimesLastYear    1     751419  703896964  9667.4
## + Gender                   1     709430  703938952  9667.5
## + MonthlyRate              1     631677  704016706  9667.6
## + NumCompaniesWorked       1     468424  704179959  9667.7
## + YearsWithCurrManager     1     406668  704241715  9667.8
## + WorkLifeBalance          1     231891  704416492  9668.0
## + YearsInCurrentRole       1     218791  704429592  9668.0
## + DistanceFromHome         1     193553  704454830  9668.0
## + PercentSalaryHike        1      74928  704573454  9668.1
## + HourlyRate               1      57794  704590589  9668.1
## + StockOptionLevel         1      10871  704637512  9668.2
## + Age                      1       6339  704642044  9668.2
## + OverTime                 1        893  704647490  9668.2
## + YearsAtCompany           1        452  704647931  9668.2
## - Education                4   10532837  715181219  9668.5
## + Department               2    1323560  703324822  9668.9
## + MaritalStatus            2     797507  703850876  9669.4
## + JobInvolvement           3    2313294  702335089  9669.9
## - BusinessTravel           2    8047277  712695659  9670.1
## + JobSatisfaction          3     789456  703858927  9671.4
## + EducationField           5     950430  703697953  9675.3
## - TotalWorkingYears        1   25695127  730343510  9689.1
## - JobRole                  8  423289902 1127938285  9977.6
## - JobLevel                 4 1107411418 1812059801 10315.6</code></pre>
<pre class="r"><code>step$anova</code></pre>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## MonthlyIncome ~ Age + BusinessTravel + DailyRate + DistanceFromHome + 
##     Department + Education + EducationField + Gender + HourlyRate + 
##     JobInvolvement + JobLevel + JobRole + MaritalStatus + JobSatisfaction + 
##     MonthlyRate + NumCompaniesWorked + OverTime + PercentSalaryHike + 
##     StockOptionLevel + TotalWorkingYears + WorkLifeBalance + 
##     TrainingTimesLastYear + YearsAtCompany + YearsInCurrentRole + 
##     YearsSinceLastPromotion + YearsWithCurrManager
## 
## Final Model:
## MonthlyIncome ~ BusinessTravel + DailyRate + Education + JobLevel + 
##     JobRole + TotalWorkingYears
## 
## 
##                         Step Df    Deviance Resid. Df Resid. Dev      AIC
## 1                                                 645  690465158 9712.038
## 2           - EducationField  5 1033877.022       650  691499035 9703.080
## 3          - JobSatisfaction  3 1194444.455       653  692693480 9698.281
## 4           - JobInvolvement  3 2563880.493       656  695257360 9694.852
## 5            - MaritalStatus  2  813393.014       658  696070753 9691.666
## 6               - Department  2 1122605.023       660  697193358 9688.788
## 7                 - OverTime  1    1106.954       661  697194465 9686.789
## 8         - StockOptionLevel  1    5981.454       662  697200447 9684.795
## 9                      - Age  1   12091.042       663  697212538 9682.807
## 10       - PercentSalaryHike  1   47354.585       664  697259892 9680.854
## 11          - YearsAtCompany  1   90420.825       665  697350313 9678.944
## 12              - HourlyRate  1   92758.524       666  697443072 9677.037
## 13        - DistanceFromHome  1  164615.775       667  697607688 9675.201
## 14         - WorkLifeBalance  1  369185.067       668  697976873 9673.569
## 15                  - Gender  1  551722.919       669  698528596 9672.119
## 16      - NumCompaniesWorked  1  623409.132       670  699152005 9670.740
## 17      - YearsInCurrentRole  1  582254.989       671  699734260 9669.320
## 18             - MonthlyRate  1  788774.653       672  700523034 9668.104
## 19   - TrainingTimesLastYear  1  901384.331       673  701424419 9666.999
## 20    - YearsWithCurrManager  1 1527946.110       674  702952365 9666.513
## 21 - YearsSinceLastPromotion  1 1696017.994       675  704648383 9666.190</code></pre>
</div>
<div id="predict-on-test-set-2" class="section level1">
<h1>Predict on test set</h1>
<pre class="r"><code>predictions = as.data.frame(predict(step, data = testData))
residuals = testData$MonthlyIncome - predictions
n = length(testData$MonthlyIncome)
RMSE = sqrt(sum((residuals^2)/n))
RMSE</code></pre>
<pre><code>## [1] 12550.02</code></pre>
<div id="lasso-regression" class="section level30">
<p>LASSO REGRESSION</p>
</div>
</div>
<div id="import-libraries-2" class="section level1">
<h1>Import Libraries</h1>
<pre class="r"><code>library(glmnet)</code></pre>
<pre><code>## Warning: package &#39;glmnet&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## Loaded glmnet 3.0-2</code></pre>
<pre class="r"><code>library(fastDummies)</code></pre>
<pre><code>## Warning: package &#39;fastDummies&#39; was built under R version 3.6.3</code></pre>
</div>
<div id="run-a-lasso-regression" class="section level1">
<h1>Run a LASSO regression</h1>
</div>
<div id="remove-unused-variables-in-dataset" class="section level1">
<h1>Remove unused variables in dataset</h1>
<pre class="r"><code>lasso_data = data[,c(-1, -3, -10, -11, -23, -28)]</code></pre>
<pre class="r"><code># Ensure data is already split
x_vars = model.matrix(MonthlyIncome~., lasso_data)[,-1]
y_var = lasso_data$MonthlyIncome
lambda_seq = 10^seq(2, -2, by = -.1)

set.seed(75)
trainIndices = sample(1:nrow(x_vars), nrow(x_vars)/2)
x_test = (-trainIndices)
y_test = y_var[-trainIndices]

cv_output = cv.glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = lambda_seq)

best_lam = cv_output$lambda.min
best_lam</code></pre>
<pre><code>## [1] 39.81072</code></pre>
</div>
<div id="run-lasso-regression" class="section level1">
<h1>Run LASSO Regression</h1>
<pre class="r"><code>lassoBest = glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = best_lam)
pred = predict(lassoBest, s = best_lam, newx = x_vars[-trainIndices,])
final = cbind(y_var[-trainIndices], pred)</code></pre>
</div>
<div id="get-rmse" class="section level1">
<h1>Get RMSE</h1>
<pre class="r"><code>actual = y_var[-trainIndices]
residuals = actual - pred
n = length(pred)
RMSE = sqrt(sum(actual - pred)^2/n)
RMSE</code></pre>
<pre><code>## [1] 1126.208</code></pre>
</div>
<div id="create-a-loop-to-get-an-average-rmse-value" class="section level1">
<h1>Create a loop to get an average RMSE value</h1>
<pre class="r"><code>seeds = sample(0:10000, 500, replace = FALSE)
RMSEs = c(500)
resids = c(500)
i = 1

while (i &lt; 501){
  set.seed(seeds[i])
  trainIndices = sample(1:nrow(x_vars), nrow(x_vars)/2)
  x_test = (-trainIndices)
  y_test = y_var[-trainIndices]

  cv_output = cv.glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = lambda_seq)
  best_lam = cv_output$lambda.min

  lassoBest = glmnet(x_vars[trainIndices,], y_var[trainIndices], alpha = 1, lambda = best_lam)
  pred = predict(lassoBest, s = best_lam, newx = x_vars[-trainIndices,])

  actual = y_var[-trainIndices]
  residuals = actual - pred
  resids[i] = abs(residuals)
  n = length(pred)
  RMSEs[i] = sqrt(sum(actual - pred)^2/n)
  i = i + 1
}</code></pre>
<pre><code>## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length

## Warning in resids[i] &lt;- abs(residuals): number of items to replace is not a
## multiple of replacement length</code></pre>
<pre class="r"><code>mean(resids)</code></pre>
<pre><code>## [1] 1005.223</code></pre>
<pre class="r"><code>mean(RMSEs)</code></pre>
<pre><code>## [1] 1136.051</code></pre>
<div id="create-test-predictions" class="section level4">
<h4>Create test predictions</h4>
</div>
</div>
<div id="import-test-set-and-manipulate-it" class="section level1">
<h1>Import test set and manipulate it</h1>
<pre class="r"><code>test_reg_data = read.csv(file = &#39;C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/CaseStudy2CompSet No Salary.csv&#39;, header = T)
id = test_reg_data$ID
test_reg_data = test_reg_data[,c(-1, -3, -10, -11, -22, -27)]

MonthlyIncomedf = data.frame(&#39;MonthlyIncome&#39; = matrix(0, ncol = 1, nrow = 300))
test_reg_data1 = test_reg_data[,c(1:15)]
test_reg_data2 = test_reg_data[,c(16:29)]
test_reg_data = cbind(test_reg_data1, MonthlyIncomedf, test_reg_data2)</code></pre>
</div>
<div id="remove-unused-variables-in-dataset-and-create-dummy-vars" class="section level1">
<h1>Remove unused variables in dataset and create dummy vars</h1>
<pre class="r"><code>test_x_vars = model.matrix(MonthlyIncome~., test_reg_data)[,-1]</code></pre>
</div>
<div id="refuses-to-knit" class="section level1">
<h1>Refuses to knit</h1>
<!-- # Predict on new data set and write to csv -->
<!-- ```{r} -->
<!-- pred = predict.glmnet(lassoBest, s = best_lam, newx = test_x_vars) -->
<!-- regression_preds = data.frame('ID' = id, 'MonthlyIncome' = pred) -->
<!-- colnames(regression_preds) = c('ID', 'MonthlyIncome') -->
<!-- ``` -->
<!-- # Write predictions to CSV -->
<!-- ```{r} -->
<!-- write.csv(regression_preds, file = 'C:/Users/Tpeng/OneDrive/Documents/SMU/Doing Data Science/Case Study 2/Unit 14 and 15 Case Study 2/Case2PredictionsPengilly Salary.csv') -->
<!-- ``` -->
<div id="section-5" class="section level150">
<p></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
